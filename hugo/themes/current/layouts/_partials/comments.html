{{ if .Site.Params.commentsRemarkUrl }}
  {{ if or ( and ( eq .Type "post" ) ( .Params.comments | default true ) ) .Params.comments }}
    <section id="comments" class="max-w-4xl mx-auto pt-8 space-y-4">
      <header class="flex items-center">
        <div class="h-px w-8 bg-neutral-400"></div>
        <h2 class="text-xl font-serif font-semibold flex-initial px-2">Reader Comments</h2>
        <div class="h-px bg-neutral-400 grow"></div>
      </header>
      <div class="px-1 pt-2 md:px-2">
        <div id="remark42"></div>
      </div>
      <script>var remark_config = {{ dict
          "host" .Site.Params.commentsRemarkUrl
          "site_id" "dpb587.me"
          "page_title" .Title
          "url" ( printf "https://dpb587.me%s" ( strings.TrimSuffix "/" .RelPermalink ) )
          "no_footer" true
        | jsonify | safeJS }};</script>
      <script>!function(e,n){for(var o=0;o<e.length;o++){var r=n.createElement("script"),c=".js",d=n.head||n.body;"noModule"in r?(r.type="module",c=".mjs"):r.async=!0,r.defer=!0,r.src=remark_config.host+"/web/"+e[o]+c,d.appendChild(r)}}(remark_config.components||["embed"],document);</script>
      <noscript>Please enable JavaScript to view the comments (powered by <a href="https://remark42.com/" target="_blank" rel="noopener noreferrer">Remark42</a>).</a></noscript>
    </div>
  {{ end }}
{{ end }}
