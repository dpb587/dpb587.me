var Element=function(it){"use strict";var wR=Object.defineProperty;var __=it=>{throw TypeError(it)};var xR=(it,ht,ct)=>ht in it?wR(it,ht,{enumerable:!0,configurable:!0,writable:!0,value:ct}):it[ht]=ct;var Vt=(it,ht,ct)=>xR(it,typeof ht!="symbol"?ht+"":ht,ct),m_=(it,ht,ct)=>ht.has(it)||__("Cannot "+ct);var Zt=(it,ht,ct)=>(m_(it,ht,"read from private field"),ct?ct.call(it):ht.get(it)),yc=(it,ht,ct)=>ht.has(it)?__("Cannot add the same private member more than once"):ht instanceof WeakSet?ht.add(it):ht.set(it,ct),vc=(it,ht,ct,Ms)=>(m_(it,ht,"write to private field"),Ms?Ms.call(it,ct):ht.set(it,ct),ct);var a_,yn,_e;const ht="5";typeof window<"u"&&((a_=window.__svelte??(window.__svelte={})).v??(a_.v=new Set)).add(ht);let ct=!1,Ms=!1;function v_(){ct=!0}v_();const w_=1,x_=2,E_=16,C_=1,b_=2,R_=4,S_=8,T_=16,I_=1,M_=2,A_=4,L_=1,P_=2,As="[",Ls="[!",Ma="]",Si={},Rt=Symbol(),k_="http://www.w3.org/1999/xhtml",wc=!1;var Ps=Array.isArray,O_=Array.prototype.indexOf,Aa=Array.from,ks=Object.keys,Os=Object.defineProperty,Ue=Object.getOwnPropertyDescriptor,xc=Object.getOwnPropertyDescriptors,F_=Object.prototype,D_=Array.prototype,La=Object.getPrototypeOf,Ec=Object.isExtensible;function Ti(n){return typeof n=="function"}const yr=()=>{};function Cc(n){return typeof(n==null?void 0:n.then)=="function"}function N_(n){return n()}function Fs(n){for(var t=0;t<n.length;t++)n[t]()}const ae=2,bc=4,Ds=8,Ns=16,Ve=32,jn=64,Pa=128,Ht=256,Gs=512,qt=1024,Ze=2048,En=4096,He=8192,ka=16384,Oa=32768,$s=65536,Rc=1<<17,Sc=1<<18,Tc=1<<19,Fa=1<<20,Cn=Symbol("$state"),Da=Symbol("legacy props"),G_=Symbol(""),Ic=new class extends Error{constructor(){super(...arguments);Vt(this,"name","StaleReactionError");Vt(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}},Mc=3,Ii=8,$_=11;function Ac(n){return n===this.v}function z_(n,t){return n!=n?t==t:n!==t||n!==null&&typeof n=="object"||typeof n=="function"}function Lc(n){return!z_(n,this.v)}function X_(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Y_(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function W_(n){throw new Error("https://svelte.dev/e/effect_orphan")}function B_(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function j_(){throw new Error("https://svelte.dev/e/hydration_failed")}function K_(n){throw new Error("https://svelte.dev/e/props_invalid_value")}function U_(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function V_(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Z_(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Na(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let ot=null;function zs(n){ot=n}function bn(n,t=!1,e){var i=ot={p:ot,c:null,d:!1,e:null,m:!1,s:n,x:null,l:null};ct&&!t&&(ot.l={s:null,u:null,r1:[],r2:Kn(!1)}),Wc(()=>{i.d=!0})}function Rn(n){const t=ot;if(t!==null){n!==void 0&&(t.x=n);const o=t.e;if(o!==null){var e=J,i=q;t.e=null;try{for(var r=0;r<o.length;r++){var s=o[r];le(s.effect),$t(s.reaction),js(s.fn)}}finally{le(e),$t(i)}}ot=t.p,t.m=!0}return n||{}}function vr(){return!ct||ot!==null&&ot.l===null}function Mi(n){if(typeof n!="object"||n===null||Cn in n)return n;const t=La(n);if(t!==F_&&t!==D_)return n;var e=new Map,i=Ps(n),r=Sn(0),s=q,o=a=>{var l=q;$t(s);var h=a();return $t(l),h};return i&&e.set("length",Sn(n.length)),new Proxy(n,{defineProperty(a,l,h){(!("value"in h)||h.configurable===!1||h.enumerable===!1||h.writable===!1)&&U_();var c=e.get(l);return c===void 0?c=o(()=>{var u=Sn(h.value);return e.set(l,u),u}):pt(c,h.value,!0),!0},deleteProperty(a,l){var h=e.get(l);if(h===void 0){if(l in a){const f=o(()=>Sn(Rt));e.set(l,f),Ga(r)}}else{if(i&&typeof l=="string"){var c=e.get("length"),u=Number(l);Number.isInteger(u)&&u<c.v&&pt(c,u)}pt(h,Rt),Ga(r)}return!0},get(a,l,h){var d;if(l===Cn)return n;var c=e.get(l),u=l in a;if(c===void 0&&(!u||(d=Ue(a,l))!=null&&d.writable)&&(c=o(()=>{var g=Mi(u?a[l]:Rt),p=Sn(g);return p}),e.set(l,c)),c!==void 0){var f=X(c);return f===Rt?void 0:f}return Reflect.get(a,l,h)},getOwnPropertyDescriptor(a,l){var h=Reflect.getOwnPropertyDescriptor(a,l);if(h&&"value"in h){var c=e.get(l);c&&(h.value=X(c))}else if(h===void 0){var u=e.get(l),f=u==null?void 0:u.v;if(u!==void 0&&f!==Rt)return{enumerable:!0,configurable:!0,value:f,writable:!0}}return h},has(a,l){var f;if(l===Cn)return!0;var h=e.get(l),c=h!==void 0&&h.v!==Rt||Reflect.has(a,l);if(h!==void 0||J!==null&&(!c||(f=Ue(a,l))!=null&&f.writable)){h===void 0&&(h=o(()=>{var d=c?Mi(a[l]):Rt,g=Sn(d);return g}),e.set(l,h));var u=X(h);if(u===Rt)return!1}return c},set(a,l,h,c){var x;var u=e.get(l),f=l in a;if(i&&l==="length")for(var d=h;d<u.v;d+=1){var g=e.get(d+"");g!==void 0?pt(g,Rt):d in a&&(g=o(()=>Sn(Rt)),e.set(d+"",g))}if(u===void 0)(!f||(x=Ue(a,l))!=null&&x.writable)&&(u=o(()=>Sn(void 0)),pt(u,Mi(h)),e.set(l,u));else{f=u.v!==Rt;var p=o(()=>Mi(h));pt(u,p)}var _=Reflect.getOwnPropertyDescriptor(a,l);if(_!=null&&_.set&&_.set.call(c,h),!f){if(i&&typeof l=="string"){var m=e.get("length"),y=Number(l);Number.isInteger(y)&&y>=m.v&&pt(m,y+1)}Ga(r)}return!0},ownKeys(a){X(r);var l=Reflect.ownKeys(a).filter(u=>{var f=e.get(u);return f===void 0||f.v!==Rt});for(var[h,c]of e)c.v!==Rt&&!(h in a)&&l.push(h);return l},setPrototypeOf(){V_()}})}function Ga(n,t=1){pt(n,n.v+t)}function Xs(n){var t=ae|Ze,e=q!==null&&(q.f&ae)!==0?q:null;return J===null||e!==null&&(e.f&Ht)!==0?t|=Ht:J.f|=Tc,{ctx:ot,deps:null,effects:null,equals:Ac,f:t,fn:n,reactions:null,rv:0,v:null,wv:0,parent:e??J,ac:null}}function $a(n){const t=Xs(n);return t.equals=Lc,t}function Pc(n){var t=n.effects;if(t!==null){n.effects=null;for(var e=0;e<t.length;e+=1)Je(t[e])}}function H_(n){for(var t=n.parent;t!==null;){if((t.f&ae)===0)return t;t=t.parent}return null}function kc(n){var t,e=J;le(H_(n));try{Pc(n),t=eu(n)}finally{le(e)}return t}function Oc(n){var t=kc(n);if(n.equals(t)||(n.v=t,n.wv=Qc()),!Pi){var e=(Tn||(n.f&Ht)!==0)&&n.deps!==null?En:qt;xe(n,e)}}const wr=new Map;function Kn(n,t){var e={f:0,v:n,reactions:null,equals:Ac,rv:0,wv:0};return e}function Sn(n,t){const e=Kn(n);return lm(e),e}function we(n,t=!1,e=!0){var r;const i=Kn(n);return t||(i.equals=Lc),ct&&e&&ot!==null&&ot.l!==null&&((r=ot.l).s??(r.s=[])).push(i),i}function pt(n,t,e=!1){q!==null&&(!Fe||(q.f&Rc)!==0)&&vr()&&(q.f&(ae|Ns|Rc))!==0&&!(yt!=null&&yt[1].includes(n)&&yt[0]===q)&&Z_();let i=e?Mi(t):t;return xr(n,i)}function xr(n,t){if(!n.equals(t)){var e=n.v;Pi?wr.set(n,t):wr.set(n,e),n.v=t,(n.f&ae)!==0&&((n.f&Ze)!==0&&kc(n),xe(n,(n.f&Ht)===0?qt:En)),n.wv=Qc(),Fc(n,Ze),vr()&&J!==null&&(J.f&qt)!==0&&(J.f&(Ve|jn))===0&&(he===null?hm([n]):he.push(n))}return t}function Fc(n,t){var e=n.reactions;if(e!==null)for(var i=vr(),r=e.length,s=0;s<r;s++){var o=e[s],a=o.f;(a&Ze)===0&&(!i&&o===J||(xe(o,t),(a&(qt|Ht))!==0&&((a&ae)!==0?Fc(o,En):Ba(o))))}}function Ys(n){console.warn("https://svelte.dev/e/hydration_mismatch")}let H=!1;function Jt(n){H=n}let rt;function Gt(n){if(n===null)throw Ys(),Si;return rt=n}function Er(){return Gt(ke(rt))}function Et(n){if(H){if(ke(rt)!==null)throw Ys(),Si;rt=n}}function Ws(){for(var n=0,t=rt;;){if(t.nodeType===Ii){var e=t.data;if(e===Ma){if(n===0)return t;n-=1}else(e===As||e===Ls)&&(n+=1)}var i=ke(t);t.remove(),t=i}}function Dc(n){if(!n||n.nodeType!==Ii)throw Ys(),Si;return n.data}var Nc,Gc,$c,zc;function za(){if(Nc===void 0){Nc=window,Gc=/Firefox/.test(navigator.userAgent);var n=Element.prototype,t=Node.prototype,e=Text.prototype;$c=Ue(t,"firstChild").get,zc=Ue(t,"nextSibling").get,Ec(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),Ec(e)&&(e.__t=void 0)}}function Ai(n=""){return document.createTextNode(n)}function Pe(n){return $c.call(n)}function ke(n){return zc.call(n)}function St(n,t){if(!H)return Pe(n);var e=Pe(rt);if(e===null)e=rt.appendChild(Ai());else if(t&&e.nodeType!==Mc){var i=Ai();return e==null||e.before(i),Gt(i),i}return Gt(e),e}function Bs(n,t){if(!H){var e=Pe(n);return e instanceof Comment&&e.data===""?ke(e):e}return rt}function Oe(n,t=1,e=!1){let i=H?rt:n;for(var r;t--;)r=i,i=ke(i);if(!H)return i;if(e&&(i==null?void 0:i.nodeType)!==Mc){var s=Ai();return i===null?r==null||r.after(s):i.before(s),Gt(s),s}return Gt(i),i}function Xc(n){n.textContent=""}function Yc(n){J===null&&q===null&&W_(),q!==null&&(q.f&Ht)!==0&&J===null&&Y_(),Pi&&X_()}function q_(n,t){var e=t.last;e===null?t.last=t.first=n:(e.next=n,n.prev=e,t.last=n)}function Un(n,t,e,i=!0){var r=J,s={ctx:ot,deps:null,nodes_start:null,nodes_end:null,f:n|Ze,first:null,fn:t,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(e)try{Vs(s),s.f|=Oa}catch(l){throw Je(s),l}else t!==null&&Ba(s);var o=e&&s.deps===null&&s.first===null&&s.nodes_start===null&&s.teardown===null&&(s.f&(Tc|Pa))===0;if(!o&&i&&(r!==null&&q_(s,r),q!==null&&(q.f&ae)!==0)){var a=q;(a.effects??(a.effects=[])).push(s)}return s}function Wc(n){const t=Un(Ds,null,!1);return xe(t,qt),t.teardown=n,t}function Xa(n){Yc();var t=J!==null&&(J.f&Ve)!==0&&ot!==null&&!ot.m;if(t){var e=ot;(e.e??(e.e=[])).push({fn:n,effect:J,reaction:q})}else{var i=js(n);return i}}function J_(n){return Yc(),Cr(n)}function Q_(n){const t=Un(jn,n,!0);return()=>{Je(t)}}function tm(n){const t=Un(jn,n,!0);return(e={})=>new Promise(i=>{e.outro?Vn(t,()=>{Je(t),i(void 0)}):(Je(t),i(void 0))})}function js(n){return Un(bc,n,!1)}function em(n,t){var e=ot,i={effect:null,ran:!1};e.l.r1.push(i),i.effect=Cr(()=>{n(),!i.ran&&(i.ran=!0,pt(e.l.r2,!0),De(t))})}function nm(){var n=ot;Cr(()=>{if(X(n.l.r2)){for(var t of n.l.r1){var e=t.effect;(e.f&qt)!==0&&xe(e,En),Ar(e)&&Vs(e),t.ran=!1}n.l.r2.v=!1}})}function Cr(n){return Un(Ds,n,!0)}function Li(n,t=[],e=Xs){const i=t.map(e);return br(()=>n(...i.map(X)))}function br(n,t=0){var e=Un(Ds|Ns|t,n,!0);return e}function qe(n,t=!0){return Un(Ds|Ve,n,!0,t)}function Bc(n){var t=n.teardown;if(t!==null){const e=Pi,i=q;qc(!0),$t(null);try{t.call(null)}finally{qc(e),$t(i)}}}function jc(n,t=!1){var r;var e=n.first;for(n.first=n.last=null;e!==null;){(r=e.ac)==null||r.abort(Ic);var i=e.next;(e.f&jn)!==0?e.parent=null:Je(e,t),e=i}}function im(n){for(var t=n.first;t!==null;){var e=t.next;(t.f&Ve)===0&&Je(t),t=e}}function Je(n,t=!0){var e=!1;(t||(n.f&Sc)!==0)&&n.nodes_start!==null&&n.nodes_end!==null&&(rm(n.nodes_start,n.nodes_end),e=!0),jc(n,t&&!e),Us(n,0),xe(n,ka);var i=n.transitions;if(i!==null)for(const s of i)s.stop();Bc(n);var r=n.parent;r!==null&&r.first!==null&&Kc(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=n.ac=null}function rm(n,t){for(;n!==null;){var e=n===t?null:ke(n);n.remove(),n=e}}function Kc(n){var t=n.parent,e=n.prev,i=n.next;e!==null&&(e.next=i),i!==null&&(i.prev=e),t!==null&&(t.first===n&&(t.first=i),t.last===n&&(t.last=e))}function Vn(n,t){var e=[];Ya(n,e,!0),Uc(e,()=>{Je(n),t&&t()})}function Uc(n,t){var e=n.length;if(e>0){var i=()=>--e||t();for(var r of n)r.out(i)}else t()}function Ya(n,t,e){if((n.f&He)===0){if(n.f^=He,n.transitions!==null)for(const o of n.transitions)(o.is_global||e)&&t.push(o);for(var i=n.first;i!==null;){var r=i.next,s=(i.f&$s)!==0||(i.f&Ve)!==0;Ya(i,t,s?e:!1),i=r}}}function Zn(n){Vc(n,!0)}function Vc(n,t){if((n.f&He)!==0){n.f^=He;for(var e=n.first;e!==null;){var i=e.next,r=(e.f&$s)!==0||(e.f&Ve)!==0;Vc(e,r?t:!1),e=i}if(n.transitions!==null)for(const s of n.transitions)(s.is_global||t)&&s.in()}}let Rr=[],Wa=[];function Zc(){var n=Rr;Rr=[],Fs(n)}function sm(){var n=Wa;Wa=[],Fs(n)}function Sr(n){Rr.length===0&&queueMicrotask(Zc),Rr.push(n)}function om(){Rr.length>0&&Zc(),Wa.length>0&&sm()}function am(n){var t=J;if((t.f&Oa)===0){if((t.f&Pa)===0)throw n;t.fn(n)}else Hc(n,t)}function Hc(n,t){for(;t!==null;){if((t.f&Pa)!==0)try{t.b.error(n);return}catch{}t=t.parent}throw n}let Tr=!1,Ir=null,Hn=!1,Pi=!1;function qc(n){Pi=n}let Mr=[],ER=[],q=null,Fe=!1;function $t(n){q=n}let J=null;function le(n){J=n}let yt=null;function lm(n){q!==null&&q.f&Fa&&(yt===null?yt=[q,[n]]:yt[1].push(n))}let Pt=null,Qt=0,he=null;function hm(n){he=n}let Jc=1,Ks=0,Tn=!1;function Qc(){return++Jc}function Ar(n){var u;var t=n.f;if((t&Ze)!==0)return!0;if((t&En)!==0){var e=n.deps,i=(t&Ht)!==0;if(e!==null){var r,s,o=(t&Gs)!==0,a=i&&J!==null&&!Tn,l=e.length;if(o||a){var h=n,c=h.parent;for(r=0;r<l;r++)s=e[r],(o||!((u=s==null?void 0:s.reactions)!=null&&u.includes(h)))&&(s.reactions??(s.reactions=[])).push(h);o&&(h.f^=Gs),a&&c!==null&&(c.f&Ht)===0&&(h.f^=Ht)}for(r=0;r<l;r++)if(s=e[r],Ar(s)&&Oc(s),s.wv>n.wv)return!0}(!i||J!==null&&!Tn)&&xe(n,qt)}return!1}function tu(n,t,e=!0){var i=n.reactions;if(i!==null)for(var r=0;r<i.length;r++){var s=i[r];yt!=null&&yt[1].includes(n)&&yt[0]===q||((s.f&ae)!==0?tu(s,t,!1):t===s&&(e?xe(s,Ze):(s.f&qt)!==0&&xe(s,En),Ba(s)))}}function eu(n){var d;var t=Pt,e=Qt,i=he,r=q,s=Tn,o=yt,a=ot,l=Fe,h=n.f;Pt=null,Qt=0,he=null,Tn=(h&Ht)!==0&&(Fe||!Hn||q===null),q=(h&(Ve|jn))===0?n:null,yt=null,zs(n.ctx),Fe=!1,Ks++,n.f|=Fa,n.ac!==null&&(n.ac.abort(Ic),n.ac=null);try{var c=(0,n.fn)(),u=n.deps;if(Pt!==null){var f;if(Us(n,Qt),u!==null&&Qt>0)for(u.length=Qt+Pt.length,f=0;f<Pt.length;f++)u[Qt+f]=Pt[f];else n.deps=u=Pt;if(!Tn||(h&ae)!==0&&n.reactions!==null)for(f=Qt;f<u.length;f++)((d=u[f]).reactions??(d.reactions=[])).push(n)}else u!==null&&Qt<u.length&&(Us(n,Qt),u.length=Qt);if(vr()&&he!==null&&!Fe&&u!==null&&(n.f&(ae|En|Ze))===0)for(f=0;f<he.length;f++)tu(he[f],n);return r!==null&&r!==n&&(Ks++,he!==null&&(i===null?i=he:i.push(...he))),c}catch(g){am(g)}finally{Pt=t,Qt=e,he=i,q=r,Tn=s,yt=o,zs(a),Fe=l,n.f^=Fa}}function cm(n,t){let e=t.reactions;if(e!==null){var i=O_.call(e,n);if(i!==-1){var r=e.length-1;r===0?e=t.reactions=null:(e[i]=e[r],e.pop())}}e===null&&(t.f&ae)!==0&&(Pt===null||!Pt.includes(t))&&(xe(t,En),(t.f&(Ht|Gs))===0&&(t.f^=Gs),Pc(t),Us(t,0))}function Us(n,t){var e=n.deps;if(e!==null)for(var i=t;i<e.length;i++)cm(n,e[i])}function Vs(n){var t=n.f;if((t&ka)===0){xe(n,qt);var e=J,i=Hn;J=n,Hn=!0;try{(t&Ns)!==0?im(n):jc(n),Bc(n);var r=eu(n);n.teardown=typeof r=="function"?r:null,n.wv=Jc;var s;wc&&Ms&&(n.f&Ze)!==0&&n.deps}finally{Hn=i,J=e}}}function um(){try{B_()}catch(n){if(Ir!==null)Hc(n,Ir);else throw n}}function nu(){var n=Hn;try{var t=0;for(Hn=!0;Mr.length>0;){t++>1e3&&um();var e=Mr,i=e.length;Mr=[];for(var r=0;r<i;r++){var s=dm(e[r]);fm(s)}wr.clear()}}finally{Tr=!1,Hn=n,Ir=null}}function fm(n){var t=n.length;if(t!==0)for(var e=0;e<t;e++){var i=n[e];(i.f&(ka|He))===0&&Ar(i)&&(Vs(i),i.deps===null&&i.first===null&&i.nodes_start===null&&(i.teardown===null?Kc(i):i.fn=null))}}function Ba(n){Tr||(Tr=!0,queueMicrotask(nu));for(var t=Ir=n;t.parent!==null;){t=t.parent;var e=t.f;if((e&(jn|Ve))!==0){if((e&qt)===0)return;t.f^=qt}}Mr.push(t)}function dm(n){for(var t=[],e=n;e!==null;){var i=e.f,r=(i&(Ve|jn))!==0,s=r&&(i&qt)!==0;if(!s&&(i&He)===0){(i&bc)!==0?t.push(e):r?e.f^=qt:Ar(e)&&Vs(e);var o=e.first;if(o!==null){e=o;continue}}var a=e.parent;for(e=e.next;e===null&&a!==null;)e=a.next,a=a.parent}return t}function kt(n){for(var t;;){if(om(),Mr.length===0)return Tr=!1,Ir=null,t;Tr=!0,nu()}}function X(n){var t=n.f,e=(t&ae)!==0;if(q!==null&&!Fe){if(!(yt!=null&&yt[1].includes(n))||yt[0]!==q){var i=q.deps;n.rv<Ks&&(n.rv=Ks,Pt===null&&i!==null&&i[Qt]===n?Qt++:Pt===null?Pt=[n]:(!Tn||!Pt.includes(n))&&Pt.push(n))}}else if(e&&n.deps===null&&n.effects===null){var r=n,s=r.parent;s!==null&&(s.f&Ht)===0&&(r.f^=Ht)}return e&&(r=n,Ar(r)&&Oc(r)),Pi&&wr.has(n)?wr.get(n):n.v}function De(n){var t=Fe;try{return Fe=!0,n()}finally{Fe=t}}const gm=-7169;function xe(n,t){n.f=n.f&gm|t}function ja(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(Cn in n)Ka(n);else if(!Array.isArray(n))for(let t in n){const e=n[t];typeof e=="object"&&e&&Cn in e&&Ka(e)}}}function Ka(n,t=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!t.has(n)){t.add(n),n instanceof Date&&n.getTime();for(let i in n)try{Ka(n[i],t)}catch{}const e=La(n);if(e!==Object.prototype&&e!==Array.prototype&&e!==Map.prototype&&e!==Set.prototype&&e!==Date.prototype){const i=xc(e);for(let r in i){const s=i[r].get;if(s)try{s.call(n)}catch{}}}}}function iu(n){var t=q,e=J;$t(null),le(null);try{return n()}finally{$t(t),le(e)}}const _m=new Set,ru=new Set;function mm(n,t,e,i={}){function r(s){if(i.capture||Lr.call(t,s),!s.cancelBubble)return iu(()=>e==null?void 0:e.call(this,s))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?Sr(()=>{t.addEventListener(n,r,i)}):t.addEventListener(n,r,i),r}function In(n,t,e,i,r){var s={capture:i,passive:r},o=mm(n,t,e,s);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&Wc(()=>{t.removeEventListener(n,o,s)})}function Lr(n){var y;var t=this,e=t.ownerDocument,i=n.type,r=((y=n.composedPath)==null?void 0:y.call(n))||[],s=r[0]||n.target,o=0,a=n.__root;if(a){var l=r.indexOf(a);if(l!==-1&&(t===document||t===window)){n.__root=t;return}var h=r.indexOf(t);if(h===-1)return;l<=h&&(o=l)}if(s=r[o]||n.target,s!==t){Os(n,"currentTarget",{configurable:!0,get(){return s||e}});var c=q,u=J;$t(null),le(null);try{for(var f,d=[];s!==null;){var g=s.assignedSlot||s.parentNode||s.host||null;try{var p=s["__"+i];if(p!=null&&(!s.disabled||n.target===s))if(Ps(p)){var[_,...m]=p;_.apply(s,[n,...m])}else p.call(s,n)}catch(x){f?d.push(x):f=x}if(n.cancelBubble||g===t||g===null)break;s=g}if(f){for(let x of d)queueMicrotask(()=>{throw x});throw f}}finally{n.__root=t,delete n.currentTarget,$t(c),le(u)}}}let ce;function pm(){ce=void 0}function ym(n){let t=null,e=H;var i;if(H){for(t=rt,ce===void 0&&(ce=Pe(document.head));ce!==null&&(ce.nodeType!==Ii||ce.data!==As);)ce=ke(ce);ce===null?Jt(!1):ce=Gt(ke(ce))}H||(i=document.head.appendChild(Ai()));try{br(()=>n(i),Sc)}finally{e&&(Jt(!0),ce=rt,Gt(t))}}function su(n){var t=document.createElement("template");return t.innerHTML=n.replaceAll("<!>","<!---->"),t.content}function ki(n,t){var e=J;e.nodes_start===null&&(e.nodes_start=n,e.nodes_end=t)}function Ee(n,t){var e=(t&L_)!==0,i=(t&P_)!==0,r,s=!n.startsWith("<!>");return()=>{if(H)return ki(rt,null),rt;r===void 0&&(r=su(s?n:"<!>"+n),e||(r=Pe(r)));var o=i||Gc?document.importNode(r,!0):r.cloneNode(!0);if(e){var a=Pe(o),l=o.lastChild;ki(a,l)}else ki(o,o);return o}}function vm(n,t,e="svg"){var i=!n.startsWith("<!>"),r=`<${e}>${i?n:"<!>"+n}</${e}>`,s;return()=>{if(H)return ki(rt,null),rt;if(!s){var o=su(r),a=Pe(o);s=Pe(a)}var l=s.cloneNode(!0);return ki(l,l),l}}function Pr(n,t){return vm(n,t,"svg")}function wm(n){return()=>xm(n())}function xm(n){if(H)return n;const t=n.nodeType===$_,e=n.tagName==="SCRIPT"?[n]:n.querySelectorAll("script"),i=J;for(const s of e){const o=document.createElement("script");for(var r of s.attributes)o.setAttribute(r.name,r.value);o.textContent=s.textContent,(t?n.firstChild===s:n===s)&&(i.nodes_start=o),(t?n.lastChild===s:n===s)&&(i.nodes_end=o),s.replaceWith(o)}return n}function Ct(n,t){if(H){J.nodes_end=rt,Er();return}n!==null&&n.before(t)}const Em=["touchstart","touchmove"];function Cm(n){return Em.includes(n)}let Ua=!0;function bm(n,t){var e=t==null?"":typeof t=="object"?t+"":t;e!==(n.__t??(n.__t=n.nodeValue))&&(n.__t=e,n.nodeValue=e+"")}function ou(n,t){return au(n,t)}function Rm(n,t){za(),t.intro=t.intro??!1;const e=t.target,i=H,r=rt;try{for(var s=Pe(e);s&&(s.nodeType!==Ii||s.data!==As);)s=ke(s);if(!s)throw Si;Jt(!0),Gt(s),Er();const o=au(n,{...t,anchor:s});if(rt===null||rt.nodeType!==Ii||rt.data!==Ma)throw Ys(),Si;return Jt(!1),o}catch(o){if(o===Si)return t.recover===!1&&j_(),za(),Xc(e),Jt(!1),ou(n,t);throw o}finally{Jt(i),Gt(r),pm()}}const Oi=new Map;function au(n,{target:t,anchor:e,props:i={},events:r,context:s,intro:o=!0}){za();var a=new Set,l=u=>{for(var f=0;f<u.length;f++){var d=u[f];if(!a.has(d)){a.add(d);var g=Cm(d);t.addEventListener(d,Lr,{passive:g});var p=Oi.get(d);p===void 0?(document.addEventListener(d,Lr,{passive:g}),Oi.set(d,1)):Oi.set(d,p+1)}}};l(Aa(_m)),ru.add(l);var h=void 0,c=tm(()=>{var u=e??t.appendChild(Ai());return qe(()=>{if(s){bn({});var f=ot;f.c=s}r&&(i.$$events=r),H&&ki(u,null),Ua=o,h=n(u,i)||{},Ua=!0,H&&(J.nodes_end=rt),s&&Rn()}),()=>{var g;for(var f of a){t.removeEventListener(f,Lr);var d=Oi.get(f);--d===0?(document.removeEventListener(f,Lr),Oi.delete(f)):Oi.set(f,d)}ru.delete(l),u!==e&&((g=u.parentNode)==null||g.removeChild(u))}});return Va.set(h,c),h}let Va=new WeakMap;function Sm(n,t){const e=Va.get(n);return e?(Va.delete(n),e(t)):Promise.resolve()}function Zs(n){ot===null&&Na(),ct&&ot.l!==null?Am(ot).m.push(n):Xa(()=>{const t=De(n);if(typeof t=="function")return t})}function Tm(n){ot===null&&Na(),Zs(()=>()=>De(n))}function Im(n,t,{bubbles:e=!1,cancelable:i=!1}={}){return new CustomEvent(n,{detail:t,bubbles:e,cancelable:i})}function Mm(){const n=ot;return n===null&&Na(),(t,e,i)=>{var s;const r=(s=n.s.$$events)==null?void 0:s[t];if(r){const o=Ps(r)?r.slice():[r],a=Im(t,e,i);for(const l of o)l.call(n.x,a);return!a.defaultPrevented}return!0}}function Am(n){var t=n.l;return t.u??(t.u={a:[],b:[],m:[]})}const Za=0,Hs=1,Ha=2;function Lm(n,t,e,i,r){H&&Er();var s=n,o=vr(),a=ot,l=Rt,h,c,u,f=o?Kn(void 0):we(void 0,!1,!1),d=o?Kn(void 0):we(void 0,!1,!1),g=!1;function p(m,y){g=!0,y&&(le(_),$t(_),zs(a));try{m===Za&&e&&(h?Zn(h):h=qe(()=>e(s))),m===Hs&&i&&(c?Zn(c):c=qe(()=>i(s,f))),m===Ha&&r&&(u?Zn(u):u=qe(()=>r(s,d))),m!==Za&&h&&Vn(h,()=>h=null),m!==Hs&&c&&Vn(c,()=>c=null),m!==Ha&&u&&Vn(u,()=>u=null)}finally{y&&(zs(null),$t(null),le(null),kt())}}var _=br(()=>{if(l===(l=t()))return;let m=H&&Cc(l)===(s.data===Ls);if(m&&(s=Ws(),Gt(s),Jt(!1),m=!0),Cc(l)){var y=l;g=!1,y.then(x=>{y===l&&(xr(f,x),p(Hs,!0))},x=>{if(y===l&&(xr(d,x),p(Ha,!0),!r))throw d.v}),H?e&&(h=qe(()=>e(s))):Sr(()=>{g||p(Za,!0)})}else xr(f,l),p(Hs,!1);return m&&Jt(!0),()=>l=Rt});H&&(s=rt)}function qs(n,t,[e,i]=[0,0]){H&&e===0&&Er();var r=n,s=null,o=null,a=Rt,l=e>0?$s:0,h=!1;const c=(f,d=!0)=>{h=!0,u(d,f)},u=(f,d)=>{if(a===(a=f))return;let g=!1;if(H&&i!==-1){if(e===0){const _=Dc(r);_===As?i=0:_===Ls?i=1/0:(i=parseInt(_.substring(1)),i!==i&&(i=a?1/0:-1))}const p=i>e;!!a===p&&(r=Ws(),Gt(r),Jt(!1),g=!0,i=-1)}a?(s?Zn(s):d&&(s=qe(()=>d(r))),o&&Vn(o,()=>{o=null})):(o?Zn(o):d&&(o=qe(()=>d(r,[e+1,i]))),s&&Vn(s,()=>{s=null})),g&&Jt(!0)};br(()=>{h=!1,t(c),h||u(null,null)},l),H&&(r=rt)}function Pm(n,t){return t}function km(n,t,e,i){for(var r=[],s=t.length,o=0;o<s;o++)Ya(t[o].e,r,!0);var a=s>0&&r.length===0&&e!==null;if(a){var l=e.parentNode;Xc(l),l.append(e),i.clear(),Mn(n,t[0].prev,t[s-1].next)}Uc(r,()=>{for(var h=0;h<s;h++){var c=t[h];a||(i.delete(c.k),Mn(n,c.prev,c.next)),Je(c.e,!a)}})}function Om(n,t,e,i,r,s=null){var o=n,a={flags:t,items:new Map,first:null};{var l=n;o=H?Gt(Pe(l)):l.appendChild(Ai())}H&&Er();var h=null,c=!1,u=$a(()=>{var f=e();return Ps(f)?f:f==null?[]:Aa(f)});br(()=>{var f=X(u),d=f.length;if(c&&d===0)return;c=d===0;let g=!1;if(H){var p=Dc(o)===Ls;p!==(d===0)&&(o=Ws(),Gt(o),Jt(!1),g=!0)}if(H){for(var _=null,m,y=0;y<d;y++){if(rt.nodeType===Ii&&rt.data===Ma){o=rt,g=!0,Jt(!1);break}var x=f[y],v=i(x,y);m=lu(rt,a,_,null,x,v,y,r,t,e),a.items.set(v,m),_=m}d>0&&Gt(Ws())}H||Fm(f,a,o,r,t,i,e),s!==null&&(d===0?h?Zn(h):h=qe(()=>s(o)):h!==null&&Vn(h,()=>{h=null})),g&&Jt(!0),X(u)}),H&&(o=rt)}function Fm(n,t,e,i,r,s,o){var a=n.length,l=t.items,h=t.first,c=h,u,f=null,d=[],g=[],p,_,m,y;for(y=0;y<a;y+=1){if(p=n[y],_=s(p,y),m=l.get(_),m===void 0){var x=c?c.e.nodes_start:e;f=lu(x,t,f,f===null?t.first:f.next,p,_,y,i,r,o),l.set(_,f),d=[],g=[],c=f.next;continue}if(Dm(m,p,y),(m.e.f&He)!==0&&Zn(m.e),m!==c){if(u!==void 0&&u.has(m)){if(d.length<g.length){var v=g[0],w;f=v.prev;var E=d[0],C=d[d.length-1];for(w=0;w<d.length;w+=1)hu(d[w],v,e);for(w=0;w<g.length;w+=1)u.delete(g[w]);Mn(t,E.prev,C.next),Mn(t,f,E),Mn(t,C,v),c=v,f=C,y-=1,d=[],g=[]}else u.delete(m),hu(m,c,e),Mn(t,m.prev,m.next),Mn(t,m,f===null?t.first:f.next),Mn(t,f,m),f=m;continue}for(d=[],g=[];c!==null&&c.k!==_;)(c.e.f&He)===0&&(u??(u=new Set)).add(c),g.push(c),c=c.next;if(c===null)continue;m=c}d.push(m),f=m,c=m.next}if(c!==null||u!==void 0){for(var R=u===void 0?[]:Aa(u);c!==null;)(c.e.f&He)===0&&R.push(c),c=c.next;var S=R.length;if(S>0){var I=a===0?e:null;km(t,R,I,l)}}J.first=t.first&&t.first.e,J.last=f&&f.e}function Dm(n,t,e,i){xr(n.v,t),n.i=e}function lu(n,t,e,i,r,s,o,a,l,h){var c=(l&w_)!==0,u=(l&E_)===0,f=c?u?we(r,!1,!1):Kn(r):r,d=(l&x_)===0?o:Kn(o),g={i:d,v:f,k:s,a:null,e:null,prev:e,next:i};try{return g.e=qe(()=>a(n,f,d,h),H),g.e.prev=e&&e.e,g.e.next=i&&i.e,e===null?t.first=g:(e.next=g,e.e.next=g.e),i!==null&&(i.prev=g,i.e.prev=g.e),g}finally{}}function hu(n,t,e){for(var i=n.next?n.next.e.nodes_start:e,r=t?t.e.nodes_start:e,s=n.e.nodes_start;s!==i;){var o=ke(s);r.before(s),s=o}}function Mn(n,t,e){t===null?n.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}function Nm(n,t){Sr(()=>{var e=n.getRootNode(),i=e.host?e:e.head??e.ownerDocument.head;if(!i.querySelector("#"+t.hash)){const r=document.createElement("style");r.id=t.hash,r.textContent=t.code,i.appendChild(r)}})}function cu(n){var t,e,i="";if(typeof n=="string"||typeof n=="number")i+=n;else if(typeof n=="object")if(Array.isArray(n)){var r=n.length;for(t=0;t<r;t++)n[t]&&(e=cu(n[t]))&&(i&&(i+=" "),i+=e)}else for(e in n)n[e]&&(i&&(i+=" "),i+=e);return i}function Gm(){for(var n,t,e=0,i="",r=arguments.length;e<r;e++)(n=arguments[e])&&(t=cu(n))&&(i&&(i+=" "),i+=t);return i}function $m(n){return typeof n=="object"?Gm(n):n??""}function zm(n,t,e){var i=n==null?"":""+n;return i===""?null:i}function Js(n,t,e,i,r,s){var o=n.__className;if(H||o!==e||o===void 0){var a=zm(e);(!H||a!==n.getAttribute("class"))&&(a==null?n.removeAttribute("class"):n.className=a),n.__className=e}return s}const Xm=Symbol("is custom element"),Ym=Symbol("is html");function Qs(n,t,e,i){var r=Wm(n);H&&(r[t]=n.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&n.nodeName==="LINK")||r[t]!==(r[t]=e)&&(t==="loading"&&(n[G_]=e),e==null?n.removeAttribute(t):typeof e!="string"&&Bm(n).includes(t)?n[t]=e:n.setAttribute(t,e))}function Wm(n){return n.__attributes??(n.__attributes={[Xm]:n.nodeName.includes("-"),[Ym]:n.namespaceURI===k_})}var uu=new Map;function Bm(n){var t=uu.get(n.nodeName);if(t)return t;uu.set(n.nodeName,t=[]);for(var e,i=n,r=Element.prototype;r!==i;){e=xc(i);for(var s in e)e[s].set&&t.push(s);i=La(i)}return t}const jm=()=>performance.now(),Qe={tick:n=>requestAnimationFrame(n),now:()=>jm(),tasks:new Set};function fu(){const n=Qe.now();Qe.tasks.forEach(t=>{t.c(n)||(Qe.tasks.delete(t),t.f())}),Qe.tasks.size!==0&&Qe.tick(fu)}function Km(n){let t;return Qe.tasks.size===0&&Qe.tick(fu),{promise:new Promise(e=>{Qe.tasks.add(t={c:n,f:e})}),abort(){Qe.tasks.delete(t)}}}function to(n,t){iu(()=>{n.dispatchEvent(new CustomEvent(t))})}function Um(n){if(n==="float")return"cssFloat";if(n==="offset")return"cssOffset";if(n.startsWith("--"))return n;const t=n.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(e=>e[0].toUpperCase()+e.slice(1)).join("")}function du(n){const t={},e=n.split(";");for(const i of e){const[r,s]=i.split(":");if(!r||s===void 0)break;const o=Um(r.trim());t[o]=s.trim()}return t}const Vm=n=>n;function gu(n,t,e,i){var r=(n&I_)!==0,s=(n&M_)!==0,o=r&&s,a=(n&A_)!==0,l=o?"both":r?"in":"out",h,c=t.inert,u=t.style.overflow,f,d;function g(){var x=q,v=J;$t(null),le(null);try{return h??(h=e()(t,(i==null?void 0:i())??{},{direction:l}))}finally{$t(x),le(v)}}var p={is_global:a,in(){var x;if(t.inert=c,!r){d==null||d.abort(),(x=d==null?void 0:d.reset)==null||x.call(d);return}s||f==null||f.abort(),to(t,"introstart"),f=qa(t,g(),d,1,()=>{to(t,"introend"),f==null||f.abort(),f=h=void 0,t.style.overflow=u})},out(x){if(!s){x==null||x(),h=void 0;return}t.inert=!0,to(t,"outrostart"),d=qa(t,g(),f,0,()=>{to(t,"outroend"),x==null||x()})},stop:()=>{f==null||f.abort(),d==null||d.abort()}},_=J;if((_.transitions??(_.transitions=[])).push(p),r&&Ua){var m=a;if(!m){for(var y=_.parent;y&&(y.f&$s)!==0;)for(;(y=y.parent)&&(y.f&Ns)===0;);m=!y||(y.f&Oa)!==0}m&&js(()=>{De(()=>p.in())})}}function qa(n,t,e,i,r){var s=i===1;if(Ti(t)){var o,a=!1;return Sr(()=>{if(!a){var _=t({direction:s?"in":"out"});o=qa(n,_,e,i,r)}}),{abort:()=>{a=!0,o==null||o.abort()},deactivate:()=>o.deactivate(),reset:()=>o.reset(),t:()=>o.t()}}if(e==null||e.deactivate(),!(t!=null&&t.duration))return r(),{abort:yr,deactivate:yr,reset:yr,t:()=>i};const{delay:l=0,css:h,tick:c,easing:u=Vm}=t;var f=[];if(s&&e===void 0&&(c&&c(0,1),h)){var d=du(h(0,1));f.push(d,d)}var g=()=>1-i,p=n.animate(f,{duration:l,fill:"forwards"});return p.onfinish=()=>{p.cancel();var _=(e==null?void 0:e.t())??1-i;e==null||e.abort();var m=i-_,y=t.duration*Math.abs(m),x=[];if(y>0){var v=!1;if(h)for(var w=Math.ceil(y/16.666666666666668),E=0;E<=w;E+=1){var C=_+m*u(E/w),R=du(h(C,1-C));x.push(R),v||(v=R.overflow==="hidden")}v&&(n.style.overflow="hidden"),g=()=>{var S=p.currentTime;return _+m*u(S/y)},c&&Km(()=>{if(p.playState!=="running")return!1;var S=g();return c(S,1-S),!0})}p=n.animate(x,{duration:y,fill:"forwards"}),p.onfinish=()=>{g=()=>i,c==null||c(i,1-i),r()}},{abort:()=>{p&&(p.cancel(),p.effect=null,p.onfinish=yr)},deactivate:()=>{r=yr},reset:()=>{i===0&&(c==null||c(1,0))},t:()=>g()}}function _u(n,t){return n===t||(n==null?void 0:n[Cn])===t}function eo(n={},t,e,i){return js(()=>{var r,s;return Cr(()=>{r=s,s=[],De(()=>{n!==e(...s)&&(t(n,...s),r&&_u(e(...r),n)&&t(null,...r))})}),()=>{Sr(()=>{s&&_u(e(...s),n)&&t(null,...s)})}}),n}function qn(n=!1){const t=ot,e=t.l.u;if(!e)return;let i=()=>ja(t.s);if(n){let r=0,s={};const o=Xs(()=>{let a=!1;const l=t.s;for(const h in l)l[h]!==s[h]&&(s[h]=l[h],a=!0);return a&&r++,r});i=()=>X(o)}e.b.length&&J_(()=>{mu(t,i),Fs(e.b)}),Xa(()=>{const r=De(()=>e.m.map(N_));return()=>{for(const s of r)typeof s=="function"&&s()}}),e.a.length&&Xa(()=>{mu(t,i),Fs(e.a)})}function mu(n,t){if(n.l.s)for(const e of n.l.s)X(e);t()}let no=!1;function Zm(n){var t=no;try{return no=!1,[n(),no]}finally{no=t}}const Hm={get(n,t){let e=n.props.length;for(;e--;){let i=n.props[e];if(Ti(i)&&(i=i()),typeof i=="object"&&i!==null&&t in i)return i[t]}},set(n,t,e){let i=n.props.length;for(;i--;){let r=n.props[i];Ti(r)&&(r=r());const s=Ue(r,t);if(s&&s.set)return s.set(e),!0}return!1},getOwnPropertyDescriptor(n,t){let e=n.props.length;for(;e--;){let i=n.props[e];if(Ti(i)&&(i=i()),typeof i=="object"&&i!==null&&t in i){const r=Ue(i,t);return r&&!r.configurable&&(r.configurable=!0),r}}},has(n,t){if(t===Cn||t===Da)return!1;for(let e of n.props)if(Ti(e)&&(e=e()),e!=null&&t in e)return!0;return!1},ownKeys(n){const t=[];for(let e of n.props)if(Ti(e)&&(e=e()),!!e){for(const i in e)t.includes(i)||t.push(i);for(const i of Object.getOwnPropertySymbols(e))t.includes(i)||t.push(i)}return t}};function qm(...n){return new Proxy({props:n},Hm)}function Jm(n){var t;return((t=n.ctx)==null?void 0:t.d)??!1}function te(n,t,e,i){var m;var r=!ct||(e&b_)!==0,s=(e&S_)!==0,o=(e&T_)!==0,a=i,l=!0,h=()=>(l&&(l=!1,a=o?De(i):i),a),c;if(s){var u=Cn in n||Da in n;c=((m=Ue(n,t))==null?void 0:m.set)??(u&&t in n?y=>n[t]=y:void 0)}var f,d=!1;s?[f,d]=Zm(()=>n[t]):f=n[t],f===void 0&&i!==void 0&&(f=h(),c&&(r&&K_(),c(f)));var g;if(r?g=()=>{var y=n[t];return y===void 0?h():(l=!0,y)}:g=()=>{var y=n[t];return y!==void 0&&(a=void 0),y===void 0?a:y},r&&(e&R_)===0)return g;if(c){var p=n.$$legacy;return function(y,x){return arguments.length>0?((!r||!x||p||d)&&c(x?g():y),y):g()}}var _=((e&C_)!==0?Xs:$a)(g);return s&&X(_),function(y,x){if(arguments.length>0){const v=x?X(_):r&&s?Mi(y):y;return pt(_,v),a!==void 0&&(a=v),y}return Jm(_)?_.v:X(_)}}function Qm(n){return new tp(n)}class tp{constructor(t){yc(this,yn);yc(this,_e);var s;var e=new Map,i=(o,a)=>{var l=we(a,!1,!1);return e.set(o,l),l};const r=new Proxy({...t.props||{},$$events:{}},{get(o,a){return X(e.get(a)??i(a,Reflect.get(o,a)))},has(o,a){return a===Da?!0:(X(e.get(a)??i(a,Reflect.get(o,a))),Reflect.has(o,a))},set(o,a,l){return pt(e.get(a)??i(a,l),l),Reflect.set(o,a,l)}});vc(this,_e,(t.hydrate?Rm:ou)(t.component,{target:t.target,anchor:t.anchor,props:r,context:t.context,intro:t.intro??!1,recover:t.recover})),(!((s=t==null?void 0:t.props)!=null&&s.$$host)||t.sync===!1)&&kt(),vc(this,yn,r.$$events);for(const o of Object.keys(Zt(this,_e)))o==="$set"||o==="$destroy"||o==="$on"||Os(this,o,{get(){return Zt(this,_e)[o]},set(a){Zt(this,_e)[o]=a},enumerable:!0});Zt(this,_e).$set=o=>{Object.assign(r,o)},Zt(this,_e).$destroy=()=>{Sm(Zt(this,_e))}}$set(t){Zt(this,_e).$set(t)}$on(t,e){Zt(this,yn)[t]=Zt(this,yn)[t]||[];const i=(...r)=>e.call(this,...r);return Zt(this,yn)[t].push(i),()=>{Zt(this,yn)[t]=Zt(this,yn)[t].filter(r=>r!==i)}}$destroy(){Zt(this,_e).$destroy()}}yn=new WeakMap,_e=new WeakMap;let pu;typeof HTMLElement=="function"&&(pu=class extends HTMLElement{constructor(t,e,i){super();Vt(this,"$$ctor");Vt(this,"$$s");Vt(this,"$$c");Vt(this,"$$cn",!1);Vt(this,"$$d",{});Vt(this,"$$r",!1);Vt(this,"$$p_d",{});Vt(this,"$$l",{});Vt(this,"$$l_u",new Map);Vt(this,"$$me");this.$$ctor=t,this.$$s=e,i&&this.attachShadow({mode:"open"})}addEventListener(t,e,i){if(this.$$l[t]=this.$$l[t]||[],this.$$l[t].push(e),this.$$c){const r=this.$$c.$on(t,e);this.$$l_u.set(e,r)}super.addEventListener(t,e,i)}removeEventListener(t,e,i){if(super.removeEventListener(t,e,i),this.$$c){const r=this.$$l_u.get(e);r&&(r(),this.$$l_u.delete(e))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){let t=function(r){return s=>{const o=document.createElement("slot");r!=="default"&&(o.name=r),Ct(s,o)}};if(await Promise.resolve(),!this.$$cn||this.$$c)return;const e={},i=ep(this);for(const r of this.$$s)r in i&&(r==="default"&&!this.$$d.children?(this.$$d.children=t(r),e.default=!0):e[r]=t(r));for(const r of this.attributes){const s=this.$$g_p(r.name);s in this.$$d||(this.$$d[s]=io(s,r.value,this.$$p_d,"toProp"))}for(const r in this.$$p_d)!(r in this.$$d)&&this[r]!==void 0&&(this.$$d[r]=this[r],delete this[r]);this.$$c=Qm({component:this.$$ctor,target:this.shadowRoot||this,props:{...this.$$d,$$slots:e,$$host:this}}),this.$$me=Q_(()=>{Cr(()=>{var r;this.$$r=!0;for(const s of ks(this.$$c)){if(!((r=this.$$p_d[s])!=null&&r.reflect))continue;this.$$d[s]=this.$$c[s];const o=io(s,this.$$d[s],this.$$p_d,"toAttribute");o==null?this.removeAttribute(this.$$p_d[s].attribute||s):this.setAttribute(this.$$p_d[s].attribute||s,o)}this.$$r=!1})});for(const r in this.$$l)for(const s of this.$$l[r]){const o=this.$$c.$on(r,s);this.$$l_u.set(s,o)}this.$$l={}}}attributeChangedCallback(t,e,i){var r;this.$$r||(t=this.$$g_p(t),this.$$d[t]=io(t,i,this.$$p_d,"toProp"),(r=this.$$c)==null||r.$set({[t]:this.$$d[t]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then(()=>{!this.$$cn&&this.$$c&&(this.$$c.$destroy(),this.$$me(),this.$$c=void 0)})}$$g_p(t){return ks(this.$$p_d).find(e=>this.$$p_d[e].attribute===t||!this.$$p_d[e].attribute&&e.toLowerCase()===t)||t}});function io(n,t,e,i){var s;const r=(s=e[n])==null?void 0:s.type;if(t=r==="Boolean"&&typeof t!="boolean"?t!=null:t,!i||!e[n])return t;if(i==="toAttribute")switch(r){case"Object":case"Array":return t==null?null:JSON.stringify(t);case"Boolean":return t?"":null;case"Number":return t??null;default:return t}else switch(r){case"Object":case"Array":return t&&JSON.parse(t);case"Boolean":return t;case"Number":return t!=null?+t:t;default:return t}}function ep(n){const t={};return n.childNodes.forEach(e=>{t[e.slot||"default"]=!0}),t}function Jn(n,t,e,i,r,s){let o=class extends pu{constructor(){super(n,e,r),this.$$p_d=t}static get observedAttributes(){return ks(t).map(a=>(t[a].attribute||a).toLowerCase())}};return ks(t).forEach(a=>{Os(o.prototype,a,{get(){return this.$$c&&a in this.$$c?this.$$c[a]:this.$$d[a]},set(l){var u;l=io(a,l,t),this.$$d[a]=l;var h=this.$$c;if(h){var c=(u=Ue(h,a))==null?void 0:u.get;c?h[a]=l:h.$set({[a]:l})}}})}),i.forEach(a=>{Os(o.prototype,a,{get(){var l;return(l=this.$$c)==null?void 0:l[a]}})}),n.element=o,o}function ro(n,t){return n==null||t==null?NaN:n<t?-1:n>t?1:n>=t?0:NaN}function np(n,t){return n==null||t==null?NaN:t<n?-1:t>n?1:t>=n?0:NaN}function Ja(n){let t,e,i;n.length!==2?(t=ro,e=(a,l)=>ro(n(a),l),i=(a,l)=>n(a)-l):(t=n===ro||n===np?n:ip,e=n,i=n);function r(a,l,h=0,c=a.length){if(h<c){if(t(l,l)!==0)return c;do{const u=h+c>>>1;e(a[u],l)<0?h=u+1:c=u}while(h<c)}return h}function s(a,l,h=0,c=a.length){if(h<c){if(t(l,l)!==0)return c;do{const u=h+c>>>1;e(a[u],l)<=0?h=u+1:c=u}while(h<c)}return h}function o(a,l,h=0,c=a.length){const u=r(a,l,h,c-1);return u>h&&i(a[u-1],l)>-i(a[u],l)?u-1:u}return{left:r,center:o,right:s}}function ip(){return 0}function rp(n){return n===null?NaN:+n}const sp=Ja(ro).right;Ja(rp).center;function yu(n,t){let e,i;if(t===void 0)for(const r of n)r!=null&&(e===void 0?r>=r&&(e=i=r):(e>r&&(e=r),i<r&&(i=r)));else{let r=-1;for(let s of n)(s=t(s,++r,n))!=null&&(e===void 0?s>=s&&(e=i=s):(e>s&&(e=s),i<s&&(i=s)))}return[e,i]}const op=Math.sqrt(50),ap=Math.sqrt(10),lp=Math.sqrt(2);function so(n,t,e){const i=(t-n)/Math.max(0,e),r=Math.floor(Math.log10(i)),s=i/Math.pow(10,r),o=s>=op?10:s>=ap?5:s>=lp?2:1;let a,l,h;return r<0?(h=Math.pow(10,-r)/o,a=Math.round(n*h),l=Math.round(t*h),a/h<n&&++a,l/h>t&&--l,h=-h):(h=Math.pow(10,r)*o,a=Math.round(n/h),l=Math.round(t/h),a*h<n&&++a,l*h>t&&--l),l<a&&.5<=e&&e<2?so(n,t,e*2):[a,l,h]}function hp(n,t,e){if(t=+t,n=+n,e=+e,!(e>0))return[];if(n===t)return[n];const i=t<n,[r,s,o]=i?so(t,n,e):so(n,t,e);if(!(s>=r))return[];const a=s-r+1,l=new Array(a);if(i)if(o<0)for(let h=0;h<a;++h)l[h]=(s-h)/-o;else for(let h=0;h<a;++h)l[h]=(s-h)*o;else if(o<0)for(let h=0;h<a;++h)l[h]=(r+h)/-o;else for(let h=0;h<a;++h)l[h]=(r+h)*o;return l}function Qa(n,t,e){return t=+t,n=+n,e=+e,so(n,t,e)[2]}function cp(n,t,e){t=+t,n=+n,e=+e;const i=t<n,r=i?Qa(t,n,e):Qa(n,t,e);return(i?-1:1)*(r<0?1/-r:r)}function up(n){return n}var tl=1,el=2,nl=3,kr=4,vu=1e-6;function fp(n){return"translate("+n+",0)"}function dp(n){return"translate(0,"+n+")"}function gp(n){return t=>+n(t)}function _p(n,t){return t=Math.max(0,n.bandwidth()-t*2)/2,n.round()&&(t=Math.round(t)),e=>+n(e)+t}function mp(){return!this.__axis}function wu(n,t){var e=[],i=null,r=null,s=6,o=6,a=3,l=typeof window<"u"&&window.devicePixelRatio>1?0:.5,h=n===tl||n===kr?-1:1,c=n===kr||n===el?"x":"y",u=n===tl||n===nl?fp:dp;function f(d){var g=i??(t.ticks?t.ticks.apply(t,e):t.domain()),p=r??(t.tickFormat?t.tickFormat.apply(t,e):up),_=Math.max(s,0)+a,m=t.range(),y=+m[0]+l,x=+m[m.length-1]+l,v=(t.bandwidth?_p:gp)(t.copy(),l),w=d.selection?d.selection():d,E=w.selectAll(".domain").data([null]),C=w.selectAll(".tick").data(g,t).order(),R=C.exit(),S=C.enter().append("g").attr("class","tick"),I=C.select("line"),T=C.select("text");E=E.merge(E.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),C=C.merge(S),I=I.merge(S.append("line").attr("stroke","currentColor").attr(c+"2",h*s)),T=T.merge(S.append("text").attr("fill","currentColor").attr(c,h*_).attr("dy",n===tl?"0em":n===nl?"0.71em":"0.32em")),d!==w&&(E=E.transition(d),C=C.transition(d),I=I.transition(d),T=T.transition(d),R=R.transition(d).attr("opacity",vu).attr("transform",function(L){return isFinite(L=v(L))?u(L+l):this.getAttribute("transform")}),S.attr("opacity",vu).attr("transform",function(L){var A=this.parentNode.__axis;return u((A&&isFinite(A=A(L))?A:v(L))+l)})),R.remove(),E.attr("d",n===kr||n===el?o?"M"+h*o+","+y+"H"+l+"V"+x+"H"+h*o:"M"+l+","+y+"V"+x:o?"M"+y+","+h*o+"V"+l+"H"+x+"V"+h*o:"M"+y+","+l+"H"+x),C.attr("opacity",1).attr("transform",function(L){return u(v(L)+l)}),I.attr(c+"2",h*s),T.attr(c,h*_).text(p),w.filter(mp).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",n===el?"start":n===kr?"end":"middle"),w.each(function(){this.__axis=v})}return f.scale=function(d){return arguments.length?(t=d,f):t},f.ticks=function(){return e=Array.from(arguments),f},f.tickArguments=function(d){return arguments.length?(e=d==null?[]:Array.from(d),f):e.slice()},f.tickValues=function(d){return arguments.length?(i=d==null?null:Array.from(d),f):i&&i.slice()},f.tickFormat=function(d){return arguments.length?(r=d,f):r},f.tickSize=function(d){return arguments.length?(s=o=+d,f):s},f.tickSizeInner=function(d){return arguments.length?(s=+d,f):s},f.tickSizeOuter=function(d){return arguments.length?(o=+d,f):o},f.tickPadding=function(d){return arguments.length?(a=+d,f):a},f.offset=function(d){return arguments.length?(l=+d,f):l},f}function pp(n){return wu(nl,n)}function yp(n){return wu(kr,n)}var vp={value:()=>{}};function xu(){for(var n=0,t=arguments.length,e={},i;n<t;++n){if(!(i=arguments[n]+"")||i in e||/[\s.]/.test(i))throw new Error("illegal type: "+i);e[i]=[]}return new oo(e)}function oo(n){this._=n}function wp(n,t){return n.trim().split(/^|\s+/).map(function(e){var i="",r=e.indexOf(".");if(r>=0&&(i=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:i}})}oo.prototype=xu.prototype={constructor:oo,on:function(n,t){var e=this._,i=wp(n+"",e),r,s=-1,o=i.length;if(arguments.length<2){for(;++s<o;)if((r=(n=i[s]).type)&&(r=xp(e[r],n.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(r=(n=i[s]).type)e[r]=Eu(e[r],n.name,t);else if(t==null)for(r in e)e[r]=Eu(e[r],n.name,null);return this},copy:function(){var n={},t=this._;for(var e in t)n[e]=t[e].slice();return new oo(n)},call:function(n,t){if((r=arguments.length-2)>0)for(var e=new Array(r),i=0,r,s;i<r;++i)e[i]=arguments[i+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(s=this._[n],i=0,r=s.length;i<r;++i)s[i].value.apply(t,e)},apply:function(n,t,e){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var i=this._[n],r=0,s=i.length;r<s;++r)i[r].value.apply(t,e)}};function xp(n,t){for(var e=0,i=n.length,r;e<i;++e)if((r=n[e]).name===t)return r.value}function Eu(n,t,e){for(var i=0,r=n.length;i<r;++i)if(n[i].name===t){n[i]=vp,n=n.slice(0,i).concat(n.slice(i+1));break}return e!=null&&n.push({name:t,value:e}),n}var il="http://www.w3.org/1999/xhtml";const Cu={svg:"http://www.w3.org/2000/svg",xhtml:il,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ao(n){var t=n+="",e=t.indexOf(":");return e>=0&&(t=n.slice(0,e))!=="xmlns"&&(n=n.slice(e+1)),Cu.hasOwnProperty(t)?{space:Cu[t],local:n}:n}function Ep(n){return function(){var t=this.ownerDocument,e=this.namespaceURI;return e===il&&t.documentElement.namespaceURI===il?t.createElement(n):t.createElementNS(e,n)}}function Cp(n){return function(){return this.ownerDocument.createElementNS(n.space,n.local)}}function bu(n){var t=ao(n);return(t.local?Cp:Ep)(t)}function bp(){}function rl(n){return n==null?bp:function(){return this.querySelector(n)}}function Rp(n){typeof n!="function"&&(n=rl(n));for(var t=this._groups,e=t.length,i=new Array(e),r=0;r<e;++r)for(var s=t[r],o=s.length,a=i[r]=new Array(o),l,h,c=0;c<o;++c)(l=s[c])&&(h=n.call(l,l.__data__,c,s))&&("__data__"in l&&(h.__data__=l.__data__),a[c]=h);return new ee(i,this._parents)}function Sp(n){return n==null?[]:Array.isArray(n)?n:Array.from(n)}function Tp(){return[]}function Ru(n){return n==null?Tp:function(){return this.querySelectorAll(n)}}function Ip(n){return function(){return Sp(n.apply(this,arguments))}}function Mp(n){typeof n=="function"?n=Ip(n):n=Ru(n);for(var t=this._groups,e=t.length,i=[],r=[],s=0;s<e;++s)for(var o=t[s],a=o.length,l,h=0;h<a;++h)(l=o[h])&&(i.push(n.call(l,l.__data__,h,o)),r.push(l));return new ee(i,r)}function Su(n){return function(){return this.matches(n)}}function Tu(n){return function(t){return t.matches(n)}}var Ap=Array.prototype.find;function Lp(n){return function(){return Ap.call(this.children,n)}}function Pp(){return this.firstElementChild}function kp(n){return this.select(n==null?Pp:Lp(typeof n=="function"?n:Tu(n)))}var Op=Array.prototype.filter;function Fp(){return Array.from(this.children)}function Dp(n){return function(){return Op.call(this.children,n)}}function Np(n){return this.selectAll(n==null?Fp:Dp(typeof n=="function"?n:Tu(n)))}function Gp(n){typeof n!="function"&&(n=Su(n));for(var t=this._groups,e=t.length,i=new Array(e),r=0;r<e;++r)for(var s=t[r],o=s.length,a=i[r]=[],l,h=0;h<o;++h)(l=s[h])&&n.call(l,l.__data__,h,s)&&a.push(l);return new ee(i,this._parents)}function Iu(n){return new Array(n.length)}function $p(){return new ee(this._enter||this._groups.map(Iu),this._parents)}function lo(n,t){this.ownerDocument=n.ownerDocument,this.namespaceURI=n.namespaceURI,this._next=null,this._parent=n,this.__data__=t}lo.prototype={constructor:lo,appendChild:function(n){return this._parent.insertBefore(n,this._next)},insertBefore:function(n,t){return this._parent.insertBefore(n,t)},querySelector:function(n){return this._parent.querySelector(n)},querySelectorAll:function(n){return this._parent.querySelectorAll(n)}};function zp(n){return function(){return n}}function Xp(n,t,e,i,r,s){for(var o=0,a,l=t.length,h=s.length;o<h;++o)(a=t[o])?(a.__data__=s[o],i[o]=a):e[o]=new lo(n,s[o]);for(;o<l;++o)(a=t[o])&&(r[o]=a)}function Yp(n,t,e,i,r,s,o){var a,l,h=new Map,c=t.length,u=s.length,f=new Array(c),d;for(a=0;a<c;++a)(l=t[a])&&(f[a]=d=o.call(l,l.__data__,a,t)+"",h.has(d)?r[a]=l:h.set(d,l));for(a=0;a<u;++a)d=o.call(n,s[a],a,s)+"",(l=h.get(d))?(i[a]=l,l.__data__=s[a],h.delete(d)):e[a]=new lo(n,s[a]);for(a=0;a<c;++a)(l=t[a])&&h.get(f[a])===l&&(r[a]=l)}function Wp(n){return n.__data__}function Bp(n,t){if(!arguments.length)return Array.from(this,Wp);var e=t?Yp:Xp,i=this._parents,r=this._groups;typeof n!="function"&&(n=zp(n));for(var s=r.length,o=new Array(s),a=new Array(s),l=new Array(s),h=0;h<s;++h){var c=i[h],u=r[h],f=u.length,d=jp(n.call(c,c&&c.__data__,h,i)),g=d.length,p=a[h]=new Array(g),_=o[h]=new Array(g),m=l[h]=new Array(f);e(c,u,p,_,m,d,t);for(var y=0,x=0,v,w;y<g;++y)if(v=p[y]){for(y>=x&&(x=y+1);!(w=_[x])&&++x<g;);v._next=w||null}}return o=new ee(o,i),o._enter=a,o._exit=l,o}function jp(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function Kp(){return new ee(this._exit||this._groups.map(Iu),this._parents)}function Up(n,t,e){var i=this.enter(),r=this,s=this.exit();return typeof n=="function"?(i=n(i),i&&(i=i.selection())):i=i.append(n+""),t!=null&&(r=t(r),r&&(r=r.selection())),e==null?s.remove():e(s),i&&r?i.merge(r).order():r}function Vp(n){for(var t=n.selection?n.selection():n,e=this._groups,i=t._groups,r=e.length,s=i.length,o=Math.min(r,s),a=new Array(r),l=0;l<o;++l)for(var h=e[l],c=i[l],u=h.length,f=a[l]=new Array(u),d,g=0;g<u;++g)(d=h[g]||c[g])&&(f[g]=d);for(;l<r;++l)a[l]=e[l];return new ee(a,this._parents)}function Zp(){for(var n=this._groups,t=-1,e=n.length;++t<e;)for(var i=n[t],r=i.length-1,s=i[r],o;--r>=0;)(o=i[r])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function Hp(n){n||(n=qp);function t(u,f){return u&&f?n(u.__data__,f.__data__):!u-!f}for(var e=this._groups,i=e.length,r=new Array(i),s=0;s<i;++s){for(var o=e[s],a=o.length,l=r[s]=new Array(a),h,c=0;c<a;++c)(h=o[c])&&(l[c]=h);l.sort(t)}return new ee(r,this._parents).order()}function qp(n,t){return n<t?-1:n>t?1:n>=t?0:NaN}function Jp(){var n=arguments[0];return arguments[0]=this,n.apply(null,arguments),this}function Qp(){return Array.from(this)}function t0(){for(var n=this._groups,t=0,e=n.length;t<e;++t)for(var i=n[t],r=0,s=i.length;r<s;++r){var o=i[r];if(o)return o}return null}function e0(){let n=0;for(const t of this)++n;return n}function n0(){return!this.node()}function i0(n){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var r=t[e],s=0,o=r.length,a;s<o;++s)(a=r[s])&&n.call(a,a.__data__,s,r);return this}function r0(n){return function(){this.removeAttribute(n)}}function s0(n){return function(){this.removeAttributeNS(n.space,n.local)}}function o0(n,t){return function(){this.setAttribute(n,t)}}function a0(n,t){return function(){this.setAttributeNS(n.space,n.local,t)}}function l0(n,t){return function(){var e=t.apply(this,arguments);e==null?this.removeAttribute(n):this.setAttribute(n,e)}}function h0(n,t){return function(){var e=t.apply(this,arguments);e==null?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,e)}}function c0(n,t){var e=ao(n);if(arguments.length<2){var i=this.node();return e.local?i.getAttributeNS(e.space,e.local):i.getAttribute(e)}return this.each((t==null?e.local?s0:r0:typeof t=="function"?e.local?h0:l0:e.local?a0:o0)(e,t))}function Mu(n){return n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView}function u0(n){return function(){this.style.removeProperty(n)}}function f0(n,t,e){return function(){this.style.setProperty(n,t,e)}}function d0(n,t,e){return function(){var i=t.apply(this,arguments);i==null?this.style.removeProperty(n):this.style.setProperty(n,i,e)}}function g0(n,t,e){return arguments.length>1?this.each((t==null?u0:typeof t=="function"?d0:f0)(n,t,e??"")):Fi(this.node(),n)}function Fi(n,t){return n.style.getPropertyValue(t)||Mu(n).getComputedStyle(n,null).getPropertyValue(t)}function _0(n){return function(){delete this[n]}}function m0(n,t){return function(){this[n]=t}}function p0(n,t){return function(){var e=t.apply(this,arguments);e==null?delete this[n]:this[n]=e}}function y0(n,t){return arguments.length>1?this.each((t==null?_0:typeof t=="function"?p0:m0)(n,t)):this.node()[n]}function Au(n){return n.trim().split(/^|\s+/)}function sl(n){return n.classList||new Lu(n)}function Lu(n){this._node=n,this._names=Au(n.getAttribute("class")||"")}Lu.prototype={add:function(n){var t=this._names.indexOf(n);t<0&&(this._names.push(n),this._node.setAttribute("class",this._names.join(" ")))},remove:function(n){var t=this._names.indexOf(n);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(n){return this._names.indexOf(n)>=0}};function Pu(n,t){for(var e=sl(n),i=-1,r=t.length;++i<r;)e.add(t[i])}function ku(n,t){for(var e=sl(n),i=-1,r=t.length;++i<r;)e.remove(t[i])}function v0(n){return function(){Pu(this,n)}}function w0(n){return function(){ku(this,n)}}function x0(n,t){return function(){(t.apply(this,arguments)?Pu:ku)(this,n)}}function E0(n,t){var e=Au(n+"");if(arguments.length<2){for(var i=sl(this.node()),r=-1,s=e.length;++r<s;)if(!i.contains(e[r]))return!1;return!0}return this.each((typeof t=="function"?x0:t?v0:w0)(e,t))}function C0(){this.textContent=""}function b0(n){return function(){this.textContent=n}}function R0(n){return function(){var t=n.apply(this,arguments);this.textContent=t??""}}function S0(n){return arguments.length?this.each(n==null?C0:(typeof n=="function"?R0:b0)(n)):this.node().textContent}function T0(){this.innerHTML=""}function I0(n){return function(){this.innerHTML=n}}function M0(n){return function(){var t=n.apply(this,arguments);this.innerHTML=t??""}}function A0(n){return arguments.length?this.each(n==null?T0:(typeof n=="function"?M0:I0)(n)):this.node().innerHTML}function L0(){this.nextSibling&&this.parentNode.appendChild(this)}function P0(){return this.each(L0)}function k0(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function O0(){return this.each(k0)}function F0(n){var t=typeof n=="function"?n:bu(n);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function D0(){return null}function N0(n,t){var e=typeof n=="function"?n:bu(n),i=t==null?D0:typeof t=="function"?t:rl(t);return this.select(function(){return this.insertBefore(e.apply(this,arguments),i.apply(this,arguments)||null)})}function G0(){var n=this.parentNode;n&&n.removeChild(this)}function $0(){return this.each(G0)}function z0(){var n=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(n,this.nextSibling):n}function X0(){var n=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(n,this.nextSibling):n}function Y0(n){return this.select(n?X0:z0)}function W0(n){return arguments.length?this.property("__data__",n):this.node().__data__}function B0(n){return function(t){n.call(this,t,this.__data__)}}function j0(n){return n.trim().split(/^|\s+/).map(function(t){var e="",i=t.indexOf(".");return i>=0&&(e=t.slice(i+1),t=t.slice(0,i)),{type:t,name:e}})}function K0(n){return function(){var t=this.__on;if(t){for(var e=0,i=-1,r=t.length,s;e<r;++e)s=t[e],(!n.type||s.type===n.type)&&s.name===n.name?this.removeEventListener(s.type,s.listener,s.options):t[++i]=s;++i?t.length=i:delete this.__on}}}function U0(n,t,e){return function(){var i=this.__on,r,s=B0(t);if(i){for(var o=0,a=i.length;o<a;++o)if((r=i[o]).type===n.type&&r.name===n.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=e),r.value=t;return}}this.addEventListener(n.type,s,e),r={type:n.type,name:n.name,value:t,listener:s,options:e},i?i.push(r):this.__on=[r]}}function V0(n,t,e){var i=j0(n+""),r,s=i.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,h=a.length,c;l<h;++l)for(r=0,c=a[l];r<s;++r)if((o=i[r]).type===c.type&&o.name===c.name)return c.value}return}for(a=t?U0:K0,r=0;r<s;++r)this.each(a(i[r],t,e));return this}function Ou(n,t,e){var i=Mu(n),r=i.CustomEvent;typeof r=="function"?r=new r(t,e):(r=i.document.createEvent("Event"),e?(r.initEvent(t,e.bubbles,e.cancelable),r.detail=e.detail):r.initEvent(t,!1,!1)),n.dispatchEvent(r)}function Z0(n,t){return function(){return Ou(this,n,t)}}function H0(n,t){return function(){return Ou(this,n,t.apply(this,arguments))}}function q0(n,t){return this.each((typeof t=="function"?H0:Z0)(n,t))}function*J0(){for(var n=this._groups,t=0,e=n.length;t<e;++t)for(var i=n[t],r=0,s=i.length,o;r<s;++r)(o=i[r])&&(yield o)}var Fu=[null];function ee(n,t){this._groups=n,this._parents=t}function Or(){return new ee([[document.documentElement]],Fu)}function Q0(){return this}ee.prototype=Or.prototype={constructor:ee,select:Rp,selectAll:Mp,selectChild:kp,selectChildren:Np,filter:Gp,data:Bp,enter:$p,exit:Kp,join:Up,merge:Vp,selection:Q0,order:Zp,sort:Hp,call:Jp,nodes:Qp,node:t0,size:e0,empty:n0,each:i0,attr:c0,style:g0,property:y0,classed:E0,text:S0,html:A0,raise:P0,lower:O0,append:F0,insert:N0,remove:$0,clone:Y0,datum:W0,on:V0,dispatch:q0,[Symbol.iterator]:J0};function ty(n){return typeof n=="string"?new ee([[document.querySelector(n)]],[document.documentElement]):new ee([[n]],Fu)}function ey(n){let t;for(;t=n.sourceEvent;)n=t;return n}function ny(n,t){if(n=ey(n),t===void 0&&(t=n.currentTarget),t){var e=t.ownerSVGElement||t;if(e.createSVGPoint){var i=e.createSVGPoint();return i.x=n.clientX,i.y=n.clientY,i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[n.clientX-r.left-t.clientLeft,n.clientY-r.top-t.clientTop]}}return[n.pageX,n.pageY]}function ol(n,t,e){n.prototype=t.prototype=e,e.constructor=n}function Du(n,t){var e=Object.create(n.prototype);for(var i in t)e[i]=t[i];return e}function Fr(){}var Dr=.7,ho=1/Dr,Di="\\s*([+-]?\\d+)\\s*",Nr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ne="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",iy=/^#([0-9a-f]{3,8})$/,ry=new RegExp(`^rgb\\(${Di},${Di},${Di}\\)$`),sy=new RegExp(`^rgb\\(${Ne},${Ne},${Ne}\\)$`),oy=new RegExp(`^rgba\\(${Di},${Di},${Di},${Nr}\\)$`),ay=new RegExp(`^rgba\\(${Ne},${Ne},${Ne},${Nr}\\)$`),ly=new RegExp(`^hsl\\(${Nr},${Ne},${Ne}\\)$`),hy=new RegExp(`^hsla\\(${Nr},${Ne},${Ne},${Nr}\\)$`),Nu={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ol(Fr,Qn,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:Gu,formatHex:Gu,formatHex8:cy,formatHsl:uy,formatRgb:$u,toString:$u});function Gu(){return this.rgb().formatHex()}function cy(){return this.rgb().formatHex8()}function uy(){return Bu(this).formatHsl()}function $u(){return this.rgb().formatRgb()}function Qn(n){var t,e;return n=(n+"").trim().toLowerCase(),(t=iy.exec(n))?(e=t[1].length,t=parseInt(t[1],16),e===6?zu(t):e===3?new zt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):e===8?co(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):e===4?co(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=ry.exec(n))?new zt(t[1],t[2],t[3],1):(t=sy.exec(n))?new zt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=oy.exec(n))?co(t[1],t[2],t[3],t[4]):(t=ay.exec(n))?co(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=ly.exec(n))?Wu(t[1],t[2]/100,t[3]/100,1):(t=hy.exec(n))?Wu(t[1],t[2]/100,t[3]/100,t[4]):Nu.hasOwnProperty(n)?zu(Nu[n]):n==="transparent"?new zt(NaN,NaN,NaN,0):null}function zu(n){return new zt(n>>16&255,n>>8&255,n&255,1)}function co(n,t,e,i){return i<=0&&(n=t=e=NaN),new zt(n,t,e,i)}function fy(n){return n instanceof Fr||(n=Qn(n)),n?(n=n.rgb(),new zt(n.r,n.g,n.b,n.opacity)):new zt}function al(n,t,e,i){return arguments.length===1?fy(n):new zt(n,t,e,i??1)}function zt(n,t,e,i){this.r=+n,this.g=+t,this.b=+e,this.opacity=+i}ol(zt,al,Du(Fr,{brighter(n){return n=n==null?ho:Math.pow(ho,n),new zt(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?Dr:Math.pow(Dr,n),new zt(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new zt(ti(this.r),ti(this.g),ti(this.b),uo(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Xu,formatHex:Xu,formatHex8:dy,formatRgb:Yu,toString:Yu}));function Xu(){return`#${ei(this.r)}${ei(this.g)}${ei(this.b)}`}function dy(){return`#${ei(this.r)}${ei(this.g)}${ei(this.b)}${ei((isNaN(this.opacity)?1:this.opacity)*255)}`}function Yu(){const n=uo(this.opacity);return`${n===1?"rgb(":"rgba("}${ti(this.r)}, ${ti(this.g)}, ${ti(this.b)}${n===1?")":`, ${n})`}`}function uo(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function ti(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function ei(n){return n=ti(n),(n<16?"0":"")+n.toString(16)}function Wu(n,t,e,i){return i<=0?n=t=e=NaN:e<=0||e>=1?n=t=NaN:t<=0&&(n=NaN),new Ce(n,t,e,i)}function Bu(n){if(n instanceof Ce)return new Ce(n.h,n.s,n.l,n.opacity);if(n instanceof Fr||(n=Qn(n)),!n)return new Ce;if(n instanceof Ce)return n;n=n.rgb();var t=n.r/255,e=n.g/255,i=n.b/255,r=Math.min(t,e,i),s=Math.max(t,e,i),o=NaN,a=s-r,l=(s+r)/2;return a?(t===s?o=(e-i)/a+(e<i)*6:e===s?o=(i-t)/a+2:o=(t-e)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new Ce(o,a,l,n.opacity)}function gy(n,t,e,i){return arguments.length===1?Bu(n):new Ce(n,t,e,i??1)}function Ce(n,t,e,i){this.h=+n,this.s=+t,this.l=+e,this.opacity=+i}ol(Ce,gy,Du(Fr,{brighter(n){return n=n==null?ho:Math.pow(ho,n),new Ce(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?Dr:Math.pow(Dr,n),new Ce(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,t=isNaN(n)||isNaN(this.s)?0:this.s,e=this.l,i=e+(e<.5?e:1-e)*t,r=2*e-i;return new zt(ll(n>=240?n-240:n+120,r,i),ll(n,r,i),ll(n<120?n+240:n-120,r,i),this.opacity)},clamp(){return new Ce(ju(this.h),fo(this.s),fo(this.l),uo(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=uo(this.opacity);return`${n===1?"hsl(":"hsla("}${ju(this.h)}, ${fo(this.s)*100}%, ${fo(this.l)*100}%${n===1?")":`, ${n})`}`}}));function ju(n){return n=(n||0)%360,n<0?n+360:n}function fo(n){return Math.max(0,Math.min(1,n||0))}function ll(n,t,e){return(n<60?t+(e-t)*n/60:n<180?e:n<240?t+(e-t)*(240-n)/60:t)*255}const hl=n=>()=>n;function _y(n,t){return function(e){return n+e*t}}function my(n,t,e){return n=Math.pow(n,e),t=Math.pow(t,e)-n,e=1/e,function(i){return Math.pow(n+i*t,e)}}function py(n){return(n=+n)==1?Ku:function(t,e){return e-t?my(t,e,n):hl(isNaN(t)?e:t)}}function Ku(n,t){var e=t-n;return e?_y(n,e):hl(isNaN(n)?t:n)}const go=function n(t){var e=py(t);function i(r,s){var o=e((r=al(r)).r,(s=al(s)).r),a=e(r.g,s.g),l=e(r.b,s.b),h=Ku(r.opacity,s.opacity);return function(c){return r.r=o(c),r.g=a(c),r.b=l(c),r.opacity=h(c),r+""}}return i.gamma=n,i}(1);function yy(n,t){t||(t=[]);var e=n?Math.min(t.length,n.length):0,i=t.slice(),r;return function(s){for(r=0;r<e;++r)i[r]=n[r]*(1-s)+t[r]*s;return i}}function vy(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function wy(n,t){var e=t?t.length:0,i=n?Math.min(e,n.length):0,r=new Array(i),s=new Array(e),o;for(o=0;o<i;++o)r[o]=fl(n[o],t[o]);for(;o<e;++o)s[o]=t[o];return function(a){for(o=0;o<i;++o)s[o]=r[o](a);return s}}function xy(n,t){var e=new Date;return n=+n,t=+t,function(i){return e.setTime(n*(1-i)+t*i),e}}function be(n,t){return n=+n,t=+t,function(e){return n*(1-e)+t*e}}function Ey(n,t){var e={},i={},r;(n===null||typeof n!="object")&&(n={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in n?e[r]=fl(n[r],t[r]):i[r]=t[r];return function(s){for(r in e)i[r]=e[r](s);return i}}var cl=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ul=new RegExp(cl.source,"g");function Cy(n){return function(){return n}}function by(n){return function(t){return n(t)+""}}function Uu(n,t){var e=cl.lastIndex=ul.lastIndex=0,i,r,s,o=-1,a=[],l=[];for(n=n+"",t=t+"";(i=cl.exec(n))&&(r=ul.exec(t));)(s=r.index)>e&&(s=t.slice(e,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,l.push({i:o,x:be(i,r)})),e=ul.lastIndex;return e<t.length&&(s=t.slice(e),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?by(l[0].x):Cy(t):(t=l.length,function(h){for(var c=0,u;c<t;++c)a[(u=l[c]).i]=u.x(h);return a.join("")})}function fl(n,t){var e=typeof t,i;return t==null||e==="boolean"?hl(t):(e==="number"?be:e==="string"?(i=Qn(t))?(t=i,go):Uu:t instanceof Qn?go:t instanceof Date?xy:vy(t)?yy:Array.isArray(t)?wy:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Ey:be)(n,t)}function Ry(n,t){return n=+n,t=+t,function(e){return Math.round(n*(1-e)+t*e)}}var Vu=180/Math.PI,dl={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Zu(n,t,e,i,r,s){var o,a,l;return(o=Math.sqrt(n*n+t*t))&&(n/=o,t/=o),(l=n*e+t*i)&&(e-=n*l,i-=t*l),(a=Math.sqrt(e*e+i*i))&&(e/=a,i/=a,l/=a),n*i<t*e&&(n=-n,t=-t,l=-l,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(t,n)*Vu,skewX:Math.atan(l)*Vu,scaleX:o,scaleY:a}}var _o;function Sy(n){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(n+"");return t.isIdentity?dl:Zu(t.a,t.b,t.c,t.d,t.e,t.f)}function Ty(n){return n==null||(_o||(_o=document.createElementNS("http://www.w3.org/2000/svg","g")),_o.setAttribute("transform",n),!(n=_o.transform.baseVal.consolidate()))?dl:(n=n.matrix,Zu(n.a,n.b,n.c,n.d,n.e,n.f))}function Hu(n,t,e,i){function r(h){return h.length?h.pop()+" ":""}function s(h,c,u,f,d,g){if(h!==u||c!==f){var p=d.push("translate(",null,t,null,e);g.push({i:p-4,x:be(h,u)},{i:p-2,x:be(c,f)})}else(u||f)&&d.push("translate("+u+t+f+e)}function o(h,c,u,f){h!==c?(h-c>180?c+=360:c-h>180&&(h+=360),f.push({i:u.push(r(u)+"rotate(",null,i)-2,x:be(h,c)})):c&&u.push(r(u)+"rotate("+c+i)}function a(h,c,u,f){h!==c?f.push({i:u.push(r(u)+"skewX(",null,i)-2,x:be(h,c)}):c&&u.push(r(u)+"skewX("+c+i)}function l(h,c,u,f,d,g){if(h!==u||c!==f){var p=d.push(r(d)+"scale(",null,",",null,")");g.push({i:p-4,x:be(h,u)},{i:p-2,x:be(c,f)})}else(u!==1||f!==1)&&d.push(r(d)+"scale("+u+","+f+")")}return function(h,c){var u=[],f=[];return h=n(h),c=n(c),s(h.translateX,h.translateY,c.translateX,c.translateY,u,f),o(h.rotate,c.rotate,u,f),a(h.skewX,c.skewX,u,f),l(h.scaleX,h.scaleY,c.scaleX,c.scaleY,u,f),h=c=null,function(d){for(var g=-1,p=f.length,_;++g<p;)u[(_=f[g]).i]=_.x(d);return u.join("")}}}var Iy=Hu(Sy,"px, ","px)","deg)"),My=Hu(Ty,", ",")",")"),Ni=0,Gr=0,$r=0,qu=1e3,mo,zr,po=0,ni=0,yo=0,Xr=typeof performance=="object"&&performance.now?performance:Date,Ju=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(n){setTimeout(n,17)};function gl(){return ni||(Ju(Ay),ni=Xr.now()+yo)}function Ay(){ni=0}function vo(){this._call=this._time=this._next=null}vo.prototype=Qu.prototype={constructor:vo,restart:function(n,t,e){if(typeof n!="function")throw new TypeError("callback is not a function");e=(e==null?gl():+e)+(t==null?0:+t),!this._next&&zr!==this&&(zr?zr._next=this:mo=this,zr=this),this._call=n,this._time=e,_l()},stop:function(){this._call&&(this._call=null,this._time=1/0,_l())}};function Qu(n,t,e){var i=new vo;return i.restart(n,t,e),i}function Ly(){gl(),++Ni;for(var n=mo,t;n;)(t=ni-n._time)>=0&&n._call.call(void 0,t),n=n._next;--Ni}function tf(){ni=(po=Xr.now())+yo,Ni=Gr=0;try{Ly()}finally{Ni=0,ky(),ni=0}}function Py(){var n=Xr.now(),t=n-po;t>qu&&(yo-=t,po=n)}function ky(){for(var n,t=mo,e,i=1/0;t;)t._call?(i>t._time&&(i=t._time),n=t,t=t._next):(e=t._next,t._next=null,t=n?n._next=e:mo=e);zr=n,_l(i)}function _l(n){if(!Ni){Gr&&(Gr=clearTimeout(Gr));var t=n-ni;t>24?(n<1/0&&(Gr=setTimeout(tf,n-Xr.now()-yo)),$r&&($r=clearInterval($r))):($r||(po=Xr.now(),$r=setInterval(Py,qu)),Ni=1,Ju(tf))}}function ef(n,t,e){var i=new vo;return t=t==null?0:+t,i.restart(r=>{i.stop(),n(r+t)},t,e),i}var Oy=xu("start","end","cancel","interrupt"),Fy=[],nf=0,rf=1,ml=2,wo=3,sf=4,pl=5,xo=6;function Eo(n,t,e,i,r,s){var o=n.__transition;if(!o)n.__transition={};else if(e in o)return;Dy(n,e,{name:t,index:i,group:r,on:Oy,tween:Fy,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:nf})}function yl(n,t){var e=Re(n,t);if(e.state>nf)throw new Error("too late; already scheduled");return e}function Ge(n,t){var e=Re(n,t);if(e.state>wo)throw new Error("too late; already running");return e}function Re(n,t){var e=n.__transition;if(!e||!(e=e[t]))throw new Error("transition not found");return e}function Dy(n,t,e){var i=n.__transition,r;i[t]=e,e.timer=Qu(s,0,e.time);function s(h){e.state=rf,e.timer.restart(o,e.delay,e.time),e.delay<=h&&o(h-e.delay)}function o(h){var c,u,f,d;if(e.state!==rf)return l();for(c in i)if(d=i[c],d.name===e.name){if(d.state===wo)return ef(o);d.state===sf?(d.state=xo,d.timer.stop(),d.on.call("interrupt",n,n.__data__,d.index,d.group),delete i[c]):+c<t&&(d.state=xo,d.timer.stop(),d.on.call("cancel",n,n.__data__,d.index,d.group),delete i[c])}if(ef(function(){e.state===wo&&(e.state=sf,e.timer.restart(a,e.delay,e.time),a(h))}),e.state=ml,e.on.call("start",n,n.__data__,e.index,e.group),e.state===ml){for(e.state=wo,r=new Array(f=e.tween.length),c=0,u=-1;c<f;++c)(d=e.tween[c].value.call(n,n.__data__,e.index,e.group))&&(r[++u]=d);r.length=u+1}}function a(h){for(var c=h<e.duration?e.ease.call(null,h/e.duration):(e.timer.restart(l),e.state=pl,1),u=-1,f=r.length;++u<f;)r[u].call(n,c);e.state===pl&&(e.on.call("end",n,n.__data__,e.index,e.group),l())}function l(){e.state=xo,e.timer.stop(),delete i[t];for(var h in i)return;delete n.__transition}}function Ny(n,t){var e=n.__transition,i,r,s=!0,o;if(e){t=t==null?null:t+"";for(o in e){if((i=e[o]).name!==t){s=!1;continue}r=i.state>ml&&i.state<pl,i.state=xo,i.timer.stop(),i.on.call(r?"interrupt":"cancel",n,n.__data__,i.index,i.group),delete e[o]}s&&delete n.__transition}}function Gy(n){return this.each(function(){Ny(this,n)})}function $y(n,t){var e,i;return function(){var r=Ge(this,n),s=r.tween;if(s!==e){i=e=s;for(var o=0,a=i.length;o<a;++o)if(i[o].name===t){i=i.slice(),i.splice(o,1);break}}r.tween=i}}function zy(n,t,e){var i,r;if(typeof e!="function")throw new Error;return function(){var s=Ge(this,n),o=s.tween;if(o!==i){r=(i=o).slice();for(var a={name:t,value:e},l=0,h=r.length;l<h;++l)if(r[l].name===t){r[l]=a;break}l===h&&r.push(a)}s.tween=r}}function Xy(n,t){var e=this._id;if(n+="",arguments.length<2){for(var i=Re(this.node(),e).tween,r=0,s=i.length,o;r<s;++r)if((o=i[r]).name===n)return o.value;return null}return this.each((t==null?$y:zy)(e,n,t))}function vl(n,t,e){var i=n._id;return n.each(function(){var r=Ge(this,i);(r.value||(r.value={}))[t]=e.apply(this,arguments)}),function(r){return Re(r,i).value[t]}}function of(n,t){var e;return(typeof t=="number"?be:t instanceof Qn?go:(e=Qn(t))?(t=e,go):Uu)(n,t)}function Yy(n){return function(){this.removeAttribute(n)}}function Wy(n){return function(){this.removeAttributeNS(n.space,n.local)}}function By(n,t,e){var i,r=e+"",s;return function(){var o=this.getAttribute(n);return o===r?null:o===i?s:s=t(i=o,e)}}function jy(n,t,e){var i,r=e+"",s;return function(){var o=this.getAttributeNS(n.space,n.local);return o===r?null:o===i?s:s=t(i=o,e)}}function Ky(n,t,e){var i,r,s;return function(){var o,a=e(this),l;return a==null?void this.removeAttribute(n):(o=this.getAttribute(n),l=a+"",o===l?null:o===i&&l===r?s:(r=l,s=t(i=o,a)))}}function Uy(n,t,e){var i,r,s;return function(){var o,a=e(this),l;return a==null?void this.removeAttributeNS(n.space,n.local):(o=this.getAttributeNS(n.space,n.local),l=a+"",o===l?null:o===i&&l===r?s:(r=l,s=t(i=o,a)))}}function Vy(n,t){var e=ao(n),i=e==="transform"?My:of;return this.attrTween(n,typeof t=="function"?(e.local?Uy:Ky)(e,i,vl(this,"attr."+n,t)):t==null?(e.local?Wy:Yy)(e):(e.local?jy:By)(e,i,t))}function Zy(n,t){return function(e){this.setAttribute(n,t.call(this,e))}}function Hy(n,t){return function(e){this.setAttributeNS(n.space,n.local,t.call(this,e))}}function qy(n,t){var e,i;function r(){var s=t.apply(this,arguments);return s!==i&&(e=(i=s)&&Hy(n,s)),e}return r._value=t,r}function Jy(n,t){var e,i;function r(){var s=t.apply(this,arguments);return s!==i&&(e=(i=s)&&Zy(n,s)),e}return r._value=t,r}function Qy(n,t){var e="attr."+n;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;var i=ao(n);return this.tween(e,(i.local?qy:Jy)(i,t))}function tv(n,t){return function(){yl(this,n).delay=+t.apply(this,arguments)}}function ev(n,t){return t=+t,function(){yl(this,n).delay=t}}function nv(n){var t=this._id;return arguments.length?this.each((typeof n=="function"?tv:ev)(t,n)):Re(this.node(),t).delay}function iv(n,t){return function(){Ge(this,n).duration=+t.apply(this,arguments)}}function rv(n,t){return t=+t,function(){Ge(this,n).duration=t}}function sv(n){var t=this._id;return arguments.length?this.each((typeof n=="function"?iv:rv)(t,n)):Re(this.node(),t).duration}function ov(n,t){if(typeof t!="function")throw new Error;return function(){Ge(this,n).ease=t}}function av(n){var t=this._id;return arguments.length?this.each(ov(t,n)):Re(this.node(),t).ease}function lv(n,t){return function(){var e=t.apply(this,arguments);if(typeof e!="function")throw new Error;Ge(this,n).ease=e}}function hv(n){if(typeof n!="function")throw new Error;return this.each(lv(this._id,n))}function cv(n){typeof n!="function"&&(n=Su(n));for(var t=this._groups,e=t.length,i=new Array(e),r=0;r<e;++r)for(var s=t[r],o=s.length,a=i[r]=[],l,h=0;h<o;++h)(l=s[h])&&n.call(l,l.__data__,h,s)&&a.push(l);return new tn(i,this._parents,this._name,this._id)}function uv(n){if(n._id!==this._id)throw new Error;for(var t=this._groups,e=n._groups,i=t.length,r=e.length,s=Math.min(i,r),o=new Array(i),a=0;a<s;++a)for(var l=t[a],h=e[a],c=l.length,u=o[a]=new Array(c),f,d=0;d<c;++d)(f=l[d]||h[d])&&(u[d]=f);for(;a<i;++a)o[a]=t[a];return new tn(o,this._parents,this._name,this._id)}function fv(n){return(n+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||t==="start"})}function dv(n,t,e){var i,r,s=fv(t)?yl:Ge;return function(){var o=s(this,n),a=o.on;a!==i&&(r=(i=a).copy()).on(t,e),o.on=r}}function gv(n,t){var e=this._id;return arguments.length<2?Re(this.node(),e).on.on(n):this.each(dv(e,n,t))}function _v(n){return function(){var t=this.parentNode;for(var e in this.__transition)if(+e!==n)return;t&&t.removeChild(this)}}function mv(){return this.on("end.remove",_v(this._id))}function pv(n){var t=this._name,e=this._id;typeof n!="function"&&(n=rl(n));for(var i=this._groups,r=i.length,s=new Array(r),o=0;o<r;++o)for(var a=i[o],l=a.length,h=s[o]=new Array(l),c,u,f=0;f<l;++f)(c=a[f])&&(u=n.call(c,c.__data__,f,a))&&("__data__"in c&&(u.__data__=c.__data__),h[f]=u,Eo(h[f],t,e,f,h,Re(c,e)));return new tn(s,this._parents,t,e)}function yv(n){var t=this._name,e=this._id;typeof n!="function"&&(n=Ru(n));for(var i=this._groups,r=i.length,s=[],o=[],a=0;a<r;++a)for(var l=i[a],h=l.length,c,u=0;u<h;++u)if(c=l[u]){for(var f=n.call(c,c.__data__,u,l),d,g=Re(c,e),p=0,_=f.length;p<_;++p)(d=f[p])&&Eo(d,t,e,p,f,g);s.push(f),o.push(c)}return new tn(s,o,t,e)}var vv=Or.prototype.constructor;function wv(){return new vv(this._groups,this._parents)}function xv(n,t){var e,i,r;return function(){var s=Fi(this,n),o=(this.style.removeProperty(n),Fi(this,n));return s===o?null:s===e&&o===i?r:r=t(e=s,i=o)}}function af(n){return function(){this.style.removeProperty(n)}}function Ev(n,t,e){var i,r=e+"",s;return function(){var o=Fi(this,n);return o===r?null:o===i?s:s=t(i=o,e)}}function Cv(n,t,e){var i,r,s;return function(){var o=Fi(this,n),a=e(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(n),Fi(this,n))),o===l?null:o===i&&l===r?s:(r=l,s=t(i=o,a))}}function bv(n,t){var e,i,r,s="style."+t,o="end."+s,a;return function(){var l=Ge(this,n),h=l.on,c=l.value[s]==null?a||(a=af(t)):void 0;(h!==e||r!==c)&&(i=(e=h).copy()).on(o,r=c),l.on=i}}function Rv(n,t,e){var i=(n+="")=="transform"?Iy:of;return t==null?this.styleTween(n,xv(n,i)).on("end.style."+n,af(n)):typeof t=="function"?this.styleTween(n,Cv(n,i,vl(this,"style."+n,t))).each(bv(this._id,n)):this.styleTween(n,Ev(n,i,t),e).on("end.style."+n,null)}function Sv(n,t,e){return function(i){this.style.setProperty(n,t.call(this,i),e)}}function Tv(n,t,e){var i,r;function s(){var o=t.apply(this,arguments);return o!==r&&(i=(r=o)&&Sv(n,o,e)),i}return s._value=t,s}function Iv(n,t,e){var i="style."+(n+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(t==null)return this.tween(i,null);if(typeof t!="function")throw new Error;return this.tween(i,Tv(n,t,e??""))}function Mv(n){return function(){this.textContent=n}}function Av(n){return function(){var t=n(this);this.textContent=t??""}}function Lv(n){return this.tween("text",typeof n=="function"?Av(vl(this,"text",n)):Mv(n==null?"":n+""))}function Pv(n){return function(t){this.textContent=n.call(this,t)}}function kv(n){var t,e;function i(){var r=n.apply(this,arguments);return r!==e&&(t=(e=r)&&Pv(r)),t}return i._value=n,i}function Ov(n){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(n==null)return this.tween(t,null);if(typeof n!="function")throw new Error;return this.tween(t,kv(n))}function Fv(){for(var n=this._name,t=this._id,e=lf(),i=this._groups,r=i.length,s=0;s<r;++s)for(var o=i[s],a=o.length,l,h=0;h<a;++h)if(l=o[h]){var c=Re(l,t);Eo(l,n,e,h,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new tn(i,this._parents,n,e)}function Dv(){var n,t,e=this,i=e._id,r=e.size();return new Promise(function(s,o){var a={value:o},l={value:function(){--r===0&&s()}};e.each(function(){var h=Ge(this,i),c=h.on;c!==n&&(t=(n=c).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),h.on=t}),r===0&&s()})}var Nv=0;function tn(n,t,e,i){this._groups=n,this._parents=t,this._name=e,this._id=i}function lf(){return++Nv}var en=Or.prototype;tn.prototype={constructor:tn,select:pv,selectAll:yv,selectChild:en.selectChild,selectChildren:en.selectChildren,filter:cv,merge:uv,selection:wv,transition:Fv,call:en.call,nodes:en.nodes,node:en.node,size:en.size,empty:en.empty,each:en.each,on:gv,attr:Vy,attrTween:Qy,style:Rv,styleTween:Iv,text:Lv,textTween:Ov,remove:mv,tween:Xy,delay:nv,duration:sv,ease:av,easeVarying:hv,end:Dv,[Symbol.iterator]:en[Symbol.iterator]};function Gv(n){return((n*=2)<=1?n*n*n:(n-=2)*n*n+2)/2}var $v={time:null,delay:0,duration:250,ease:Gv};function zv(n,t){for(var e;!(e=n.__transition)||!(e=e[t]);)if(!(n=n.parentNode))throw new Error(`transition ${t} not found`);return e}function Xv(n){var t,e;n instanceof tn?(t=n._id,n=n._name):(t=lf(),(e=$v).time=gl(),n=n==null?null:n+"");for(var i=this._groups,r=i.length,s=0;s<r;++s)for(var o=i[s],a=o.length,l,h=0;h<a;++h)(l=o[h])&&Eo(l,n,t,h,o,e||zv(l,t));return new tn(i,this._parents,n,t)}Or.prototype.interrupt=Gy,Or.prototype.transition=Xv;const wl=Math.PI,xl=2*wl,ii=1e-6,Yv=xl-ii;function hf(n){this._+=n[0];for(let t=1,e=n.length;t<e;++t)this._+=arguments[t]+n[t]}function Wv(n){let t=Math.floor(n);if(!(t>=0))throw new Error(`invalid digits: ${n}`);if(t>15)return hf;const e=10**t;return function(i){this._+=i[0];for(let r=1,s=i.length;r<s;++r)this._+=Math.round(arguments[r]*e)/e+i[r]}}class Bv{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?hf:Wv(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,i,r){this._append`Q${+t},${+e},${this._x1=+i},${this._y1=+r}`}bezierCurveTo(t,e,i,r,s,o){this._append`C${+t},${+e},${+i},${+r},${this._x1=+s},${this._y1=+o}`}arcTo(t,e,i,r,s){if(t=+t,e=+e,i=+i,r=+r,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,a=this._y1,l=i-t,h=r-e,c=o-t,u=a-e,f=c*c+u*u;if(this._x1===null)this._append`M${this._x1=t},${this._y1=e}`;else if(f>ii)if(!(Math.abs(u*l-h*c)>ii)||!s)this._append`L${this._x1=t},${this._y1=e}`;else{let d=i-o,g=r-a,p=l*l+h*h,_=d*d+g*g,m=Math.sqrt(p),y=Math.sqrt(f),x=s*Math.tan((wl-Math.acos((p+f-_)/(2*m*y)))/2),v=x/y,w=x/m;Math.abs(v-1)>ii&&this._append`L${t+v*c},${e+v*u}`,this._append`A${s},${s},0,0,${+(u*d>c*g)},${this._x1=t+w*l},${this._y1=e+w*h}`}}arc(t,e,i,r,s,o){if(t=+t,e=+e,i=+i,o=!!o,i<0)throw new Error(`negative radius: ${i}`);let a=i*Math.cos(r),l=i*Math.sin(r),h=t+a,c=e+l,u=1^o,f=o?r-s:s-r;this._x1===null?this._append`M${h},${c}`:(Math.abs(this._x1-h)>ii||Math.abs(this._y1-c)>ii)&&this._append`L${h},${c}`,i&&(f<0&&(f=f%xl+xl),f>Yv?this._append`A${i},${i},0,1,${u},${t-a},${e-l}A${i},${i},0,1,${u},${this._x1=h},${this._y1=c}`:f>ii&&this._append`A${i},${i},0,${+(f>=wl)},${u},${this._x1=t+i*Math.cos(s)},${this._y1=e+i*Math.sin(s)}`)}rect(t,e,i,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${i=+i}v${+r}h${-i}Z`}toString(){return this._}}function jv(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function Co(n,t){if((e=(n=t?n.toExponential(t-1):n.toExponential()).indexOf("e"))<0)return null;var e,i=n.slice(0,e);return[i.length>1?i[0]+i.slice(2):i,+n.slice(e+1)]}function Gi(n){return n=Co(Math.abs(n)),n?n[1]:NaN}function Kv(n,t){return function(e,i){for(var r=e.length,s=[],o=0,a=n[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),s.push(e.substring(r-=a,r+a)),!((l+=a+1)>i));)a=n[o=(o+1)%n.length];return s.reverse().join(t)}}function Uv(n){return function(t){return t.replace(/[0-9]/g,function(e){return n[+e]})}}var Vv=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function bo(n){if(!(t=Vv.exec(n)))throw new Error("invalid format: "+n);var t;return new El({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}bo.prototype=El.prototype;function El(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}El.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Zv(n){t:for(var t=n.length,e=1,i=-1,r;e<t;++e)switch(n[e]){case".":i=r=e;break;case"0":i===0&&(i=e),r=e;break;default:if(!+n[e])break t;i>0&&(i=0);break}return i>0?n.slice(0,i)+n.slice(r+1):n}var cf;function Hv(n,t){var e=Co(n,t);if(!e)return n+"";var i=e[0],r=e[1],s=r-(cf=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+Co(n,Math.max(0,t+s-1))[0]}function uf(n,t){var e=Co(n,t);if(!e)return n+"";var i=e[0],r=e[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const ff={"%":(n,t)=>(n*100).toFixed(t),b:n=>Math.round(n).toString(2),c:n=>n+"",d:jv,e:(n,t)=>n.toExponential(t),f:(n,t)=>n.toFixed(t),g:(n,t)=>n.toPrecision(t),o:n=>Math.round(n).toString(8),p:(n,t)=>uf(n*100,t),r:uf,s:Hv,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function df(n){return n}var gf=Array.prototype.map,_f=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function qv(n){var t=n.grouping===void 0||n.thousands===void 0?df:Kv(gf.call(n.grouping,Number),n.thousands+""),e=n.currency===void 0?"":n.currency[0]+"",i=n.currency===void 0?"":n.currency[1]+"",r=n.decimal===void 0?".":n.decimal+"",s=n.numerals===void 0?df:Uv(gf.call(n.numerals,String)),o=n.percent===void 0?"%":n.percent+"",a=n.minus===void 0?"−":n.minus+"",l=n.nan===void 0?"NaN":n.nan+"";function h(u){u=bo(u);var f=u.fill,d=u.align,g=u.sign,p=u.symbol,_=u.zero,m=u.width,y=u.comma,x=u.precision,v=u.trim,w=u.type;w==="n"?(y=!0,w="g"):ff[w]||(x===void 0&&(x=12),v=!0,w="g"),(_||f==="0"&&d==="=")&&(_=!0,f="0",d="=");var E=p==="$"?e:p==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",C=p==="$"?i:/[%p]/.test(w)?o:"",R=ff[w],S=/[defgprs%]/.test(w);x=x===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function I(T){var L=E,A=C,P,W,O;if(w==="c")A=R(T)+A,T="";else{T=+T;var N=T<0||1/T<0;if(T=isNaN(T)?l:R(Math.abs(T),x),v&&(T=Zv(T)),N&&+T==0&&g!=="+"&&(N=!1),L=(N?g==="("?g:a:g==="-"||g==="("?"":g)+L,A=(w==="s"?_f[8+cf/3]:"")+A+(N&&g==="("?")":""),S){for(P=-1,W=T.length;++P<W;)if(O=T.charCodeAt(P),48>O||O>57){A=(O===46?r+T.slice(P+1):T.slice(P))+A,T=T.slice(0,P);break}}}y&&!_&&(T=t(T,1/0));var k=L.length+T.length+A.length,G=k<m?new Array(m-k+1).join(f):"";switch(y&&_&&(T=t(G+T,G.length?m-A.length:1/0),G=""),d){case"<":T=L+T+A+G;break;case"=":T=L+G+T+A;break;case"^":T=G.slice(0,k=G.length>>1)+L+T+A+G.slice(k);break;default:T=G+L+T+A;break}return s(T)}return I.toString=function(){return u+""},I}function c(u,f){var d=h((u=bo(u),u.type="f",u)),g=Math.max(-8,Math.min(8,Math.floor(Gi(f)/3)))*3,p=Math.pow(10,-g),_=_f[8+g/3];return function(m){return d(p*m)+_}}return{format:h,formatPrefix:c}}var Ro,mf,pf;Jv({thousands:",",grouping:[3],currency:["$",""]});function Jv(n){return Ro=qv(n),mf=Ro.format,pf=Ro.formatPrefix,Ro}function Qv(n){return Math.max(0,-Gi(Math.abs(n)))}function tw(n,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Gi(t)/3)))*3-Gi(Math.abs(n)))}function ew(n,t){return n=Math.abs(n),t=Math.abs(t)-n,Math.max(0,Gi(t)-Gi(n))+1}function nw(n,t){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(t).domain(n);break}return this}function iw(n){return function(){return n}}function rw(n){return+n}var yf=[0,1];function $i(n){return n}function Cl(n,t){return(t-=n=+n)?function(e){return(e-n)/t}:iw(isNaN(t)?NaN:.5)}function sw(n,t){var e;return n>t&&(e=n,n=t,t=e),function(i){return Math.max(n,Math.min(t,i))}}function ow(n,t,e){var i=n[0],r=n[1],s=t[0],o=t[1];return r<i?(i=Cl(r,i),s=e(o,s)):(i=Cl(i,r),s=e(s,o)),function(a){return s(i(a))}}function aw(n,t,e){var i=Math.min(n.length,t.length)-1,r=new Array(i),s=new Array(i),o=-1;for(n[i]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++o<i;)r[o]=Cl(n[o],n[o+1]),s[o]=e(t[o],t[o+1]);return function(a){var l=sp(n,a,1,i)-1;return s[l](r[l](a))}}function lw(n,t){return t.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function hw(){var n=yf,t=yf,e=fl,i,r,s,o=$i,a,l,h;function c(){var f=Math.min(n.length,t.length);return o!==$i&&(o=sw(n[0],n[f-1])),a=f>2?aw:ow,l=h=null,u}function u(f){return f==null||isNaN(f=+f)?s:(l||(l=a(n.map(i),t,e)))(i(o(f)))}return u.invert=function(f){return o(r((h||(h=a(t,n.map(i),be)))(f)))},u.domain=function(f){return arguments.length?(n=Array.from(f,rw),c()):n.slice()},u.range=function(f){return arguments.length?(t=Array.from(f),c()):t.slice()},u.rangeRound=function(f){return t=Array.from(f),e=Ry,c()},u.clamp=function(f){return arguments.length?(o=f?!0:$i,c()):o!==$i},u.interpolate=function(f){return arguments.length?(e=f,c()):e},u.unknown=function(f){return arguments.length?(s=f,u):s},function(f,d){return i=f,r=d,c()}}function cw(){return hw()($i,$i)}function uw(n,t,e,i){var r=cp(n,t,e),s;switch(i=bo(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(n),Math.abs(t));return i.precision==null&&!isNaN(s=tw(r,o))&&(i.precision=s),pf(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=ew(r,Math.max(Math.abs(n),Math.abs(t))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=Qv(r))&&(i.precision=s-(i.type==="%")*2);break}}return mf(i)}function fw(n){var t=n.domain;return n.ticks=function(e){var i=t();return hp(i[0],i[i.length-1],e??10)},n.tickFormat=function(e,i){var r=t();return uw(r[0],r[r.length-1],e??10,i)},n.nice=function(e){e==null&&(e=10);var i=t(),r=0,s=i.length-1,o=i[r],a=i[s],l,h,c=10;for(a<o&&(h=o,o=a,a=h,h=r,r=s,s=h);c-- >0;){if(h=Qa(o,a,e),h===l)return i[r]=o,i[s]=a,t(i);if(h>0)o=Math.floor(o/h)*h,a=Math.ceil(a/h)*h;else if(h<0)o=Math.ceil(o*h)/h,a=Math.floor(a*h)/h;else break;l=h}return n},n}function bl(){var n=cw();return n.copy=function(){return lw(n,bl())},nw.apply(n,arguments),fw(n)}function zi(n){return function(){return n}}function dw(n){let t=3;return n.digits=function(e){if(!arguments.length)return t;if(e==null)t=null;else{const i=Math.floor(e);if(!(i>=0))throw new RangeError(`invalid digits: ${e}`);t=i}return n},()=>new Bv(t)}function gw(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function vf(n){this._context=n}vf.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(n,t){switch(n=+n,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(n,t):this._context.moveTo(n,t);break;case 1:this._point=2;default:this._context.lineTo(n,t);break}}};function _w(n){return new vf(n)}function mw(n){return n[0]}function pw(n){return n[1]}function yw(n,t){var e=zi(!0),i=null,r=_w,s=null,o=dw(a);n=typeof n=="function"?n:n===void 0?mw:zi(n),t=typeof t=="function"?t:t===void 0?pw:zi(t);function a(l){var h,c=(l=gw(l)).length,u,f=!1,d;for(i==null&&(s=r(d=o())),h=0;h<=c;++h)!(h<c&&e(u=l[h],h,l))===f&&((f=!f)?s.lineStart():s.lineEnd()),f&&s.point(+n(u,h,l),+t(u,h,l));if(d)return s=null,d+""||null}return a.x=function(l){return arguments.length?(n=typeof l=="function"?l:zi(+l),a):n},a.y=function(l){return arguments.length?(t=typeof l=="function"?l:zi(+l),a):t},a.defined=function(l){return arguments.length?(e=typeof l=="function"?l:zi(!!l),a):e},a.curve=function(l){return arguments.length?(r=l,i!=null&&(s=r(i)),a):r},a.context=function(l){return arguments.length?(l==null?i=s=null:s=r(i=l),a):i},a}function wf(n,t,e){n._context.bezierCurveTo((2*n._x0+n._x1)/3,(2*n._y0+n._y1)/3,(n._x0+2*n._x1)/3,(n._y0+2*n._y1)/3,(n._x0+4*n._x1+t)/6,(n._y0+4*n._y1+e)/6)}function xf(n){this._context=n}xf.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:wf(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(n,t){switch(n=+n,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(n,t):this._context.moveTo(n,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:wf(this,n,t);break}this._x0=this._x1,this._x1=n,this._y0=this._y1,this._y1=t}};function vw(n){return new xf(n)}function Yr(n,t,e){this.k=n,this.x=t,this.y=e}Yr.prototype={constructor:Yr,scale:function(n){return n===1?this:new Yr(this.k*n,this.x,this.y)},translate:function(n,t){return n===0&t===0?this:new Yr(this.k,this.x+this.k*n,this.y+this.k*t)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},Yr.prototype;var ww=Pr('<svg class="h-full w-full"></svg>');function Ef(n,t){bn(t,!1);let e=we(null),i=te(t,"data",12,null);const r={"#fafafa":"#0c4a6e","#d6d3d1":"#0f766e","#a8a29e":"#f59e0b","#57534e":"#ef4444"};function s(){const a=X(e).clientWidth,l=X(e).clientHeight,h=8,c=8,u=25,f=44,d=bl().domain(yu(i(),E=>E.distance)).rangeRound([f,a-c]),g=bl().domain(yu(i(),E=>E.elevation)).rangeRound([l-u,h]),p=yw().curve(vw).x(E=>d(E.distance)).y(E=>g(E.elevation)),_=ty(X(e)).attr("width",a).attr("height",l).attr("viewBox",[0,0,a,l]).attr("style","max-width: 100%; height: auto;").on("pointerenter pointermove",x).on("pointerleave",v).on("touchstart",E=>E.preventDefault());_.append("g").attr("transform",`translate(0,${l-u})`).call(pp(d).ticks(a/80).tickSizeOuter(0)).call(E=>E.select(".domain").remove()),_.append("g").attr("transform",`translate(${f},0)`).call(yp(g).ticks(Math.ceil(l/40))).call(E=>E.select(".domain").remove()).call(E=>E.select(".tick:last-of-type text").append("tspan").text(i().y)),_.append("linearGradient").attr("id","TODO-unique-id").attr("gradientUnits","userSpaceOnUse").attr("x1",0).attr("x2",a).selectAll("stop").data(i()).join("stop").attr("offset",E=>d(E.distance)/a).attr("stop-color",E=>r[E.styleColor]),_.append("path").datum(i()).attr("fill","transparent").attr("stroke","url(#TODO-unique-id)").attr("stroke-width",4).attr("stroke-linejoin","round").attr("stroke-linecap","round").attr("d",p);const m=_.append("g"),y=Ja(E=>E.distance).center;function x(E){const C=y(i(),d.invert(ny(E)[0]));m.style("display",null),m.attr("transform",`translate(${d(i()[C].distance)},${g(i()[C].elevation)})`);const R=m.selectAll("path").data([,]).join("path").attr("fill","#fafaf9").attr("stroke","#292524"),S=m.selectAll("text").data([,]).join("text").call(I=>I.selectAll("tspan").data([`${Math.round(i()[C].distance*10)/10} km`,`Elevation, ${Math.round(i()[C].elevation)} m`]).join("tspan").attr("x",0).attr("y",(T,L)=>`${L*1.1}em`).attr("font-weight",(T,L)=>L?null:"bold").text(T=>T));w(S,R)}function v(){m.style("display","none")}function w(E,C){const{x:R,y:S,width:I,height:T}=E.node().getBBox();E.attr("transform",`translate(${-I/2},${15-S})`),C.attr("d",`M${-I/2-10},5H-5l5,-5l5,5H${I/2+10}v${T+20}h-${I+20}z`)}}em(()=>(ja(i()),X(e)),()=>{i()&&X(e)&&s()}),nm(),qn();var o=ww();return eo(o,a=>pt(e,a),()=>X(e)),Ct(n,o),Rn({get data(){return i()},set data(a){i(a),kt()}})}Jn(Ef,{data:{}},[],[],!0);var xw=Ee('<div class="flex w-full h-full items-center justify-center text-neutral-600 uppercase tracking-tight font-mono font-bold text-xs shadow-inner"> <span class="text-red-800 cursor-help p-1 -mb-px">Error</span> </div>'),Ew=Ee('<div class="flex w-full h-full items-center justify-center text-neutral-400 uppercase tracking-tight font-mono text-xs ring-inset ring-1 ring-neutral-100"><span>Loading</span></div>'),Cw=Ee("<div><!></div>");function Cf(n,t){bn(t,!1);let e=te(t,"containerClass",12),i=te(t,"src",12),r=(async()=>({data:await fetch(i()).then(async a=>await a.json())}))();qn();var s=Cw(),o=St(s);return Lm(o,()=>r,a=>{var l=Ew();Ct(a,l)},(a,l)=>{Ef(a,qm(()=>X(l)))},(a,l)=>{var h=xw(),c=St(h,!0);c.nodeValue="{";var u=Oe(c),f=Oe(u,1,!0);f.nodeValue="}",Et(h),Li(()=>Qs(u,"title",(ja(X(l)),De(()=>`Error: ${X(l).message}`)))),Ct(a,h)}),Et(s),Li(()=>Js(s,1,$m(e()))),Ct(n,s),Rn({get containerClass(){return e()},set containerClass(a){e(a),kt()},get src(){return i()},set src(a){i(a),kt()}})}customElements.define("dpb587-elevation-chart",Jn(Cf,{src:{attribute:"src",type:"String"},containerClass:{attribute:"container-class",type:"String"}},[],[],!1));const Xt={ADD:"add",REMOVE:"remove"},Xi={PROPERTYCHANGE:"propertychange"},Y={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class So{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function bw(n,t,e){let i,r;e=e||nn;let s=0,o=n.length,a=!1;for(;s<o;)i=s+(o-s>>1),r=+e(n[i],t),r<0?s=i+1:(o=i,a=!r);return a?s:~s}function nn(n,t){return n>t?1:n<t?-1:0}function Rw(n,t){return n<t?1:n>t?-1:0}function Rl(n,t,e){if(n[0]<=t)return 0;const i=n.length;if(t<=n[i-1])return i-1;if(typeof e=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===t)return r;if(s<t)return e(t,n[r-1],s)>0?r-1:r}return i-1}if(e>0){for(let r=1;r<i;++r)if(n[r]<t)return r-1;return i-1}if(e<0){for(let r=1;r<i;++r)if(n[r]<=t)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==t)return r;if(n[r]<t)return n[r-1]-t<t-n[r]?r-1:r}return i-1}function Sw(n,t,e){for(;t<e;){const i=n[t];n[t]=n[e],n[e]=i,++t,--e}}function $e(n,t){const e=Array.isArray(t)?t:[t],i=e.length;for(let r=0;r<i;r++)n[n.length]=e[r]}function An(n,t){const e=n.length;if(e!==t.length)return!1;for(let i=0;i<e;i++)if(n[i]!==t[i])return!1;return!0}function Tw(n,t,e){const i=t||nn;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function Wr(){return!0}function To(){return!1}function Br(){}function bf(n){let t,e,i;return function(){const r=Array.prototype.slice.call(arguments);return(!e||this!==i||!An(r,e))&&(i=this,e=r,t=n.apply(this,arguments)),t}}function Iw(n){function t(){let e;try{e=n()}catch(i){return Promise.reject(i)}return e instanceof Promise?e:Promise.resolve(e)}return t()}function jr(n){for(const t in n)delete n[t]}function ri(n){let t;for(t in n)return!1;return!t}class rn{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class Io extends So{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const i=this.listeners_||(this.listeners_={}),r=i[t]||(i[t]=[]);r.includes(e)||r.push(e)}dispatchEvent(t){const e=typeof t=="string",i=e?t:t.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=e?new rn(t):t;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,a[i]=0),++o[i];let l;for(let h=0,c=r.length;h<c;++h)if("handleEvent"in r[h]?l=r[h].handleEvent(s):l=r[h].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--o[i]===0){let h=a[i];for(delete a[i];h--;)this.removeEventListener(i,Br);delete o[i]}return l}disposeInternal(){this.listeners_&&jr(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){if(!this.listeners_)return;const i=this.listeners_[t];if(!i)return;const r=i.indexOf(e);r!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[r]=Br,++this.pendingRemovals_[t]):(i.splice(r,1),i.length===0&&delete this.listeners_[t]))}}function V(n,t,e,i,r){if(r){const o=e;e=function(a){return n.removeEventListener(t,e),o.call(i??this,a)}}else i&&i!==n&&(e=e.bind(i));const s={target:n,type:t,listener:e};return n.addEventListener(t,e),s}function Mo(n,t,e,i){return V(n,t,e,i,!0)}function at(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),jr(n))}class Kr extends Io{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Y.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const i=t.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=V(this,t[s],e);return r}return V(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){const r=t.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=Mo(this,t[s],e)}else i=Mo(this,t,e);return e.ol_key=i,i}unInternal(t,e){const i=e.ol_key;if(i)Mw(i);else if(Array.isArray(t))for(let r=0,s=t.length;r<s;++r)this.removeEventListener(t[r],e);else this.removeEventListener(t,e)}}Kr.prototype.on,Kr.prototype.once,Kr.prototype.un;function Mw(n){if(Array.isArray(n))for(let t=0,e=n.length;t<e;++t)at(n[t]);else at(n)}function $(){throw new Error("Unimplemented abstract method.")}let Aw=0;function Z(n){return n.ol_uid||(n.ol_uid=String(++Aw))}class Rf extends rn{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}}class Se extends Kr{constructor(t){super(),this.on,this.once,this.un,Z(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new Rf(i,t,e)),i=Xi.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new Rf(i,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){const r=this.values_||(this.values_={});if(i)r[t]=e;else{const s=r[t];r[t]=e,s!==e&&this.notify(t,s)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],ri(this.values_)&&(this.values_=null),e||this.notify(t,i)}}}const Sf={LENGTH:"length"};class Ao extends rn{constructor(t,e,i){super(t),this.element=e,this.index=i}}class ze extends Se{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let i=0,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let i=0,r=e.length;i<r;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(Sf.LENGTH)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Ao(Xt.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let i=0,r=e.length;i<r;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Ao(Xt.REMOVE,e,t)),e}setAt(t,e){const i=this.getLength();if(t>=i){this.insertAt(t,e);return}if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const r=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Ao(Xt.REMOVE,r,t)),this.dispatchEvent(new Ao(Xt.ADD,e,t))}updateLength_(){this.set(Sf.LENGTH,this.array_.length)}assertUnique_(t,e){for(let i=0,r=this.array_.length;i<r;++i)if(this.array_[i]===t&&i!==e)throw new Error("Duplicate item added to a unique collection")}}class Yi extends rn{constructor(t,e,i){super(t),this.map=e,this.frameState=i!==void 0?i:null}}class Ln extends Yi{constructor(t,e,i,r,s,o){super(t,e,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const ut={SINGLECLICK:"singleclick",CLICK:Y.CLICK,DBLCLICK:Y.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},si=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"";si.includes("safari")&&!si.includes("chrom")&&(si.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(si));const Lw=si.includes("webkit")&&!si.includes("edge"),Tf=si.includes("macintosh"),Pw=typeof devicePixelRatio<"u"?devicePixelRatio:1,Sl=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,If=typeof Image<"u"&&Image.prototype.decode,Mf=function(){let n=!1;try{const t=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return n}(),Tl={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class kw extends Io{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=e===void 0?1:e,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=V(i,Tl.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=V(i,Tl.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Y.TOUCHMOVE,this.boundHandleTouchMove_,Mf?{passive:!1}:!1)}emulateClick_(t){let e=new Ln(ut.CLICK,this.map_,t);this.dispatchEvent(e),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new Ln(ut.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new Ln(ut.SINGLECLICK,this.map_,t);this.dispatchEvent(i)},250)}updateActivePointers_(t){const e=t,i=e.pointerId;if(e.type==ut.POINTERUP||e.type==ut.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==e.target){delete this.trackedTouches_[r];break}}else(e.type==ut.POINTERDOWN||e.type==ut.POINTERMOVE)&&(this.trackedTouches_[i]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new Ln(ut.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(at),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return t.button===0}handlePointerDown_(t){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(t);const e=new Ln(ut.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(V(i,ut.POINTERMOVE,this.handlePointerMove_,this),V(i,ut.POINTERUP,this.handlePointerUp_,this),V(this.element_,ut.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(V(this.element_.getRootNode(),ut.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new Ln(ut.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new Ln(ut.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;(!e||e.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(at(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Y.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(at(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(at),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const sn={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Tt={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},D={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Q(n,t){if(!n)throw new Error(t)}const Lo=1/0;class Ow{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,jr(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,i=t[0];t.length==1?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(t){Q(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=Lo?(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(t){return t*2+1}getRightChildIndex_(t){return t*2+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return this.elements_.length===0}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,i=this.priorities_,r=e.length,s=e[t],o=i[t],a=t;for(;t<r>>1;){const l=this.getLeftChildIndex_(t),h=this.getRightChildIndex_(t),c=h<r&&i[h]<i[l]?h:l;e[t]=e[c],i[t]=i[c],t=c}e[t]=s,i[t]=o,this.siftDown_(a,t)}siftDown_(t,e){const i=this.elements_,r=this.priorities_,s=i[e],o=r[e];for(;e>t;){const a=this.getParentIndex_(e);if(r[a]>o)i[e]=i[a],r[e]=r[a],e=a;else break}i[e]=s,r[e]=o}reprioritize(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let r=0;const s=e.length;let o,a,l;for(a=0;a<s;++a)o=e[a],l=t(o),l==Lo?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=l,e[r++]=o);e.length=r,i.length=r,this.heapify_()}}class Fw extends Ow{constructor(t,e){super(i=>t.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(Y.CHANGE,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,i=e.getState();if(i===D.LOADED||i===D.ERROR||i===D.EMPTY){i!==D.ERROR&&e.removeEventListener(Y.CHANGE,this.boundHandleTileChange_);const r=e.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let i=0;for(;this.tilesLoading_<t&&i<e&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===D.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function Dw(n,t,e,i,r){if(!n||!(e in n.wantedTiles)||!n.wantedTiles[e][t.getKey()])return Lo;const s=n.viewState.center,o=i[0]-s[0],a=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}const It={ANIMATING:0,INTERACTING:1},Te={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function lt(n,t,e){return Math.min(Math.max(n,t),e)}function Nw(n,t,e,i,r,s){const o=r-e,a=s-i;if(o!==0||a!==0){const l=((n-e)*o+(t-i)*a)/(o*o+a*a);l>1?(e=r,i=s):l>0&&(e+=o*l,i+=a*l)}return oi(n,t,e,i)}function oi(n,t,e,i){const r=e-n,s=i-t;return r*r+s*s}function Gw(n){const t=n.length;for(let i=0;i<t;i++){let r=i,s=Math.abs(n[i][i]);for(let a=i+1;a<t;a++){const l=Math.abs(n[a][i]);l>s&&(s=l,r=a)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let a=i+1;a<t;a++){const l=-n[a][i]/n[i][i];for(let h=i;h<t+1;h++)i==h?n[a][h]=0:n[a][h]+=l*n[i][h]}}const e=new Array(t);for(let i=t-1;i>=0;i--){e[i]=n[i][t]/n[i][i];for(let r=i-1;r>=0;r--)n[r][t]-=n[r][i]*e[i]}return e}function Af(n){return n*180/Math.PI}function Pn(n){return n*Math.PI/180}function Wi(n,t){const e=n%t;return e*t<0?e+t:e}function ne(n,t,e){return n+e*(t-n)}function Po(n,t){const e=Math.pow(10,t);return Math.round(n*e)/e}function ko(n,t){return Math.floor(Po(n,t))}function Oo(n,t){return Math.ceil(Po(n,t))}function Il(n,t,e){if(n>=t&&n<e)return n;const i=e-t;return((n-t)%i+i)%i+t}function Lf(n,t,e){return function(i,r,s,o,a){if(!i)return;if(!r&&!t)return i;const l=t?0:s[0]*r,h=t?0:s[1]*r,c=a?a[0]:0,u=a?a[1]:0;let f=n[0]+l/2+c,d=n[2]-l/2+c,g=n[1]+h/2+u,p=n[3]-h/2+u;f>d&&(f=(d+f)/2,d=f),g>p&&(g=(p+g)/2,p=g);let _=lt(i[0],f,d),m=lt(i[1],g,p);if(o&&e&&r){const y=30*r;_+=-y*Math.log(1+Math.max(0,f-i[0])/y)+y*Math.log(1+Math.max(0,i[0]-d)/y),m+=-y*Math.log(1+Math.max(0,g-i[1])/y)+y*Math.log(1+Math.max(0,i[1]-p)/y)}return[_,m]}}function $w(n){return n}const vt={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Fo(n){const t=ie();for(let e=0,i=n.length;e<i;++e)Zr(t,n[e]);return t}function Do(n,t,e){return e?(e[0]=n[0]-t,e[1]=n[1]-t,e[2]=n[2]+t,e[3]=n[3]+t,e):[n[0]-t,n[1]-t,n[2]+t,n[3]+t]}function Pf(n,t){return t?(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t):n.slice()}function ai(n,t,e){let i,r;return t<n[0]?i=n[0]-t:n[2]<t?i=t-n[2]:i=0,e<n[1]?r=n[1]-e:n[3]<e?r=e-n[3]:r=0,i*i+r*r}function Bi(n,t){return Ml(n,t[0],t[1])}function ji(n,t){return n[0]<=t[0]&&t[2]<=n[2]&&n[1]<=t[1]&&t[3]<=n[3]}function Ml(n,t,e){return n[0]<=t&&t<=n[2]&&n[1]<=e&&e<=n[3]}function Al(n,t){const e=n[0],i=n[1],r=n[2],s=n[3],o=t[0],a=t[1];let l=vt.UNKNOWN;return o<e?l=l|vt.LEFT:o>r&&(l=l|vt.RIGHT),a<i?l=l|vt.BELOW:a>s&&(l=l|vt.ABOVE),l===vt.UNKNOWN&&(l=vt.INTERSECTING),l}function ie(){return[1/0,1/0,-1/0,-1/0]}function kn(n,t,e,i,r){return r?(r[0]=n,r[1]=t,r[2]=e,r[3]=i,r):[n,t,e,i]}function Ur(n){return kn(1/0,1/0,-1/0,-1/0,n)}function Ll(n,t){const e=n[0],i=n[1];return kn(e,i,e,i,t)}function Pl(n,t,e,i,r){const s=Ur(r);return Of(s,n,t,e,i)}function Vr(n,t){return n[0]==t[0]&&n[2]==t[2]&&n[1]==t[1]&&n[3]==t[3]}function kf(n,t){return t[0]<n[0]&&(n[0]=t[0]),t[2]>n[2]&&(n[2]=t[2]),t[1]<n[1]&&(n[1]=t[1]),t[3]>n[3]&&(n[3]=t[3]),n}function Zr(n,t){t[0]<n[0]&&(n[0]=t[0]),t[0]>n[2]&&(n[2]=t[0]),t[1]<n[1]&&(n[1]=t[1]),t[1]>n[3]&&(n[3]=t[1])}function Of(n,t,e,i,r){for(;e<i;e+=r)zw(n,t[e],t[e+1]);return n}function zw(n,t,e){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}function Ff(n,t){let e;return e=t(No(n)),e||(e=t(Go(n)),e)||(e=t($o(n)),e)||(e=t(hi(n)),e)?e:!1}function kl(n){let t=0;return zo(n)||(t=et(n)*Ot(n)),t}function No(n){return[n[0],n[1]]}function Go(n){return[n[2],n[1]]}function on(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function Xw(n,t){let e;if(t==="bottom-left")e=No(n);else if(t==="bottom-right")e=Go(n);else if(t==="top-left")e=hi(n);else if(t==="top-right")e=$o(n);else throw new Error("Invalid corner");return e}function Ol(n,t,e,i,r){const[s,o,a,l,h,c,u,f]=Df(n,t,e,i);return kn(Math.min(s,a,h,u),Math.min(o,l,c,f),Math.max(s,a,h,u),Math.max(o,l,c,f),r)}function Df(n,t,e,i){const r=t*i[0]/2,s=t*i[1]/2,o=Math.cos(e),a=Math.sin(e),l=r*o,h=r*a,c=s*o,u=s*a,f=n[0],d=n[1];return[f-l+u,d-h-c,f-l-u,d-h+c,f+l-u,d+h+c,f+l+u,d+h-c,f-l+u,d-h-c]}function Ot(n){return n[3]-n[1]}function li(n,t,e){const i=e||ie();return Yt(n,t)?(n[0]>t[0]?i[0]=n[0]:i[0]=t[0],n[1]>t[1]?i[1]=n[1]:i[1]=t[1],n[2]<t[2]?i[2]=n[2]:i[2]=t[2],n[3]<t[3]?i[3]=n[3]:i[3]=t[3]):Ur(i),i}function hi(n){return[n[0],n[3]]}function $o(n){return[n[2],n[3]]}function et(n){return n[2]-n[0]}function Yt(n,t){return n[0]<=t[2]&&n[2]>=t[0]&&n[1]<=t[3]&&n[3]>=t[1]}function zo(n){return n[2]<n[0]||n[3]<n[1]}function Yw(n,t){return t?(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t):n}function Ww(n,t,e){let i=!1;const r=Al(n,t),s=Al(n,e);if(r===vt.INTERSECTING||s===vt.INTERSECTING)i=!0;else{const o=n[0],a=n[1],l=n[2],h=n[3],c=t[0],u=t[1],f=e[0],d=e[1],g=(d-u)/(f-c);let p,_;s&vt.ABOVE&&!(r&vt.ABOVE)&&(p=f-(d-h)/g,i=p>=o&&p<=l),!i&&s&vt.RIGHT&&!(r&vt.RIGHT)&&(_=d-(f-l)*g,i=_>=a&&_<=h),!i&&s&vt.BELOW&&!(r&vt.BELOW)&&(p=f-(d-a)/g,i=p>=o&&p<=l),!i&&s&vt.LEFT&&!(r&vt.LEFT)&&(_=d-(f-o)*g,i=_>=a&&_<=h)}return i}function Nf(n,t){const e=t.getExtent(),i=on(n);if(t.canWrapX()&&(i[0]<e[0]||i[0]>=e[2])){const r=et(e),o=Math.floor((i[0]-e[0])/r)*r;n[0]-=o,n[2]-=o}return n}function Gf(n,t,e){if(t.canWrapX()){const i=t.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];Nf(n,t);const r=et(i);if(et(n)>r&&!e)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function $f(n,t){return n[0]+=+t[0],n[1]+=+t[1],n}function Xo(n,t){let e=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=t[i]){e=!1;break}return e}function Fl(n,t){const e=Math.cos(t),i=Math.sin(t),r=n[0]*e-n[1]*i,s=n[1]*e+n[0]*i;return n[0]=r,n[1]=s,n}function zf(n,t){return n[0]*=t,n[1]*=t,n}function Xf(n,t){if(t.canWrapX()){const e=et(t.getExtent()),i=Bw(n,t,e);i&&(n[0]-=i*e)}return n}function Bw(n,t,e){const i=t.getExtent();let r=0;return t.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(e=e||et(i),r=Math.floor((n[0]-i[0])/e)),r}function Yf(n){return Math.pow(n,3)}function Ki(n){return 1-Yf(1-n)}function jw(n){return 3*n*n-2*n*n*n}function Kw(n){return n}const Uw=63710088e-1;function Wf(n,t,e){e=e||Uw;const i=Pn(n[1]),r=Pn(t[1]),s=(r-i)/2,o=Pn(t[0]-n[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*e*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function Bf(...n){console.warn(...n)}const Dl={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class Nl{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Dl[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const Hr=6378137,Ui=Math.PI*Hr,Vw=[-Ui,-Ui,Ui,Ui],Zw=[-180,-85,180,85],Yo=Hr*Math.log(Math.tan(Math.PI/2));class Vi extends Nl{constructor(t){super({code:t,units:"m",extent:Vw,global:!0,worldExtent:Zw,getPointResolution:function(e,i){return e/Math.cosh(i[1]/Hr)}})}}const jf=[new Vi("EPSG:3857"),new Vi("EPSG:102100"),new Vi("EPSG:102113"),new Vi("EPSG:900913"),new Vi("http://www.opengis.net/def/crs/EPSG/0/3857"),new Vi("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Hw(n,t,e,i){const r=n.length;e=e>1?e:2,i=i??e,t===void 0&&(e>2?t=n.slice():t=new Array(r));for(let s=0;s<r;s+=i){t[s]=Ui*n[s]/180;let o=Hr*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>Yo?o=Yo:o<-Yo&&(o=-Yo),t[s+1]=o}return t}function qw(n,t,e,i){const r=n.length;e=e>1?e:2,i=i??e,t===void 0&&(e>2?t=n.slice():t=new Array(r));for(let s=0;s<r;s+=i)t[s]=180*n[s]/Ui,t[s+1]=360*Math.atan(Math.exp(n[s+1]/Hr))/Math.PI-90;return t}const Jw=6378137,Kf=[-180,-90,180,90],Qw=Math.PI*Jw/180;class ci extends Nl{constructor(t,e){super({code:t,units:"degrees",extent:Kf,axisOrientation:e,global:!0,metersPerUnit:Qw,worldExtent:Kf})}}const Uf=[new ci("CRS:84"),new ci("EPSG:4326","neu"),new ci("urn:ogc:def:crs:OGC:1.3:CRS84"),new ci("urn:ogc:def:crs:OGC:2:84"),new ci("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new ci("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new ci("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Gl={};function tx(n){return Gl[n]||Gl[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function ex(n,t){Gl[n]=t}let Zi={};function qr(n,t,e){const i=n.getCode(),r=t.getCode();i in Zi||(Zi[i]={}),Zi[i][r]=e}function $l(n,t){return n in Zi&&t in Zi[n]?Zi[n][t]:null}const Wo=.9996,ue=.00669438,Bo=ue*ue,jo=Bo*ue,ui=ue/(1-ue),Vf=Math.sqrt(1-ue),Hi=(1-Vf)/(1+Vf),Zf=Hi*Hi,zl=Zf*Hi,Xl=zl*Hi,Hf=Xl*Hi,qf=1-ue/4-3*Bo/64-5*jo/256,nx=3*ue/8+3*Bo/32+45*jo/1024,ix=15*Bo/256+45*jo/1024,rx=35*jo/3072,sx=3/2*Hi-27/32*zl+269/512*Hf,ox=21/16*Zf-55/32*Xl,ax=151/96*zl-417/128*Hf,lx=1097/512*Xl,Ko=6378137;function hx(n,t,e){const i=n-5e5,o=(e.north?t:t-1e7)/Wo/(Ko*qf),a=o+sx*Math.sin(2*o)+ox*Math.sin(4*o)+ax*Math.sin(6*o)+lx*Math.sin(8*o),l=Math.sin(a),h=l*l,c=Math.cos(a),u=l/c,f=u*u,d=f*f,g=1-ue*h,p=Math.sqrt(1-ue*h),_=Ko/p,m=(1-ue)/g,y=ui*c**2,x=y*y,v=i/(_*Wo),w=v*v,E=w*v,C=E*v,R=C*v,S=R*v,I=a-u/m*(w/2-C/24*(5+3*f+10*y-4*x-9*ui))+S/720*(61+90*f+298*y+45*d-252*ui-3*x);let T=(v-E/6*(1+2*f+y)+R/120*(5-2*y+28*f-3*x+8*ui+24*d))/c;return T=Il(T+Pn(td(e.number)),-Math.PI,Math.PI),[Af(T),Af(I)]}const Jf=-80,Qf=84,cx=-180,ux=180;function fx(n,t,e){n=Il(n,cx,ux),t<Jf?t=Jf:t>Qf&&(t=Qf);const i=Pn(t),r=Math.sin(i),s=Math.cos(i),o=r/s,a=o*o,l=a*a,h=Pn(n),c=td(e.number),u=Pn(c),f=Ko/Math.sqrt(1-ue*r**2),d=ui*s**2,g=s*Il(h-u,-Math.PI,Math.PI),p=g*g,_=p*g,m=_*g,y=m*g,x=y*g,v=Ko*(qf*i-nx*Math.sin(2*i)+ix*Math.sin(4*i)-rx*Math.sin(6*i)),w=Wo*f*(g+_/6*(1-a+d)+y/120*(5-18*a+l+72*d-58*ui))+5e5;let E=Wo*(v+f*o*(p/2+m/24*(5-a+9*d+4*d**2)+x/720*(61-58*a+l+600*d-330*ui)));return e.north||(E+=1e7),[w,E]}function td(n){return(n-1)*6-180+3}const dx=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function ed(n){let t=0;for(const r of dx){const s=n.match(r);if(s){t=parseInt(s[1]);break}}if(!t)return null;let e=0,i=!1;return t>32700&&t<32761?e=t-32700:t>32600&&t<32661&&(i=!0,e=t-32600),e?{number:e,north:i}:null}function nd(n,t){return function(e,i,r,s){const o=e.length;r=r>1?r:2,s=s??r,i||(r>2?i=e.slice():i=new Array(o));for(let a=0;a<o;a+=s){const l=e[a],h=e[a+1],c=n(l,h,t);i[a]=c[0],i[a+1]=c[1]}return i}}function gx(n){return ed(n)?new Nl({code:n,units:"m"}):null}function _x(n){const t=ed(n.getCode());return t?{forward:nd(fx,t),inverse:nd(hx,t)}:null}const mx=[_x],px=[gx];let Yl=!0;function id(n){Yl=!1}function Wl(n,t){if(t!==void 0){for(let e=0,i=n.length;e<i;++e)t[e]=n[e];t=t}else t=n.slice();return t}function Bl(n){ex(n.getCode(),n),qr(n,n,Wl)}function yx(n){n.forEach(Bl)}function ft(n){if(typeof n!="string")return n;const t=tx(n);if(t)return t;for(const e of px){const i=e(n);if(i)return i}return null}function rd(n,t,e,i){n=ft(n);let r;const s=n.getPointResolutionFunc();if(s)r=s(t,e);else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=t;else{const a=Kl(n,ft("EPSG:4326"));if(!a&&o!=="degrees")r=t*n.getMetersPerUnit();else{let h=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];h=a(h,h,2);const c=Wf(h.slice(0,2),h.slice(2,4)),u=Wf(h.slice(4,6),h.slice(6,8));r=(c+u)/2}const l=n.getMetersPerUnit();l!==void 0&&(r/=l)}}return r}function sd(n){yx(n),n.forEach(function(t){n.forEach(function(e){t!==e&&qr(t,e,Wl)})})}function vx(n,t,e,i){n.forEach(function(r){t.forEach(function(s){qr(r,s,e),qr(s,r,i)})})}function jl(n,t){return n?typeof n=="string"?ft(n):n:ft(t)}function wx(n){return function(t,e,i,r){const s=t.length;i=i!==void 0?i:2,r=r??i,e=e!==void 0?e:new Array(s);for(let o=0;o<s;o+=r){const a=n(t.slice(o,o+i)),l=a.length;for(let h=0,c=r;h<c;++h)e[o+h]=h>=l?t[o+h]:a[h]}return e}}function od(n,t){return id(),Vl(n,"EPSG:4326","EPSG:3857")}function Uo(n,t){if(n===t)return!0;const e=n.getUnits()===t.getUnits();return(n.getCode()===t.getCode()||Kl(n,t)===Wl)&&e}function Kl(n,t){const e=n.getCode(),i=t.getCode();let r=$l(e,i);if(r)return r;let s=null,o=null;for(const l of mx)s||(s=l(n)),o||(o=l(t));if(!s&&!o)return null;const a="EPSG:4326";if(o)if(s)r=Ul(s.inverse,o.forward);else{const l=$l(e,a);l&&(r=Ul(l,o.forward))}else{const l=$l(a,i);l&&(r=Ul(s.inverse,l))}return r&&(Bl(n),Bl(t),qr(n,t,r)),r}function Ul(n,t){return function(e,i,r,s){return i=n(e,i,r,s),t(i,i,r,s)}}function Jr(n,t){const e=ft(n),i=ft(t);return Kl(e,i)}function Vl(n,t,e){const i=Jr(t,e);if(!i){const r=ft(t).getCode(),s=ft(e).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function Zl(n,t){return n}function an(n,t){return Yl&&!Xo(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(Yl=!1,Bf("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function ad(n,t){return n}function On(n,t){return n}function xx(){sd(jf),sd(Uf),vx(Uf,jf,Hw,qw)}xx(),new Array(6);function Ie(){return[1,0,0,1,0,0]}function Ex(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n}function wt(n,t){const e=t[0],i=t[1];return t[0]=n[0]*e+n[2]*i+n[4],t[1]=n[1]*e+n[3]*i+n[5],t}function ln(n,t,e,i,r,s,o,a){const l=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*l,n[2]=-i*l,n[3]=r*h,n[4]=o*i*h-a*i*l+t,n[5]=o*r*l+a*r*h+e,n}function ld(n,t){const e=Cx(t);Q(e!==0,"Transformation matrix cannot be inverted");const i=t[0],r=t[1],s=t[2],o=t[3],a=t[4],l=t[5];return n[0]=o/e,n[1]=-r/e,n[2]=-s/e,n[3]=i/e,n[4]=(s*l-o*a)/e,n[5]=-(i*l-r*a)/e,n}function Cx(n){return n[0]*n[3]-n[1]*n[2]}const bx=[1e5,1e5,1e5,1e5,2,2];function Rx(n){return"matrix("+n.join(", ")+")"}function hd(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function Sx(n,t){const e=hd(n),i=hd(t);for(let r=0;r<6;++r)if(Math.round((e[r]-i[r])*bx[r])!==0)return!1;return!0}function Fn(n,t,e,i,r,s,o){s=s||[],o=o||2;let a=0;for(let l=t;l<e;l+=i){const h=n[l],c=n[l+1];s[a++]=r[0]*h+r[2]*c+r[4],s[a++]=r[1]*h+r[3]*c+r[5];for(let u=2;u<o;u++)s[a++]=n[l+u]}return s&&s.length!=a&&(s.length=a),s}function cd(n,t,e,i,r,s,o){o=o||[];const a=Math.cos(r),l=Math.sin(r),h=s[0],c=s[1];let u=0;for(let f=t;f<e;f+=i){const d=n[f]-h,g=n[f+1]-c;o[u++]=h+d*a-g*l,o[u++]=c+d*l+g*a;for(let p=f+2;p<f+i;++p)o[u++]=n[p]}return o&&o.length!=u&&(o.length=u),o}function Tx(n,t,e,i,r,s,o,a){a=a||[];const l=o[0],h=o[1];let c=0;for(let u=t;u<e;u+=i){const f=n[u]-l,d=n[u+1]-h;a[c++]=l+r*f,a[c++]=h+s*d;for(let g=u+2;g<u+i;++g)a[c++]=n[g]}return a&&a.length!=c&&(a.length=c),a}function Ix(n,t,e,i,r,s,o){o=o||[];let a=0;for(let l=t;l<e;l+=i){o[a++]=n[l]+r,o[a++]=n[l+1]+s;for(let h=l+2;h<l+i;++h)o[a++]=n[h]}return o&&o.length!=a&&(o.length=a),o}const ud=Ie(),Mx=[NaN,NaN];class fd extends Se{constructor(){super(),this.extent_=ie(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=bf((t,e,i)=>{if(!i)return this.getSimplifiedGeometry(e);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return $()}closestPointXY(t,e,i,r){return $()}containsXY(t,e){return this.closestPointXY(t,e,Mx,Number.MIN_VALUE)===0}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return $()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&Ur(e),this.extentRevision_=this.getRevision()}return Yw(this.extent_,t)}rotate(t,e){$()}scale(t,e,i){$()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return $()}getType(){return $()}applyTransform(t){$()}intersectsExtent(t){return $()}translate(t,e){$()}transform(t,e){const i=ft(t),r=i.getUnits()=="tile-pixels"?function(s,o,a){const l=i.getExtent(),h=i.getWorldExtent(),c=Ot(h)/Ot(l);ln(ud,h[0],h[3],c,-c,0,0,0);const u=Fn(s,0,s.length,a,ud,o),f=Jr(i,e);return f?f(u,u,a):u}:Jr(i,e);return this.applyTransform(r),this}}class fi extends fd{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return Pl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return $()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=dd(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){$()}setLayout(t,e,i){let r;if(t)r=dd(t);else{for(let s=0;s<i;++s){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}r=e.length,t=di(r)}this.layout=t,this.stride=r}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const r=this.getStride();cd(i,0,i.length,r,t,e,i),this.changed()}}scale(t,e,i){e===void 0&&(e=t),i||(i=on(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();Tx(r,0,r.length,s,t,e,i,r),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const r=this.getStride();Ix(i,0,i.length,r,t,e,i),this.changed()}}}function di(n){let t;return n==2?t="XY":n==3?t="XYZ":n==4&&(t="XYZM"),t}function dd(n){let t;return n=="XY"?t=2:n=="XYZ"||n=="XYM"?t=3:n=="XYZM"&&(t=4),t}function Ax(n,t,e){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return Fn(i,0,i.length,r,t,e)}function gd(n,t,e,i){let r=0;const s=n[e-i],o=n[e-i+1];let a=0,l=0;for(;t<e;t+=i){const h=n[t]-s,c=n[t+1]-o;r+=l*h-a*c,a=h,l=c}return r/2}function _d(n,t,e,i){let r=0;for(let s=0,o=e.length;s<o;++s){const a=e[s];r+=gd(n,t,a,i),t=a}return r}function Lx(n,t,e,i){let r=0;for(let s=0,o=e.length;s<o;++s){const a=e[s];r+=_d(n,t,a,i),t=a[a.length-1]}return r}function md(n,t,e,i,r,s,o){const a=n[t],l=n[t+1],h=n[e]-a,c=n[e+1]-l;let u;if(h===0&&c===0)u=t;else{const f=((r-a)*h+(s-l)*c)/(h*h+c*c);if(f>1)u=e;else if(f>0){for(let d=0;d<i;++d)o[d]=ne(n[t+d],n[e+d],f);o.length=i;return}else u=t}for(let f=0;f<i;++f)o[f]=n[u+f];o.length=i}function Hl(n,t,e,i,r){let s=n[t],o=n[t+1];for(t+=i;t<e;t+=i){const a=n[t],l=n[t+1],h=oi(s,o,a,l);h>r&&(r=h),s=a,o=l}return r}function ql(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];r=Hl(n,t,a,i,r),t=a}return r}function Px(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];r=ql(n,t,a,i,r),t=a[a.length-1]}return r}function Jl(n,t,e,i,r,s,o,a,l,h,c){if(t==e)return h;let u,f;if(r===0){if(f=oi(o,a,n[t],n[t+1]),f<h){for(u=0;u<i;++u)l[u]=n[t+u];return l.length=i,f}return h}c=c||[NaN,NaN];let d=t+i;for(;d<e;)if(md(n,d-i,d,i,o,a,c),f=oi(o,a,c[0],c[1]),f<h){for(h=f,u=0;u<i;++u)l[u]=c[u];l.length=i,d+=i}else d+=i*Math.max((Math.sqrt(f)-Math.sqrt(h))/r|0,1);if(s&&(md(n,e-i,t,i,o,a,c),f=oi(o,a,c[0],c[1]),f<h)){for(h=f,u=0;u<i;++u)l[u]=c[u];l.length=i}return h}function Ql(n,t,e,i,r,s,o,a,l,h,c){c=c||[NaN,NaN];for(let u=0,f=e.length;u<f;++u){const d=e[u];h=Jl(n,t,d,i,r,s,o,a,l,h,c),t=d}return h}function kx(n,t,e,i,r,s,o,a,l,h,c){c=c||[NaN,NaN];for(let u=0,f=e.length;u<f;++u){const d=e[u];h=Ql(n,t,d,i,r,s,o,a,l,h,c),t=d[d.length-1]}return h}function Ox(n,t,e,i){for(let r=0,s=e.length;r<s;++r)n[t++]=e[r];return t}function Vo(n,t,e,i){for(let r=0,s=e.length;r<s;++r){const o=e[r];for(let a=0;a<i;++a)n[t++]=o[a]}return t}function Qr(n,t,e,i,r){r=r||[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=Vo(n,t,e[o],i);r[s++]=l,t=l}return r.length=s,r}function pd(n,t,e,i,r){r=r||[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=Qr(n,t,e[o],i,r[s]);l.length===0&&(l[0]=t),r[s++]=l,t=l[l.length-1]}return r.length=s,r}function Dn(n,t,e,i,r){r=r!==void 0?r:[];let s=0;for(let o=t;o<e;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function ts(n,t,e,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];r[s++]=Dn(n,t,l,i,r[s]),t=l}return r.length=s,r}function th(n,t,e,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];r[s++]=l.length===1&&l[0]===t?[]:ts(n,t,l,i,r[s]),t=l[l.length-1]}return r.length=s,r}function Zo(n,t,e,i,r,s,o){const a=(e-t)/i;if(a<3){for(;t<e;t+=i)s[o++]=n[t],s[o++]=n[t+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const h=[t,e-i];let c=0;for(;h.length>0;){const u=h.pop(),f=h.pop();let d=0;const g=n[f],p=n[f+1],_=n[u],m=n[u+1];for(let y=f+i;y<u;y+=i){const x=n[y],v=n[y+1],w=Nw(x,v,g,p,_,m);w>d&&(c=y,d=w)}d>r&&(l[(c-t)/i]=1,f+i<c&&h.push(f,c),c+i<u&&h.push(c,u))}for(let u=0;u<a;++u)l[u]&&(s[o++]=n[t+u*i],s[o++]=n[t+u*i+1]);return o}function yd(n,t,e,i,r,s,o,a){for(let l=0,h=e.length;l<h;++l){const c=e[l];o=Zo(n,t,c,i,r,s,o),a.push(o),t=c}return o}function gi(n,t){return t*Math.round(n/t)}function Fx(n,t,e,i,r,s,o){if(t==e)return o;let a=gi(n[t],r),l=gi(n[t+1],r);t+=i,s[o++]=a,s[o++]=l;let h,c;do if(h=gi(n[t],r),c=gi(n[t+1],r),t+=i,t==e)return s[o++]=h,s[o++]=c,o;while(h==a&&c==l);for(;t<e;){const u=gi(n[t],r),f=gi(n[t+1],r);if(t+=i,u==h&&f==c)continue;const d=h-a,g=c-l,p=u-a,_=f-l;if(d*_==g*p&&(d<0&&p<d||d==p||d>0&&p>d)&&(g<0&&_<g||g==_||g>0&&_>g)){h=u,c=f;continue}s[o++]=h,s[o++]=c,a=h,l=c,h=u,c=f}return s[o++]=h,s[o++]=c,o}function eh(n,t,e,i,r,s,o,a){for(let l=0,h=e.length;l<h;++l){const c=e[l];o=Fx(n,t,c,i,r,s,o),a.push(o),t=c}return o}function Dx(n,t,e,i,r,s,o,a){for(let l=0,h=e.length;l<h;++l){const c=e[l],u=[];o=eh(n,t,c,i,r,s,o,u),a.push(u),t=c[c.length-1]}return o}class es extends fi{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new es(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,r){return r<ai(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Hl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Jl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,r))}getArea(){return gd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Dn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=Zo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new es(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Vo(this.flatCoordinates,0,t,this.stride),this.changed()}}class Nn extends fi{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new Nn(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,r){const s=this.flatCoordinates,o=oi(t,e,s[0],s[1]);if(o<r){const a=this.stride;for(let l=0;l<a;++l)i[l]=s[l];return i.length=a,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return Ll(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return Ml(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ox(this.flatCoordinates,0,t,this.stride),this.changed()}}function Nx(n,t,e,i,r){return!Ff(r,function(o){return!_i(n,t,e,i,o[0],o[1])})}function _i(n,t,e,i,r,s){let o=0,a=n[e-i],l=n[e-i+1];for(;t<e;t+=i){const h=n[t],c=n[t+1];l<=s?c>s&&(h-a)*(s-l)-(r-a)*(c-l)>0&&o++:c<=s&&(h-a)*(s-l)-(r-a)*(c-l)<0&&o--,a=h,l=c}return o!==0}function nh(n,t,e,i,r,s){if(e.length===0||!_i(n,t,e[0],i,r,s))return!1;for(let o=1,a=e.length;o<a;++o)if(_i(n,e[o-1],e[o],i,r,s))return!1;return!0}function Gx(n,t,e,i,r,s){if(e.length===0)return!1;for(let o=0,a=e.length;o<a;++o){const l=e[o];if(nh(n,t,l,i,r,s))return!0;t=l[l.length-1]}return!1}function ih(n,t,e,i,r,s,o){let a,l,h,c,u,f,d;const g=r[s+1],p=[];for(let y=0,x=e.length;y<x;++y){const v=e[y];for(c=n[v-i],f=n[v-i+1],a=t;a<v;a+=i)u=n[a],d=n[a+1],(g<=f&&d<=g||f<=g&&g<=d)&&(h=(g-f)/(d-f)*(u-c)+c,p.push(h)),c=u,f=d}let _=NaN,m=-1/0;for(p.sort(nn),c=p[0],a=1,l=p.length;a<l;++a){u=p[a];const y=Math.abs(u-c);y>m&&(h=(c+u)/2,nh(n,t,e,i,h,g)&&(_=h,m=y)),c=u}return isNaN(_)&&(_=r[s]),o?(o.push(_,g,m),o):[_,g,m]}function vd(n,t,e,i,r){let s=[];for(let o=0,a=e.length;o<a;++o){const l=e[o];s=ih(n,t,l,i,r,2*o,s),t=l[l.length-1]}return s}function wd(n,t,e,i,r){let s;for(t+=i;t<e;t+=i)if(s=r(n.slice(t-i,t),n.slice(t,t+i)),s)return s;return!1}function Ho(n,t,e,i,r,s){return s=s??Of(ie(),n,t,e,i),Yt(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:wd(n,t,e,i,function(o,a){return Ww(r,o,a)}):!1}function $x(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){if(Ho(n,t,e[s],i,r))return!0;t=e[s]}return!1}function xd(n,t,e,i,r){return!!(Ho(n,t,e,i,r)||_i(n,t,e,i,r[0],r[1])||_i(n,t,e,i,r[0],r[3])||_i(n,t,e,i,r[2],r[1])||_i(n,t,e,i,r[2],r[3]))}function Ed(n,t,e,i,r){if(!xd(n,t,e[0],i,r))return!1;if(e.length===1)return!0;for(let s=1,o=e.length;s<o;++s)if(Nx(n,e[s-1],e[s],i,r)&&!Ho(n,e[s-1],e[s],i,r))return!1;return!0}function zx(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];if(Ed(n,t,a,i,r))return!0;t=a[a.length-1]}return!1}function Xx(n,t,e,i){for(;t<e-i;){for(let r=0;r<i;++r){const s=n[t+r];n[t+r]=n[e-i+r],n[e-i+r]=s}t+=i,e-=i}}function rh(n,t,e,i){let r=0,s=n[e-i],o=n[e-i+1];for(;t<e;t+=i){const a=n[t],l=n[t+1];r+=(a-s)*(l+o),s=a,o=l}return r===0?void 0:r>0}function sh(n,t,e,i,r){r=r!==void 0?r:!1;for(let s=0,o=e.length;s<o;++s){const a=e[s],l=rh(n,t,a,i);if(s===0){if(r&&l||!r&&!l)return!1}else if(r&&!l||!r&&l)return!1;t=a}return!0}function Cd(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];if(!sh(n,t,a,i,r))return!1;a.length&&(t=a[a.length-1])}return!0}function qo(n,t,e,i,r){r=r!==void 0?r:!1;for(let s=0,o=e.length;s<o;++s){const a=e[s],l=rh(n,t,a,i);(s===0?r&&l||!r&&!l:r&&!l||!r&&l)&&Xx(n,t,a,i),t=a}return t}function oh(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s)t=qo(n,t,e[s],i,r);return t}function Yx(n,t){const e=[];let i=0,r=0,s;for(let o=0,a=t.length;o<a;++o){const l=t[o],h=rh(n,i,l,2);if(s===void 0&&(s=h),h===s)e.push(t.slice(r,o+1));else{if(e.length===0)continue;e[e.length-1].push(t[r])}r=o+1,i=l}return e}class hn extends fi{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?$e(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new hn(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,r){return r<ai(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ql(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ql(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,r))}containsXY(t,e){return nh(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return _d(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),qo(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,ts(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=on(this.getExtent());this.flatInteriorPoint_=ih(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Nn(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new es(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const l=i[o],h=new es(e.slice(s,l),t);r.push(h),s=l}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;sh(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=qo(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=eh(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new hn(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return Ed(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Qr(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function bd(n){if(zo(n))throw new Error("Cannot create polygon from empty extent");const t=n[0],e=n[1],i=n[2],r=n[3],s=[t,e,t,r,i,r,i,e,t,e];return new hn(s,"XY",[s.length])}function ah(n,t,e,i){const r=et(t)/e[0],s=Ot(t)/e[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function lh(n,t,e){let i=Math.min(n,t);const r=50;return i*=Math.log(1+r*Math.max(0,n/t-1))/r+1,e&&(i=Math.max(i,e),i/=Math.log(1+r*Math.max(0,e/n-1))/r+1),lt(i,e/2,t*2)}function Wx(n,t,e,i){return t=t!==void 0?t:!0,function(r,s,o,a){if(r!==void 0){const l=n[0],h=n[n.length-1],c=e?ah(l,e,o,i):l;if(a)return t?lh(r,c,h):lt(r,h,c);const u=Math.min(c,r),f=Math.floor(Rl(n,u,s));return n[f]>c&&f<n.length-1?n[f+1]:n[f]}}}function Bx(n,t,e,i,r,s){return i=i!==void 0?i:!0,e=e!==void 0?e:0,function(o,a,l,h){if(o!==void 0){const c=r?ah(t,r,l,s):t;if(h)return i?lh(o,c,e):lt(o,e,c);const u=1e-9,f=Math.ceil(Math.log(t/c)/Math.log(n)-u),d=-a*(.5-u)+.5,g=Math.min(c,o),p=Math.floor(Math.log(t/g)/Math.log(n)+d),_=Math.max(f,p),m=t/Math.pow(n,_);return lt(m,e,c)}}}function Rd(n,t,e,i,r){return e=e!==void 0?e:!0,function(s,o,a,l){if(s!==void 0){const h=i?ah(n,i,a,r):n;return!e||!l?lt(s,t,h):lh(s,h,t)}}}function hh(n){if(n!==void 0)return 0}function Sd(n){if(n!==void 0)return n}function jx(n){const t=2*Math.PI/n;return function(e,i){if(i)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e}}function Kx(n){const t=Pn(5);return function(e,i){return i||e===void 0?e:Math.abs(e)<=t?0:e}}const Ux=42,ch=256,uh=0;class Xe extends Se{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=jl(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&id(),t.center&&(t.center=an(t.center,this.projection_)),t.extent&&(t.extent=On(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const a in Te)delete e[a];this.setProperties(e,!0);const i=Zx(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;const r=Vx(t),s=i.constraint,o=Hx(t);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const i=this.getCenterInternal();if(i){const r=t||[0,0,0,0];e=e||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-e[3]+e[1]-r[1]),a=s/2*(r[0]-e[0]+e[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-a])}}getUpdatedOptions_(t){const e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let i=0;i<e.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=an(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=an(r.anchor,this.getProjection())),e[i]=r}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,i;e>1&&typeof arguments[e-1]=="function"&&(i=arguments[e-1],--e);let r=0;for(;r<e&&!this.isDef();++r){const c=arguments[r];c.center&&this.setCenterInternal(c.center),c.zoom!==void 0?this.setZoom(c.zoom):c.resolution&&this.setResolution(c.resolution),c.rotation!==void 0&&this.setRotation(c.rotation)}if(r===e){i&&Jo(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const h=[];for(;r<e;++r){const c=arguments[r],u={start:s,complete:!1,anchor:c.anchor,duration:c.duration!==void 0?c.duration:1e3,easing:c.easing||jw,callback:i};if(c.center&&(u.sourceCenter=o,u.targetCenter=c.center.slice(),o=u.targetCenter),c.zoom!==void 0?(u.sourceResolution=a,u.targetResolution=this.getResolutionForZoom(c.zoom),a=u.targetResolution):c.resolution&&(u.sourceResolution=a,u.targetResolution=c.resolution,a=u.targetResolution),c.rotation!==void 0){u.sourceRotation=l;const f=Wi(c.rotation-l+Math.PI,2*Math.PI)-Math.PI;u.targetRotation=l+f,l=u.targetRotation}qx(u)?u.complete=!0:s+=u.duration,h.push(u)}this.animations_.push(h),this.setHint(It.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[It.ANIMATING]>0}getInteracting(){return this.hints_[It.INTERACTING]>0}cancelAnimations(){this.setHint(It.ANIMATING,-this.hints_[It.ANIMATING]);let t;for(let e=0,i=this.animations_.length;e<i;++e){const r=this.animations_[e];if(r[0].callback&&Jo(r[0].callback,!1),!t)for(let s=0,o=r.length;s<o;++s){const a=r[s];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l.complete)continue;const h=t-l.start;let c=l.duration>0?h/l.duration:1;c>=1?(l.complete=!0,c=1):s=!1;const u=l.easing(c);if(l.sourceCenter){const f=l.sourceCenter[0],d=l.sourceCenter[1],g=l.targetCenter[0],p=l.targetCenter[1];this.nextCenter_=l.targetCenter;const _=f+u*(g-f),m=d+u*(p-d);this.targetCenter_=[_,m]}if(l.sourceResolution&&l.targetResolution){const f=u===1?l.targetResolution:l.sourceResolution+u*(l.targetResolution-l.sourceResolution);if(l.anchor){const d=this.getViewportSize_(this.getRotation()),g=this.constraints_.resolution(f,0,d,!0);this.targetCenter_=this.calculateCenterZoom(g,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=f,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const f=u===1?Wi(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+u*(l.targetRotation-l.sourceRotation);if(l.anchor){const d=this.constraints_.rotation(f,!0);this.targetCenter_=this.calculateCenterRotate(d,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=f}if(this.applyTargetState_(!0),e=!0,!l.complete)break}if(s){this.animations_[i]=null,this.setHint(It.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&Jo(o,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-e[0],r[1]-e[1]],Fl(i,t-this.getRotation()),$f(i,e)),i}calculateCenterZoom(t,e){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=e[0]-t*(e[0]-r[0])/s,a=e[1]-t*(e[1]-r[1])/s;i=[o,a]}return i}getViewportSize_(t){const e=this.viewportSize_;if(t){const i=e[0],r=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(r*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(r*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t&&Zl(t,this.getProjection())}getCenterInternal(){return this.get(Te.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){const e=this.calculateExtentInternal(t);return ad(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();Q(e,"The view center is not defined");const i=this.getResolution();Q(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return Q(r!==void 0,"The view rotation is not defined"),Ol(e,i,r,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(Te.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(On(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const i=et(t)/e[0],r=Ot(t)/e[1];return Math.max(i,r)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(e/i)/Math.log(t);return function(s){return e/Math.pow(t,s*r)}}getRotation(){return this.get(Te.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/e;return function(o){return Math.log(i/o)/e/s}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=fh(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],e,i)}return{center:r.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,i,r;if(this.resolutions_){const s=Rl(this.resolutions_,t,1);e=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return e+Math.log(i/t)/Math.log(r)}getResolutionForZoom(t){var e;if((e=this.resolutions_)!=null&&e.length){if(this.resolutions_.length===1)return this.resolutions_[0];const i=lt(Math.floor(t),0,this.resolutions_.length-2),r=this.resolutions_[i]/this.resolutions_[i+1];return this.resolutions_[i]/Math.pow(r,lt(t-i,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(Q(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){Q(!zo(t),"Cannot fit empty extent provided as `geometry`");const r=On(t,this.getProjection());i=bd(r)}else if(t.getType()==="Circle"){const r=On(t.getExtent(),this.getProjection());i=bd(r),i.rotate(this.getRotation(),on(r))}else i=t;this.fitInternal(i,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),i=Math.cos(e),r=Math.sin(-e),s=t.getFlatCoordinates(),o=t.getStride();let a=1/0,l=1/0,h=-1/0,c=-1/0;for(let u=0,f=s.length;u<f;u+=o){const d=s[u]*i-s[u+1]*r,g=s[u]*r+s[u+1]*i;a=Math.min(a,d),l=Math.min(l,g),h=Math.max(h,d),c=Math.max(c,g)}return[a,l,h,c]}fitInternal(t,e){e=e||{};let i=e.size;i||(i=this.getViewportSizeMinusPadding_());const r=e.padding!==void 0?e.padding:[0,0,0,0],s=e.nearest!==void 0?e.nearest:!1;let o;e.minResolution!==void 0?o=e.minResolution:e.maxZoom!==void 0?o=this.getResolutionForZoom(e.maxZoom):o=0;const a=this.rotatedExtentForGeometry(t);let l=this.getResolutionForExtentInternal(a,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,s?0:1);const h=this.getRotation(),c=Math.sin(h),u=Math.cos(h),f=on(a);f[0]+=(r[1]-r[3])/2*l,f[1]+=(r[0]-r[2])/2*l;const d=f[0]*u-f[1]*c,g=f[1]*u+f[0]*c,p=this.getConstrainedCenter([d,g],l),_=e.callback?e.callback:Br;e.duration!==void 0?this.animateInternal({resolution:l,center:p,duration:e.duration,easing:e.easing},_):(this.targetResolution_=l,this.targetCenter_=p,this.applyTargetState_(!1,!0),Jo(_,!0))}centerOn(t,e,i){this.centerOnInternal(an(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(fh(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,r){let s;const o=this.padding_;if(o&&t){const a=this.getViewportSizeMinusPadding_(-i),l=fh(t,r,[a[0]/2+o[3],a[1]/2+o[0]],e,i);s=[t[0]-l[0],t[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){const e=Zl(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&an(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*t,0,r,i);e&&(this.targetCenter_=this.calculateCenterZoom(s,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=an(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(r,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&an(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const i=this.getAnimating()||this.getInteracting()||e,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),a=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(Te.ROTATION)!==r&&this.set(Te.ROTATION,r),this.get(Te.RESOLUTION)!==o&&(this.set(Te.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(Te.CENTER)||!Xo(this.get(Te.CENTER),a))&&this.set(Te.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=t!==void 0?t:200;const r=e||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,r,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(t===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}i=i||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!Xo(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:a,duration:t,easing:Ki,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(It.INTERACTING,1)}endInteraction(t,e,i){i=i&&an(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.getInteracting()&&(this.setHint(It.INTERACTING,-1),this.resolveConstraints(t,e,i))}getConstrainedCenter(t,e){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){e=e||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}}function Jo(n,t){setTimeout(function(){n(t)},0)}function Vx(n){if(n.extent!==void 0){const e=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return Lf(n.extent,n.constrainOnlyCenter,e)}const t=jl(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&t.isGlobal()){const e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,Lf(e,!1,!1)}return $w}function Zx(n){let t,e,i,o=n.minZoom!==void 0?n.minZoom:uh,a=n.maxZoom!==void 0?n.maxZoom:28;const l=n.zoomFactor!==void 0?n.zoomFactor:2,h=n.multiWorld!==void 0?n.multiWorld:!1,c=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,u=n.showFullExtent!==void 0?n.showFullExtent:!1,f=jl(n.projection,"EPSG:3857"),d=f.getExtent();let g=n.constrainOnlyCenter,p=n.extent;if(!h&&!p&&f.isGlobal()&&(g=!1,p=d),n.resolutions!==void 0){const _=n.resolutions;e=_[o],i=_[a]!==void 0?_[a]:_[_.length-1],n.constrainResolution?t=Wx(_,c,!g&&p,u):t=Rd(e,i,c,!g&&p,u)}else{const m=(d?Math.max(et(d),Ot(d)):360*Dl.degrees/f.getMetersPerUnit())/ch/Math.pow(2,uh),y=m/Math.pow(2,28-uh);e=n.maxResolution,e!==void 0?o=0:e=m/Math.pow(l,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=e/Math.pow(l,a):i=m/Math.pow(l,a):i=y),a=o+Math.floor(Math.log(e/i)/Math.log(l)),i=e/Math.pow(l,a-o),n.constrainResolution?t=Bx(l,e,i,c,!g&&p,u):t=Rd(e,i,c,!g&&p,u)}return{constraint:t,maxResolution:e,minResolution:i,minZoom:o,zoomFactor:l}}function Hx(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const e=n.constrainRotation;return e===void 0||e===!0?Kx():e===!1?Sd:typeof e=="number"?jx(e):Sd}return hh}function qx(n){return!(n.sourceCenter&&n.targetCenter&&!Xo(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function fh(n,t,e,i,r){const s=Math.cos(-r);let o=Math.sin(-r),a=n[0]*s-n[1]*o,l=n[1]*s+n[0]*o;a+=(t[0]/2-e[0])*i,l+=(e[1]-t[1]/2)*i,o=-o;const h=a*s-l*o,c=l*s+a*o;return[h,c]}const Qo="ol-hidden",Jx="ol-selectable",ta="ol-unselectable",dh="ol-control",Td="ol-collapsed",Qx=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),Id=["style","variant","weight","size","lineHeight","family"],gh={normal:400,bold:700},_h=function(n){const t=n.match(Qx);if(!t)return null;const e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=Id.length;i<r;++i){const s=t[i+1];s!==void 0&&(e[Id[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(e.weight))&&e.weight in gh&&(e.weight=gh[e.weight]),e.families=e.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),e};function _t(n,t,e,i){let r;return e&&e.length?r=e.shift():Sl?r=new OffscreenCanvas(n||300,t||300):r=document.createElement("canvas"),n&&(r.width=n),t&&(r.height=t),r.getContext("2d",i)}let mh;function ea(){return mh||(mh=_t(1,1)),mh}function na(n){const t=n.canvas;t.width=1,t.height=1,n.clearRect(0,0,1,1)}function t1(n){let t=n.offsetWidth;const e=getComputedStyle(n);return t+=parseInt(e.marginLeft,10)+parseInt(e.marginRight,10),t}function e1(n){let t=n.offsetHeight;const e=getComputedStyle(n);return t+=parseInt(e.marginTop,10)+parseInt(e.marginBottom,10),t}function Md(n,t){const e=t.parentNode;e&&e.replaceChild(n,t)}function Ad(n){for(;n.lastChild;)n.lastChild.remove()}function n1(n,t){const e=n.childNodes;for(let i=0;;++i){const r=e[i],s=t[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}class ph extends Se{constructor(t){super();const e=t.element;e&&!t.target&&!e.style.pointerEvents&&(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){var t;(t=this.element)==null||t.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(t){var e;this.map_&&((e=this.element)==null||e.remove());for(let i=0,r=this.listenerKeys.length;i<r;++i)at(this.listenerKeys[i]);if(this.listenerKeys.length=0,this.map_=t,t){const i=this.target_??t.getOverlayContainerStopEvent();this.element&&i.appendChild(this.element),this.render!==Br&&this.listenerKeys.push(V(t,sn.POSTRENDER,this.render,this)),t.render()}}render(t){}setTarget(t){this.target_=typeof t=="string"?document.getElementById(t):t}}class i1 extends ph{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=t.collapsed!==void 0?t.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=t.collapsible!==void 0,this.collapsible_=t.collapsible!==void 0?t.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=t.attributions;const e=t.className!==void 0?t.className:"ol-attribution",i=t.tipLabel!==void 0?t.tipLabel:"Attributions",r=t.expandClassName!==void 0?t.expandClassName:e+"-expand",s=t.collapseLabel!==void 0?t.collapseLabel:"›",o=t.collapseClassName!==void 0?t.collapseClassName:e+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=t.label!==void 0?t.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=r):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(Y.CLICK,this.handleClick_.bind(this),!1);const h=e+" "+ta+" "+dh+(this.collapsed_&&this.collapsible_?" "+Td:"")+(this.collapsible_?"":" ol-uncollapsible"),c=this.element;c.className=h,c.appendChild(this.toggleButton_),c.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=this.getMap().getAllLayers(),i=new Set(e.flatMap(r=>r.getAttributions(t)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!e.some(s=>{var o;return((o=s.getSource())==null?void 0:o.getAttributionsCollapsible())===!1});this.setCollapsible(r)}return Array.from(i)}async updateElement_(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const e=await Promise.all(this.collectSourceAttributions_(t).map(r=>Iw(()=>r))),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!An(e,this.renderedAttributions_)){Ad(this.ulElement_);for(let r=0,s=e.length;r<s;++r){const o=document.createElement("li");o.innerHTML=e[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(Td),this.collapsed_?Md(this.collapseLabel_,this.label_):Md(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}}class r1 extends ph{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=t.className!==void 0?t.className:"ol-rotate",i=t.label!==void 0?t.label:"⇧",r=t.compassClassName!==void 0?t.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=t.tipLabel?t.tipLabel:"Reset rotation",o=document.createElement("button");o.className=e+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(Y.CLICK,this.handleClick_.bind(this),!1);const a=e+" "+ta+" "+dh,l=this.element;l.className=a,l.appendChild(o),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=t.duration!==void 0?t.duration:250,this.autoHide_=t.autoHide!==void 0?t.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Qo)}handleClick_(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const e=this.getMap().getView();if(!e)return;const i=e.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?e.animate({rotation:0,duration:this.duration_,easing:Ki}):e.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Qo);!s&&i===0?this.element.classList.add(Qo):s&&i!==0&&this.element.classList.remove(Qo)}this.label_.style.transform=r}this.rotation_=i}}class s1 extends ph{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=t.className!==void 0?t.className:"ol-zoom",i=t.delta!==void 0?t.delta:1,r=t.zoomInClassName!==void 0?t.zoomInClassName:e+"-in",s=t.zoomOutClassName!==void 0?t.zoomOutClassName:e+"-out",o=t.zoomInLabel!==void 0?t.zoomInLabel:"+",a=t.zoomOutLabel!==void 0?t.zoomOutLabel:"–",l=t.zoomInTipLabel!==void 0?t.zoomInTipLabel:"Zoom in",h=t.zoomOutTipLabel!==void 0?t.zoomOutTipLabel:"Zoom out",c=document.createElement("button");c.className=r,c.setAttribute("type","button"),c.title=l,c.appendChild(typeof o=="string"?document.createTextNode(o):o),c.addEventListener(Y.CLICK,this.handleClick_.bind(this,i),!1);const u=document.createElement("button");u.className=s,u.setAttribute("type","button"),u.title=h,u.appendChild(typeof a=="string"?document.createTextNode(a):a),u.addEventListener(Y.CLICK,this.handleClick_.bind(this,-i),!1);const f=e+" "+ta+" "+dh,d=this.element;d.className=f,d.appendChild(c),d.appendChild(u),this.duration_=t.duration!==void 0?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+t);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:Ki})):i.setZoom(s)}}}function Ld(n){n=n||{};const t=new ze;return(n.zoom!==void 0?n.zoom:!0)&&t.push(new s1(n.zoomOptions)),(n.rotate!==void 0?n.rotate:!0)&&t.push(new r1(n.rotateOptions)),(n.attribution!==void 0?n.attribution:!0)&&t.push(new i1(n.attributionOptions)),t}class o1{constructor(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let i=e-3;for(;i>0&&this.points_[i+2]>t;)i-=3;const r=this.points_[e+2]-this.points_[i+2];if(r<16.666666666666668)return!1;const s=this.points_[e]-this.points_[i],o=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const Pd={ACTIVE:"active"};class ns extends Se{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Pd.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(Pd.ACTIVE,t)}setMap(t){this.map_=t}}function a1(n,t,e){const i=n.getCenterInternal();if(i){const r=[i[0]+t[0],i[1]+t[1]];n.animateInternal({duration:e!==void 0?e:250,easing:Kw,center:n.getConstrainedCenter(r)})}}function yh(n,t,e,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+t),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:e,duration:i!==void 0?i:250,easing:Ki})}class l1 extends ns{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:250}handleEvent(t){let e=!1;if(t.type==ut.DBLCLICK){const i=t.originalEvent,r=t.map,s=t.coordinate,o=i.shiftKey?-this.delta_:this.delta_,a=r.getView();yh(a,o,s,this.duration_),i.preventDefault(),e=!0}return!e}}function vh(n){const t=arguments;return function(e){let i=!0;for(let r=0,s=t.length;r<s&&(i=i&&t[r](e),!!i);++r);return i}}const h1=function(n){const t=n.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},c1=function(n){const t=n.map.getTargetElement(),e=t.getRootNode(),i=n.map.getOwnerDocument().activeElement;return e instanceof ShadowRoot?e.host.contains(i):t.contains(i)},kd=function(n){const t=n.map.getTargetElement(),e=t.getRootNode();return(e instanceof ShadowRoot?e.host:t).hasAttribute("tabindex")?c1(n):!0},u1=Wr,Od=function(n){const t=n.originalEvent;return"pointerId"in t&&t.button==0&&!(Lw&&Tf&&t.ctrlKey)},Fd=function(n){const t=n.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},f1=function(n){const t=n.originalEvent;return Tf?t.metaKey:t.ctrlKey},d1=function(n){const t=n.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},Dd=function(n){const t=n.originalEvent,e=t.target.tagName;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"&&!t.target.isContentEditable},wh=function(n){const t=n.originalEvent;return"pointerId"in t&&t.pointerType=="mouse"},g1=function(n){const t=n.originalEvent;return"pointerId"in t&&t.isPrimary&&t.button===0};class is extends ns{constructor(t){t=t||{},super(t),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==ut.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==ut.POINTERUP){const i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==ut.POINTERDOWN){const i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==ut.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}}function xh(n){const t=n.length;let e=0,i=0;for(let r=0;r<t;r++)e+=n[r].clientX,i+=n[r].clientY;return{clientX:e/t,clientY:i/t}}class _1 extends is{constructor(t){super({stopDown:To}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:vh(Fd,g1);this.condition_=t.onFocusOnly?vh(kd,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const i=this.targetPointers,r=e.getEventPixel(xh(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],a=t.map.getView();zf(s,a.getResolution()),Fl(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,i=e.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=e.getPixelFromCoordinateInternal(o),l=e.getCoordinateFromPixelInternal([a[0]-r*Math.cos(s),a[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(l),duration:500,easing:Ki})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const i=t.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class m1 extends is{constructor(t){t=t||{},super({stopDown:To}),this.condition_=t.condition?t.condition:h1,this.lastAngle_=void 0,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){if(!wh(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===hh)return;const r=e.getSize(),s=t.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(t){return wh(t)?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){return wh(t)&&Od(t)&&this.condition_(t)?(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class p1 extends So{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(t[0],e[0])+i,r.top=Math.min(t[1],e[1])+i,r.width=Math.abs(e[0]-t[0])+i,r.height=Math.abs(e[1]-t[1])+i}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const t=this.startPixel_,e=this.endPixel_,r=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new hn([r])}getGeometry(){return this.geometry_}}const qi={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class rs extends rn{constructor(t,e,i){super(t),this.coordinate=e,this.mapBrowserEvent=i}}class y1 extends is{constructor(t){super(),this.on,this.once,this.un,t=t??{},this.box_=new p1(t.className||"ol-dragbox"),this.minArea_=t.minArea??64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition??Od,this.boxEndCondition_=t.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,i){const r=i[0]-e[0],s=i[1]-e[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.startPixel_&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new rs(qi.BOXDRAG,t.coordinate,t)))}handleUpEvent(t){if(!this.startPixel_)return!1;const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new rs(e?qi.BOXEND:qi.BOXCANCEL,t.coordinate,t)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new rs(qi.BOXSTART,t.coordinate,t)),!0):!1}onBoxEnd(t){}setActive(t){t||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new rs(qi.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(t)}setMap(t){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new rs(qi.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(t)}}class v1 extends y1{constructor(t){t=t||{};const e=t.condition?t.condition:d1;super({condition:e,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=t.duration!==void 0?t.duration:200,this.out_=t.out!==void 0?t.out:!1}onBoxEnd(t){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),a=i.getResolution()/o;r=r.clone(),r.scale(a*a)}i.fitInternal(r,{duration:this.duration_,easing:Ki})}}const mi={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class w1 extends ns{constructor(t){super(),t=t||{},this.defaultCondition_=function(e){return Fd(e)&&Dd(e)},this.condition_=t.condition!==void 0?t.condition:this.defaultCondition_,this.duration_=t.duration!==void 0?t.duration:100,this.pixelDelta_=t.pixelDelta!==void 0?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==Y.KEYDOWN){const i=t.originalEvent,r=i.key;if(this.condition_(t)&&(r==mi.DOWN||r==mi.LEFT||r==mi.RIGHT||r==mi.UP)){const o=t.map.getView(),a=o.getResolution()*this.pixelDelta_;let l=0,h=0;r==mi.DOWN?h=-a:r==mi.LEFT?l=-a:r==mi.RIGHT?l=a:h=a;const c=[l,h];Fl(c,o.getRotation()),a1(o,c,this.duration_),i.preventDefault(),e=!0}}return!e}}class x1 extends ns{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(e){return!f1(e)&&Dd(e)},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:100}handleEvent(t){let e=!1;if(t.type==Y.KEYDOWN||t.type==Y.KEYPRESS){const i=t.originalEvent,r=i.key;if(this.condition_(t)&&(r==="+"||r==="-")){const s=t.map,o=r==="+"?this.delta_:-this.delta_,a=s.getView();yh(a,o,void 0,this.duration_),i.preventDefault(),e=!0}}return!e}}const E1=40,C1=300;class b1 extends ns{constructor(t){t=t||{},super(t),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=t.maxDelta!==void 0?t.maxDelta:1,this.duration_=t.duration!==void 0?t.duration:250,this.timeout_=t.timeout!==void 0?t.timeout:80,this.useAnchor_=t.useAnchor!==void 0?t.useAnchor:!0,this.constrainResolution_=t.constrainResolution!==void 0?t.constrainResolution:!1;const e=t.condition?t.condition:u1;this.condition_=t.onFocusOnly?vh(kd,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();if(!t)return;t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(t){if(!this.condition_(t)||t.type!==Y.WHEEL)return!0;const i=t.map,r=t.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=E1;break;case WheelEvent.DOM_DELTA_PAGE:s*=C1;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=i.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),l),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let i=-lt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),yh(e,i,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}class R1 extends is{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=To),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=t.threshold!==void 0?t.threshold:.3,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){let e=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=l}this.lastAngle_=s;const o=t.map,a=o.getView();a.getConstraints().rotation!==hh&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(xh(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return this.targetPointers.length<2?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}class S1 extends is{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=To),super(e),this.anchor_=null,this.duration_=t.duration!==void 0?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(e=this.lastDistance_/a),this.lastDistance_=a;const l=t.map,h=l.getView();e!=1&&(this.lastScaleDelta_=e),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(xh(this.targetPointers))),l.render(),h.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const i=t.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}function Nd(n){n=n||{};const t=new ze,e=new o1(-.005,.05,100);return(n.altShiftDragRotate!==void 0?n.altShiftDragRotate:!0)&&t.push(new m1),(n.doubleClickZoom!==void 0?n.doubleClickZoom:!0)&&t.push(new l1({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan!==void 0?n.dragPan:!0)&&t.push(new _1({onFocusOnly:n.onFocusOnly,kinetic:e})),(n.pinchRotate!==void 0?n.pinchRotate:!0)&&t.push(new R1),(n.pinchZoom!==void 0?n.pinchZoom:!0)&&t.push(new S1({duration:n.zoomDuration})),(n.keyboard!==void 0?n.keyboard:!0)&&(t.push(new w1),t.push(new x1({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom!==void 0?n.mouseWheelZoom:!0)&&t.push(new b1({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom!==void 0?n.shiftDragZoom:!0)&&t.push(new v1({duration:n.zoomDuration})),t}const nt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class Gd extends Se{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[nt.OPACITY]=t.opacity!==void 0?t.opacity:1,Q(typeof e[nt.OPACITY]=="number","Layer opacity must be a number"),e[nt.VISIBLE]=t.visible!==void 0?t.visible:!0,e[nt.Z_INDEX]=t.zIndex,e[nt.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[nt.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[nt.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[nt.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:t===void 0?!0:t},i=this.getZIndex();return e.opacity=lt(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=i===void 0&&!e.managed?1/0:i,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return $()}getLayerStatesArray(t){return $()}getExtent(){return this.get(nt.EXTENT)}getMaxResolution(){return this.get(nt.MAX_RESOLUTION)}getMinResolution(){return this.get(nt.MIN_RESOLUTION)}getMinZoom(){return this.get(nt.MIN_ZOOM)}getMaxZoom(){return this.get(nt.MAX_ZOOM)}getOpacity(){return this.get(nt.OPACITY)}getSourceState(){return $()}getVisible(){return this.get(nt.VISIBLE)}getZIndex(){return this.get(nt.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(nt.EXTENT,t)}setMaxResolution(t){this.set(nt.MAX_RESOLUTION,t)}setMinResolution(t){this.set(nt.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(nt.MAX_ZOOM,t)}setMinZoom(t){this.set(nt.MIN_ZOOM,t)}setOpacity(t){Q(typeof t=="number","Layer opacity must be a number"),this.set(nt.OPACITY,t)}setVisible(t){this.set(nt.VISIBLE,t)}setZIndex(t){this.set(nt.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Gn extends rn{constructor(t,e){super(t),this.layer=e}}const Eh={LAYERS:"layers"};class Ji extends Gd{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let i=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Eh.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new ze(i.slice(),{unique:!0}):Q(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new ze(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(at),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(V(t,Xt.ADD,this.handleLayersAdd_,this),V(t,Xt.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(at);jr(this.listenerKeys_);const e=t.getArray();for(let i=0,r=e.length;i<r;i++){const s=e[i];this.registerLayerListeners_(s),this.dispatchEvent(new Gn("addlayer",s))}this.changed()}registerLayerListeners_(t){const e=[V(t,Xi.PROPERTYCHANGE,this.handleLayerChange_,this),V(t,Y.CHANGE,this.handleLayerChange_,this)];t instanceof Ji&&e.push(V(t,"addlayer",this.handleLayerGroupAdd_,this),V(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[Z(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new Gn("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new Gn("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new Gn("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,i=Z(e);this.listenerKeys_[i].forEach(at),delete this.listenerKeys_[i],this.dispatchEvent(new Gn("removelayer",e)),this.changed()}getLayers(){return this.get(Eh.LAYERS)}setLayers(t){const e=this.getLayers();if(e){const i=e.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new Gn("removelayer",i[r]))}this.set(Eh.LAYERS,t)}getLayersArray(t){return t=t!==void 0?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){const e=t!==void 0?t:[],i=e.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(e)});const r=this.getLayerState();let s=r.zIndex;!t&&r.zIndex===void 0&&(s=0);for(let o=i,a=e.length;o<a;o++){const l=e[o];l.opacity*=r.opacity,l.visible=l.visible&&r.visible,l.maxResolution=Math.min(l.maxResolution,r.maxResolution),l.minResolution=Math.max(l.minResolution,r.minResolution),l.minZoom=Math.max(l.minZoom,r.minZoom),l.maxZoom=Math.min(l.maxZoom,r.maxZoom),r.extent!==void 0&&(l.extent!==void 0?l.extent=li(l.extent,r.extent):l.extent=r.extent),l.zIndex===void 0&&(l.zIndex=s)}return e}getSourceState(){return"ready"}}const fe={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};class ia extends Gd{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(nt.SOURCE,this.handleSourcePropertyChange_);const i=t.source?t.source:null;this.setSource(i)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(nt.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(at(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=V(t,Y.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let e;const i=this.getMapInternal();!t&&i&&(t=i.getView()),t instanceof Xe?e={viewState:t.getState(),extent:t.calculateExtent()}:e=t,!e.layerStatesArray&&i&&(e.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(e.layerStatesArray){if(r=e.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return Ch(r,e.viewState)&&(!s||Yt(s,e.extent))}getAttributions(t){var s;if(!this.isVisible(t))return[];const e=(s=this.getSource())==null?void 0:s.getAttributions();if(!e)return[];const i=t instanceof Xe?t.getViewStateAndExtent():t;let r=e(i);return Array.isArray(r)||(r=[r]),r}render(t,e){const i=this.getRenderer();return i.prepareFrame(t)?(this.rendered=!0,i.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){const e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set(nt.MAP,t)}getMapInternal(){return this.get(nt.MAP)}setMap(t){this.mapPrecomposeKey_&&(at(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(at(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=V(t,fe.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=V(this,Y.CHANGE,t.render,t),this.changed())}handlePrecompose_(t){const e=t.frameState.layerStatesArray,i=this.getLayerState(!1);Q(!e.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(i)}setSource(t){this.set(nt.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function Ch(n,t){if(!n.visible)return!1;const e=t.resolution;if(e<n.minResolution||e>=n.maxResolution)return!1;const i=t.zoom;return i>n.minZoom&&i<=n.maxZoom}function $d(n,t,e=0,i=n.length-1,r=T1){for(;i>e;){if(i-e>600){const l=i-e+1,h=t-e+1,c=Math.log(l),u=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*u*(l-u)/l)*(h-l/2<0?-1:1),d=Math.max(e,Math.floor(t-h*u/l+f)),g=Math.min(i,Math.floor(t+(l-h)*u/l+f));$d(n,t,d,g,r)}const s=n[t];let o=e,a=i;for(ss(n,e,t),r(n[i],s)>0&&ss(n,e,i);o<a;){for(ss(n,o,a),o++,a--;r(n[o],s)<0;)o++;for(;r(n[a],s)>0;)a--}r(n[e],s)===0?ss(n,e,a):(a++,ss(n,a,i)),a<=t&&(e=a+1),t<=a&&(i=a-1)}}function ss(n,t,e){const i=n[t];n[t]=n[e],n[e]=i}function T1(n,t){return n<t?-1:n>t?1:0}let zd=class{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const i=[];if(!sa(t,e))return i;const r=this.toBBox,s=[];for(;e;){for(let o=0;o<e.children.length;o++){const a=e.children[o],l=e.leaf?r(a):a;sa(t,l)&&(e.leaf?i.push(a):Rh(t,l)?this._all(a,i):s.push(a))}e=s.pop()}return i}collides(t){let e=this.data;if(!sa(t,e))return!1;const i=[];for(;e;){for(let r=0;r<e.children.length;r++){const s=e.children[r],o=e.leaf?this.toBBox(s):s;if(sa(t,o)){if(e.leaf||Rh(t,o))return!0;i.push(s)}}e=i.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let i=0;i<t.length;i++)this.insert(t[i]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const i=this.data;this.data=e,e=i}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=tr([]),this}remove(t,e){if(!t)return this;let i=this.data;const r=this.toBBox(t),s=[],o=[];let a,l,h;for(;i||s.length;){if(i||(i=s.pop(),l=s[s.length-1],a=o.pop(),h=!0),i.leaf){const c=I1(t,i.children,e);if(c!==-1)return i.children.splice(c,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&Rh(i,r)?(s.push(i),o.push(a),a=0,l=i,i=i.children[0]):l?(a++,i=l.children[a],h=!1):i=null}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const i=[];for(;t;)t.leaf?e.push(...t.children):i.push(...t.children),t=i.pop();return e}_build(t,e,i,r){const s=i-e+1;let o=this._maxEntries,a;if(s<=o)return a=tr(t.slice(e,i+1)),Qi(a,this.toBBox),a;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),a=tr([]),a.leaf=!1,a.height=r;const l=Math.ceil(s/o),h=l*Math.ceil(Math.sqrt(o));Xd(t,e,i,h,this.compareMinX);for(let c=e;c<=i;c+=h){const u=Math.min(c+h-1,i);Xd(t,c,u,l,this.compareMinY);for(let f=c;f<=u;f+=l){const d=Math.min(f+l-1,u);a.children.push(this._build(t,f,d,r-1))}}return Qi(a,this.toBBox),a}_chooseSubtree(t,e,i,r){for(;r.push(e),!(e.leaf||r.length-1===i);){let s=1/0,o=1/0,a;for(let l=0;l<e.children.length;l++){const h=e.children[l],c=bh(h),u=L1(t,h)-c;u<o?(o=u,s=c<s?c:s,a=h):u===o&&c<s&&(s=c,a=h)}e=a||e.children[0]}return e}_insert(t,e,i){const r=i?t:this.toBBox(t),s=[],o=this._chooseSubtree(r,this.data,e,s);for(o.children.push(t),as(o,r);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(r,s,e)}_split(t,e){const i=t[e],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),a=tr(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,Qi(i,this.toBBox),Qi(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)}_splitRoot(t,e){this.data=tr([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Qi(this.data,this.toBBox)}_chooseSplitIndex(t,e,i){let r,s=1/0,o=1/0;for(let a=e;a<=i-e;a++){const l=os(t,0,a,this.toBBox),h=os(t,a,i,this.toBBox),c=P1(l,h),u=bh(l)+bh(h);c<s?(s=c,r=a,o=u<o?u:o):c===s&&u<o&&(o=u,r=a)}return r||i-e}_chooseSplitAxis(t,e,i){const r=t.leaf?this.compareMinX:M1,s=t.leaf?this.compareMinY:A1,o=this._allDistMargin(t,e,i,r),a=this._allDistMargin(t,e,i,s);o<a&&t.children.sort(r)}_allDistMargin(t,e,i,r){t.children.sort(r);const s=this.toBBox,o=os(t,0,e,s),a=os(t,i-e,i,s);let l=ra(o)+ra(a);for(let h=e;h<i-e;h++){const c=t.children[h];as(o,t.leaf?s(c):c),l+=ra(o)}for(let h=i-e-1;h>=e;h--){const c=t.children[h];as(a,t.leaf?s(c):c),l+=ra(a)}return l}_adjustParentBBoxes(t,e,i){for(let r=i;r>=0;r--)as(e[r],t)}_condense(t){for(let e=t.length-1,i;e>=0;e--)t[e].children.length===0?e>0?(i=t[e-1].children,i.splice(i.indexOf(t[e]),1)):this.clear():Qi(t[e],this.toBBox)}};function I1(n,t,e){if(!e)return t.indexOf(n);for(let i=0;i<t.length;i++)if(e(n,t[i]))return i;return-1}function Qi(n,t){os(n,0,n.children.length,t,n)}function os(n,t,e,i,r){r||(r=tr(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=t;s<e;s++){const o=n.children[s];as(r,n.leaf?i(o):o)}return r}function as(n,t){return n.minX=Math.min(n.minX,t.minX),n.minY=Math.min(n.minY,t.minY),n.maxX=Math.max(n.maxX,t.maxX),n.maxY=Math.max(n.maxY,t.maxY),n}function M1(n,t){return n.minX-t.minX}function A1(n,t){return n.minY-t.minY}function bh(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function ra(n){return n.maxX-n.minX+(n.maxY-n.minY)}function L1(n,t){return(Math.max(t.maxX,n.maxX)-Math.min(t.minX,n.minX))*(Math.max(t.maxY,n.maxY)-Math.min(t.minY,n.minY))}function P1(n,t){const e=Math.max(n.minX,t.minX),i=Math.max(n.minY,t.minY),r=Math.min(n.maxX,t.maxX),s=Math.min(n.maxY,t.maxY);return Math.max(0,r-e)*Math.max(0,s-i)}function Rh(n,t){return n.minX<=t.minX&&n.minY<=t.minY&&t.maxX<=n.maxX&&t.maxY<=n.maxY}function sa(n,t){return t.minX<=n.maxX&&t.minY<=n.maxY&&t.maxX>=n.minX&&t.maxY>=n.minY}function tr(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Xd(n,t,e,i,r){const s=[t,e];for(;s.length;){if(e=s.pop(),t=s.pop(),e-t<=i)continue;const o=t+Math.ceil((e-t)/i/2)*i;$d(n,o,t,e,r),s.push(t,o,o,e)}}const Sh=[NaN,NaN,NaN,0];let Th;function k1(){return Th||(Th=_t(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),Th}const O1=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,F1=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,D1=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,N1=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function oa(n,t){return n.endsWith("%")?Number(n.substring(0,n.length-1))/t:Number(n)}function ls(n){throw new Error('failed to parse "'+n+'" as color')}function Yd(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(F1)||n.match(O1)||n.match(D1);if(s){const o=s[4],a=100/255;return[lt(oa(s[1],a)+.5|0,0,255),lt(oa(s[2],a)+.5|0,0,255),lt(oa(s[3],a)+.5|0,0,255),o!==void 0?lt(oa(o,100),0,1):1]}ls(n)}if(n.startsWith("#")){if(N1.test(n)){const s=n.substring(1),o=s.length<=4?1:2,a=[0,0,0,255];for(let l=0,h=s.length;l<h;l+=o){let c=parseInt(s.substring(l,l+o),16);o===1&&(c+=c<<4),a[l/o]=c}return a[3]=a[3]/255,a}ls(n)}const t=k1();t.fillStyle="#abcdef";let e=t.fillStyle;t.fillStyle=n,t.fillStyle===e&&(t.fillStyle="#fedcba",e=t.fillStyle,t.fillStyle=n,t.fillStyle===e&&ls(n));const i=t.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return Yd(i);t.clearRect(0,0,1,1),t.fillRect(0,0,1,1);const r=Array.from(t.getImageData(0,0,1,1).data);return r[3]=Po(r[3]/255,3),r}function G1(n){return typeof n=="string"?n:Oh(n)}const $1=1024,hs={};let Ih=0;function z1(n){if(n.length===4)return n;const t=n.slice();return t[3]=1,t}function Mh(n){return n>.0031308?Math.pow(n,.4166666666666667)*269.025-14.025:n*3294.6}function Ah(n){return n>.2068965?Math.pow(n,3):(n-.13793103448275862)*.12841854934601665}function Lh(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function Ph(n){return n>.0088564?Math.pow(n,.3333333333333333):n/.12841854934601665+.13793103448275862}function Wd(n){const t=Lh(n[0]),e=Lh(n[1]),i=Lh(n[2]),r=Ph(t*.222488403+e*.716873169+i*.06060791),s=500*(Ph(t*.452247074+e*.399439023+i*.148375274)-r),o=200*(r-Ph(t*.016863605+e*.117638439+i*.865350722)),a=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),a<0?a+360:a,n[3]]}function X1(n){const t=(n[0]+16)/116,e=n[1],i=n[2]*Math.PI/180,r=Ah(t),s=Ah(t+e/500*Math.cos(i)),o=Ah(t-e/200*Math.sin(i)),a=Mh(s*3.021973625-r*1.617392459-o*.404875592),l=Mh(s*-.943766287+r*1.916279586+o*.027607165),h=Mh(s*.069407491-r*.22898585+o*1.159737864);return[lt(a+.5|0,0,255),lt(l+.5|0,0,255),lt(h+.5|0,0,255),n[3]]}function kh(n){if(n==="none")return Sh;if(hs.hasOwnProperty(n))return hs[n];if(Ih>=$1){let e=0;for(const i in hs)(e++&3)===0&&(delete hs[i],--Ih)}const t=Yd(n);t.length!==4&&ls(n);for(const e of t)isNaN(e)&&ls(n);return hs[n]=t,++Ih,t}function er(n){return Array.isArray(n)?n:kh(n)}function Oh(n){let t=n[0];t!=(t|0)&&(t=t+.5|0);let e=n[1];e!=(e|0)&&(e=e+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+t+","+e+","+i+","+r+")"}function Bd(n){return n[0]>0&&n[1]>0}function Y1(n,t,e){return e===void 0&&(e=[0,0]),e[0]=n[0]*t+.5|0,e[1]=n[1]*t+.5|0,e}function Wt(n,t){return Array.isArray(n)?n:(t===void 0?t=[n,n]:(t[0]=n,t[1]=n),t)}let pi=0;const Ft=1<<pi++,K=1<<pi++,Bt=1<<pi++,Me=1<<pi++,yi=1<<pi++,cs=1<<pi++,aa=Math.pow(2,pi)-1,Fh={[Ft]:"boolean",[K]:"number",[Bt]:"string",[Me]:"color",[yi]:"number[]",[cs]:"size"},W1=Object.keys(Fh).map(Number).sort(nn);function B1(n){return n in Fh}function us(n){const t=[];for(const e of W1)fs(n,e)&&t.push(Fh[e]);return t.length===0?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function fs(n,t){return(n&t)===t}function $n(n,t){return n===t}class mt{constructor(t,e){if(!B1(t))throw new Error(`literal expressions must have a specific type, got ${us(t)}`);this.type=t,this.value=e}}class j1{constructor(t,e,...i){this.type=t,this.operator=e,this.args=i}}function jd(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function bt(n,t,e){switch(typeof n){case"boolean":{if($n(t,Bt))return new mt(Bt,n?"true":"false");if(!fs(t,Ft))throw new Error(`got a boolean, but expected ${us(t)}`);return new mt(Ft,n)}case"number":{if($n(t,cs))return new mt(cs,Wt(n));if($n(t,Ft))return new mt(Ft,!!n);if($n(t,Bt))return new mt(Bt,n.toString());if(!fs(t,K))throw new Error(`got a number, but expected ${us(t)}`);return new mt(K,n)}case"string":{if($n(t,Me))return new mt(Me,kh(n));if($n(t,Ft))return new mt(Ft,!!n);if(!fs(t,Bt))throw new Error(`got a string, but expected ${us(t)}`);return new mt(Bt,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return nE(n,t,e);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if($n(t,cs)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new mt(cs,n)}if($n(t,Me)){if(n.length===3)return new mt(Me,[...n,1]);if(n.length===4)return new mt(Me,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!fs(t,yi))throw new Error(`got an array of numbers, but expected ${us(t)}`);return new mt(yi,n)}const b={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},K1={[b.Get]:z(B(1,1/0),Kd),[b.Var]:z(B(1,1),U1),[b.Has]:z(B(1,1/0),Kd),[b.Id]:z(V1,nr),[b.Concat]:z(B(2,1/0),tt(Bt)),[b.GeometryType]:z(Z1,nr),[b.LineMetric]:z(nr),[b.Resolution]:z(Dh,nr),[b.Zoom]:z(Dh,nr),[b.Time]:z(Dh,nr),[b.Any]:z(B(2,1/0),tt(Ft)),[b.All]:z(B(2,1/0),tt(Ft)),[b.Not]:z(B(1,1),tt(Ft)),[b.Equal]:z(B(2,2),tt(aa)),[b.NotEqual]:z(B(2,2),tt(aa)),[b.GreaterThan]:z(B(2,2),tt(K)),[b.GreaterThanOrEqualTo]:z(B(2,2),tt(K)),[b.LessThan]:z(B(2,2),tt(K)),[b.LessThanOrEqualTo]:z(B(2,2),tt(K)),[b.Multiply]:z(B(2,1/0),Ud),[b.Coalesce]:z(B(2,1/0),Ud),[b.Divide]:z(B(2,2),tt(K)),[b.Add]:z(B(2,1/0),tt(K)),[b.Subtract]:z(B(2,2),tt(K)),[b.Clamp]:z(B(3,3),tt(K)),[b.Mod]:z(B(2,2),tt(K)),[b.Pow]:z(B(2,2),tt(K)),[b.Abs]:z(B(1,1),tt(K)),[b.Floor]:z(B(1,1),tt(K)),[b.Ceil]:z(B(1,1),tt(K)),[b.Round]:z(B(1,1),tt(K)),[b.Sin]:z(B(1,1),tt(K)),[b.Cos]:z(B(1,1),tt(K)),[b.Atan]:z(B(1,2),tt(K)),[b.Sqrt]:z(B(1,1),tt(K)),[b.Match]:z(B(4,1/0),Vd,q1),[b.Between]:z(B(3,3),tt(K)),[b.Interpolate]:z(B(6,1/0),Vd,J1),[b.Case]:z(B(3,1/0),H1,Q1),[b.In]:z(B(2,2),tE),[b.Number]:z(B(1,1/0),tt(aa)),[b.String]:z(B(1,1/0),tt(aa)),[b.Array]:z(B(1,1/0),tt(K)),[b.Color]:z(B(1,4),tt(K)),[b.Band]:z(B(1,3),tt(K)),[b.Palette]:z(B(2,2),eE),[b.ToString]:z(B(1,1),tt(Ft|K|Bt|Me))};function Kd(n,t,e){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new mt(K,o);break}case"string":{r[s]=new mt(Bt,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&e.properties.add(String(o))}return r}function U1(n,t,e){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return e.variables.add(i),[new mt(Bt,i)]}function V1(n,t,e){e.featureId=!0}function Z1(n,t,e){e.geometryType=!0}function Dh(n,t,e){e.mapState=!0}function nr(n,t,e){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function B(n,t){return function(e,i,r){const s=e[0],o=e.length-1;if(n===t){if(o!==n){const a=n===1?"":"s";throw new Error(`expected ${n} argument${a} for ${s}, got ${o}`)}}else if(o<n||o>t){const a=t===1/0?`${n} or more`:`${n} to ${t}`;throw new Error(`expected ${a} arguments for ${s}, got ${o}`)}}}function Ud(n,t,e){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=bt(n[s+1],t,e);r[s]=o}return r}function tt(n){return function(t,e,i){const r=t.length-1,s=new Array(r);for(let o=0;o<r;++o){const a=bt(t[o+1],n,i);s[o]=a}return s}}function H1(n,t,e){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function Vd(n,t,e){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function q1(n,t,e){const i=n.length-1,r=Bt|K|Ft,s=bt(n[1],r,e),o=bt(n[n.length-1],t,e),a=new Array(i-2);for(let l=0;l<i-2;l+=2){try{const h=bt(n[l+2],s.type,e);a[l]=h}catch(h){throw new Error(`failed to parse argument ${l+1} of match expression: ${h.message}`)}try{const h=bt(n[l+3],o.type,e);a[l+1]=h}catch(h){throw new Error(`failed to parse argument ${l+2} of match expression: ${h.message}`)}}return[s,...a,o]}function J1(n,t,e){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const l=i[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);r=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new mt(K,r);let o;try{o=bt(n[2],K,e)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const a=new Array(n.length-3);for(let l=0;l<a.length;l+=2){try{const h=bt(n[l+3],K,e);a[l]=h}catch(h){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${h.message}`)}try{const h=bt(n[l+4],t,e);a[l+1]=h}catch(h){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${h.message}`)}}return[s,o,...a]}function Q1(n,t,e){const i=bt(n[n.length-1],t,e),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=bt(n[s+1],Ft,e);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=bt(n[s+2],i.type,e);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function tE(n,t,e){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=Bt}else r=K;const s=new Array(i.length);for(let a=0;a<s.length;a++)try{const l=bt(i[a],r,e);s[a]=l}catch(l){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${l.message}`)}return[bt(n[1],r,e),...s]}function eE(n,t,e){let i;try{i=bt(n[1],K,e)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let a;try{a=bt(r[o],Me,e)}catch(l){throw new Error(`failed to parse color at index ${o} in palette expression: ${l.message}`)}if(!(a instanceof mt))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=a}return[i,...s]}function z(...n){return function(t,e,i){const r=t[0];let s;for(let o=0;o<n.length;o++){const a=n[o](t,e,i);if(o==n.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");s=a}}return new j1(e,r,...s)}}function nE(n,t,e){const i=n[0],r=K1[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,t,e)}function Zd(n){if(!n)return"";const t=n.getType();switch(t){case"Point":case"LineString":case"Polygon":return t;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return t.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return Zd(n.getGeometries()[0]);default:return""}}function Hd(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function cn(n,t,e){const i=bt(n,t,e);return Ae(i)}function Ae(n,t){if(n instanceof mt){if(n.type===Me&&typeof n.value=="string"){const i=kh(n.value);return function(){return i}}return function(){return n.value}}const e=n.operator;switch(e){case b.Number:case b.String:case b.Coalesce:return iE(n);case b.Get:case b.Var:case b.Has:return rE(n);case b.Id:return i=>i.featureId;case b.GeometryType:return i=>i.geometryType;case b.Concat:{const i=n.args.map(r=>Ae(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case b.Resolution:return i=>i.resolution;case b.Any:case b.All:case b.Between:case b.In:case b.Not:return oE(n);case b.Equal:case b.NotEqual:case b.LessThan:case b.LessThanOrEqualTo:case b.GreaterThan:case b.GreaterThanOrEqualTo:return sE(n);case b.Multiply:case b.Divide:case b.Add:case b.Subtract:case b.Clamp:case b.Mod:case b.Pow:case b.Abs:case b.Floor:case b.Ceil:case b.Round:case b.Sin:case b.Cos:case b.Atan:case b.Sqrt:return aE(n);case b.Case:return lE(n);case b.Match:return hE(n);case b.Interpolate:return cE(n);case b.ToString:return uE(n);default:throw new Error(`Unsupported operator ${e}`)}}function iE(n,t){const e=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ae(n.args[s]);switch(e){case b.Coalesce:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case b.Number:case b.String:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a===e)return a}throw new Error(`Expected one of the values to be a ${e}`)};default:throw new Error(`Unsupported assertion operator ${e}`)}}function rE(n,t){const i=n.args[0].value;switch(n.operator){case b.Get:return r=>{const s=n.args;let o=r.properties[i];for(let a=1,l=s.length;a<l;++a){const c=s[a].value;o=o[c]}return o};case b.Var:return r=>r.variables[i];case b.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let a=1,l=s.length;a<l;++a){const c=s[a].value;if(!o||!Object.hasOwn(o,c))return!1;o=o[c]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function sE(n,t){const e=n.operator,i=Ae(n.args[0]),r=Ae(n.args[1]);switch(e){case b.Equal:return s=>i(s)===r(s);case b.NotEqual:return s=>i(s)!==r(s);case b.LessThan:return s=>i(s)<r(s);case b.LessThanOrEqualTo:return s=>i(s)<=r(s);case b.GreaterThan:return s=>i(s)>r(s);case b.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${e}`)}}function oE(n,t){const e=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ae(n.args[s]);switch(e){case b.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case b.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case b.Between:return s=>{const o=r[0](s),a=r[1](s),l=r[2](s);return o>=a&&o<=l};case b.In:return s=>{const o=r[0](s);for(let a=1;a<i;++a)if(o===r[a](s))return!0;return!1};case b.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${e}`)}}function aE(n,t){const e=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ae(n.args[s]);switch(e){case b.Multiply:return s=>{let o=1;for(let a=0;a<i;++a)o*=r[a](s);return o};case b.Divide:return s=>r[0](s)/r[1](s);case b.Add:return s=>{let o=0;for(let a=0;a<i;++a)o+=r[a](s);return o};case b.Subtract:return s=>r[0](s)-r[1](s);case b.Clamp:return s=>{const o=r[0](s),a=r[1](s);if(o<a)return a;const l=r[2](s);return o>l?l:o};case b.Mod:return s=>r[0](s)%r[1](s);case b.Pow:return s=>Math.pow(r[0](s),r[1](s));case b.Abs:return s=>Math.abs(r[0](s));case b.Floor:return s=>Math.floor(r[0](s));case b.Ceil:return s=>Math.ceil(r[0](s));case b.Round:return s=>Math.round(r[0](s));case b.Sin:return s=>Math.sin(r[0](s));case b.Cos:return s=>Math.cos(r[0](s));case b.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case b.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${e}`)}}function lE(n,t){const e=n.args.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=Ae(n.args[r]);return r=>{for(let s=0;s<e-1;s+=2)if(i[s](r))return i[s+1](r);return i[e-1](r)}}function hE(n,t){const e=n.args.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=Ae(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<e-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[e-1](r)}}function cE(n,t){const e=n.args.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=Ae(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let a,l;for(let h=2;h<e;h+=2){const c=i[h](r);let u=i[h+1](r);const f=Array.isArray(u);if(f&&(u=z1(u)),c>=o)return h===2?u:f?fE(s,o,a,l,c,u):ds(s,o,a,l,c,u);a=c,l=u}return l}}function uE(n,t){const e=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ae(n.args[s]);switch(e){case b.ToString:return s=>{const o=r[0](s);return n.args[0].type===Me?Oh(o):o.toString()};default:throw new Error(`Unsupported convert operator ${e}`)}}function ds(n,t,e,i,r,s){const o=r-e;if(o===0)return i;const a=t-e,l=n===1?a/o:(Math.pow(n,a)-1)/(Math.pow(n,o)-1);return i+l*(s-i)}function fE(n,t,e,i,r,s){if(r-e===0)return i;const a=Wd(i),l=Wd(s);let h=l[2]-a[2];h>180?h-=360:h<-180&&(h+=360);const c=[ds(n,t,e,a[0],r,l[0]),ds(n,t,e,a[1],r,l[1]),a[2]+ds(n,t,e,0,r,h),ds(n,t,e,i[3],r,s[3])];return X1(c)}const j={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function dE(n,t,e){const i=n;let r=!0,s=!1,o=!1;const a=[Mo(i,Y.LOAD,function(){o=!0,s||t()})];return i.src&&If?(s=!0,i.decode().then(function(){r&&t()}).catch(function(l){r&&(o?t():e())})):a.push(Mo(i,Y.ERROR,e)),function(){r=!1,a.forEach(at)}}function gE(n,t){return new Promise((e,i)=>{function r(){o(),e(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function _E(n,t){return t&&(n.src=t),n.src&&If?new Promise((e,i)=>n.decode().then(()=>e(n)).catch(r=>n.complete&&n.width?e(n):i(r))):gE(n)}class mE{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const i=this.cache_[e];(t++&3)===0&&!i.hasListener()&&(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}get(t,e,i){const r=Nh(t,e,i);return r in this.cache_?this.cache_[r]:null}getPattern(t,e,i){const r=Nh(t,e,i);return r in this.patternCache_?this.patternCache_[r]:null}set(t,e,i,r,s){const o=Nh(t,e,i),a=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===j.IDLE&&r.load(),r.getImageState()===j.LOADING?r.ready().then(()=>{this.patternCache_[o]=ea().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=ea().createPattern(r.getImage(1),"repeat")),a||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}}function Nh(n,t,e){const i=e?er(e):"null";return t+":"+n+":"+i}const de=new mE;let gs=null;class qd extends Io{constructor(t,e,i,r,s){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?j.IDLE:r,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===j.LOADED){gs||(gs=_t(1,1,void 0,{willReadFrequently:!0})),gs.drawImage(this.image_,0,0);try{gs.getImageData(0,0,1,1),this.tainted_=!1}catch{gs=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Y.CHANGE)}handleImageError_(){this.imageState_=j.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=j.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],i=_t(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===j.IDLE){this.image_||this.initializeImage_(),this.imageState_=j.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&_E(this.image_,this.src_).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==j.LOADED)return;const e=this.image_,i=_t(Math.ceil(e.width*t),Math.ceil(e.height*t)),r=i.canvas;i.scale(t,t),i.drawImage(e,0,0),i.globalCompositeOperation="multiply",i.fillStyle=G1(this.color_),i.fillRect(0,0,r.width/t,r.height/t),i.globalCompositeOperation="destination-in",i.drawImage(e,0,0),this.canvas_[t]=r}ready(){return this.ready_||(this.ready_=new Promise(t=>{if(this.imageState_===j.LOADED||this.imageState_===j.ERROR)t();else{const e=()=>{(this.imageState_===j.LOADED||this.imageState_===j.ERROR)&&(this.removeEventListener(Y.CHANGE,e),t())};this.addEventListener(Y.CHANGE,e)}})),this.ready_}}function Gh(n,t,e,i,r,s){let o=t===void 0?void 0:de.get(t,e,r);return o||(o=new qd(n,n&&"src"in n?n.src||void 0:t,e,i,r),de.set(t,e,r,o,s)),s&&o&&!de.getPattern(t,e,r)&&de.set(t,e,r,o,s),o}function Ye(n){return n?Array.isArray(n)?Oh(n):typeof n=="object"&&"src"in n?pE(n):n:null}function pE(n){if(!n.offset||!n.size)return de.getPattern(n.src,"anonymous",n.color);const t=n.src+":"+n.offset,e=de.getPattern(t,void 0,n.color);if(e)return e;const i=de.get(n.src,"anonymous",null);if(i.getImageState()!==j.LOADED)return null;const r=_t(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),Gh(r.canvas,t,void 0,j.LOADED,n.color,!0),de.getPattern(t,void 0,n.color)}const Jd="10px sans-serif",jt="#000",ir="round",un=[],fn=0,rr="round",_s=10,ms="#000",ps="center",la="middle",vi=[0,0,0,0],ys=1,sr=new Se;let vs=null,Qd;const $h={},yE=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function vE(n,t,e){return`${n} ${t} 16px "${e}"`}const wE=function(){let t,e;async function i(s){await e.ready;const o=await e.load(s);if(o.length===0)return!1;const a=_h(s),l=a.families[0].toLowerCase(),h=a.weight;return o.some(c=>{const u=c.family.replace(/^['"]|['"]$/g,"").toLowerCase(),f=gh[c.weight]||c.weight;return u===l&&c.style===a.style&&f==h})}async function r(){await e.ready;let s=!0;const o=sr.getProperties(),a=Object.keys(o).filter(l=>o[l]<100);for(let l=a.length-1;l>=0;--l){const h=a[l];let c=o[h];c<100&&(await i(h)?(jr($h),sr.set(h,100)):(c+=10,sr.set(h,c,!0),c<100&&(s=!1)))}t=void 0,s||(t=setTimeout(r,100))}return async function(s){e||(e=Sl?self.fonts:document.fonts);const o=_h(s);if(!o)return;const a=o.families;let l=!1;for(const h of a){if(yE.has(h))continue;const c=vE(o.style,o.weight,h);sr.get(c)===void 0&&(sr.set(c,0,!0),l=!0)}l&&(clearTimeout(t),t=setTimeout(r,100))}}(),xE=function(){let n;return function(t){let e=$h[t];if(e==null){if(Sl){const i=_h(t),r=tg(t,"Žg");e=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=t,document.body.appendChild(n),e=n.offsetHeight,document.body.removeChild(n);$h[t]=e}return e}}();function tg(n,t){return vs||(vs=_t(1,1)),n!=Qd&&(vs.font=n,Qd=vs.font),vs.measureText(t)}function eg(n,t){return tg(n,t).width}function ng(n,t,e){if(t in e)return e[t];const i=t.split(`
`).reduce((r,s)=>Math.max(r,eg(n,s)),0);return e[t]=i,i}function EE(n,t){const e=[],i=[],r=[];let s=0,o=0,a=0,l=0;for(let h=0,c=t.length;h<=c;h+=2){const u=t[h];if(u===`
`||h===c){s=Math.max(s,o),r.push(o),o=0,a+=l,l=0;continue}const f=t[h+1]||n.font,d=eg(f,u);e.push(d),o+=d;const g=xE(f);i.push(g),l=Math.max(l,g)}return{width:s,height:a,widths:e,heights:i,lineWidths:r}}function CE(n,t,e,i,r,s,o,a,l,h,c){n.save(),e!==1&&(n.globalAlpha===void 0?n.globalAlpha=u=>u.globalAlpha*=e:n.globalAlpha*=e),t&&n.transform.apply(n,t),i.contextInstructions?(n.translate(l,h),n.scale(c[0],c[1]),bE(i,n)):c[0]<0||c[1]<0?(n.translate(l,h),n.scale(c[0],c[1]),n.drawImage(i,r,s,o,a,0,0,o,a)):n.drawImage(i,r,s,o,a,l,h,o*c[0],a*c[1]),n.restore()}function bE(n,t){const e=n.contextInstructions;for(let i=0,r=e.length;i<r;i+=2)Array.isArray(e[i+1])?t[e[i]].apply(t,e[i+1]):t[e[i]]=e[i+1]}class ha{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=Wt(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new ha({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return $()}getImage(t){return $()}getHitDetectionImage(){return $()}getPixelRatio(t){return 1}getImageState(){return $()}getImageSize(){return $()}getOrigin(){return $()}getSize(){return $()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Wt(t)}listenImageChange(t){$()}load(){$()}unlistenImageChange(t){$()}ready(){return Promise.resolve()}}class ca extends ha{constructor(t){super({opacity:1,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=t.fill!==void 0?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius=t.radius,this.radius2_=t.radius2,this.angle_=t.angle!==void 0?t.angle:0,this.stroke_=t.stroke!==void 0?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?j.LOADING:j.LOADED,this.imageState_===j.LOADING&&this.ready().then(()=>this.imageState_=j.LOADED),this.render()}clone(){const t=this.getScale(),e=new ca({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-e[0]/i[0],t[1]/2+e[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){var s,o;const e=(s=this.fill_)==null?void 0:s.getKey(),i=`${t},${this.angle_},${this.radius},${this.radius2_},${this.points_},${e}`+Object.values(this.renderOptions_).join(",");let r=(o=de.get(i,null,null))==null?void 0:o.getImage(1);if(!r){const a=this.renderOptions_,l=Math.ceil(a.size*t),h=_t(l,l);this.draw_(a,h,t),r=h.canvas,de.set(i,null,null,new qd(r,void 0,null,j.LOADED,null))}return r}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,i){if(e===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return e;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const E=r;r=s,s=E}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=s*Math.sin(a),h=Math.sqrt(s*s-l*l),c=r-h,u=Math.sqrt(l*l+c*c),f=u/l;if(t==="miter"&&f<=i)return f*e;const d=e/2/f,g=e/2*(c/u),_=Math.sqrt((r+d)*(r+d)+g*g)-r;if(this.radius2_===void 0||t==="bevel")return _*2;const m=r*Math.sin(a),y=Math.sqrt(r*r-m*m),x=s-y,w=Math.sqrt(m*m+x*x)/m;if(w<=i){const E=w*e/2-s-r;return 2*Math.max(_,E)}return _*2}createRenderOptions(){let t=ir,e=rr,i=0,r=null,s=0,o,a=0;this.stroke_&&(o=Ye(this.stroke_.getColor()??ms),a=this.stroke_.getWidth()??ys,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,e=this.stroke_.getLineJoin()??rr,t=this.stroke_.getLineCap()??ir,i=this.stroke_.getMiterLimit()??_s);const l=this.calculateLineJoinSize_(e,a,i),h=Math.max(this.radius,this.radius2_||0),c=Math.ceil(2*h+l);return{strokeStyle:o,strokeWidth:a,size:c,lineCap:t,lineDash:r,lineDashOffset:s,lineJoin:e,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let r=this.fill_.getColor();r===null&&(r=jt),e.fillStyle=Ye(r),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=er(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(e=_t(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const i=this.radius;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(e*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/e;for(let a=0;a<e;a++){const l=s+a*o,h=a%2===0?i:r;t.lineTo(h*Math.cos(l),h*Math.sin(l))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=jt,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class or extends ca{constructor(t){t=t||{radius:5},super({points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:t.scale!==void 0?t.scale:1,rotation:t.rotation!==void 0?t.rotation:0,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new or({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius=t,this.render()}}class dn{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,t.color!==void 0&&this.setColor(t.color)}clone(){const t=this.getColor();return new dn({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(t!==null&&typeof t=="object"&&"src"in t){const e=Gh(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));e.ready().then(()=>{this.patternImage_=null}),e.getImageState()===j.IDLE&&e.load(),e.getImageState()===j.LOADING&&(this.patternImage_=e)}this.color_=t}getKey(){const t=this.getColor();return t?t instanceof CanvasPattern||t instanceof CanvasGradient?Z(t):typeof t=="object"&&"src"in t?t.src+":"+t.offset:er(t).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}function ig(n,t,e,i){return e!==void 0&&i!==void 0?[e/n,i/t]:e!==void 0?e/n:i!==void 0?i/t:1}class ar extends ha{constructor(t){t=t||{};const e=t.opacity!==void 0?t.opacity:1,i=t.rotation!==void 0?t.rotation:0,r=t.scale!==void 0?t.scale:1,s=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:e,rotation:i,scale:r,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:s,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null;const o=t.img!==void 0?t.img:null;let a=t.src;Q(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||Z(o)),Q(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),Q(!((t.width!==void 0||t.height!==void 0)&&t.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(t.src!==void 0?l=j.IDLE:o!==void 0&&("complete"in o?o.complete?l=o.src?j.LOADED:j.IDLE:l=j.LOADING:l=j.LOADED),this.color_=t.color!==void 0?er(t.color):null,this.iconImage_=Gh(o,a,this.crossOrigin_,l,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null,this.initialOptions_,t.width!==void 0||t.height!==void 0){let h,c;if(t.size)[h,c]=t.size;else{const u=this.getImage(1);if(u.width&&u.height)h=u.width,c=u.height;else if(u instanceof HTMLImageElement){this.initialOptions_=t;const f=()=>{if(this.unlistenImageChange(f),!this.initialOptions_)return;const d=this.iconImage_.getSize();this.setScale(ig(d[0],d[1],t.width,t.height))};this.listenImageChange(f);return}}h!==void 0&&this.setScale(ig(h,c,t.width,t.height))}}clone(){let t,e,i;return this.initialOptions_?(e=this.initialOptions_.width,i=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new ar({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=r[0]),this.anchorYUnits_=="fraction"&&(t[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+r[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){const e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=i[0]-e[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();if(this.size_)return this.size_[0]*t[0];if(this.iconImage_.getImageState()==j.LOADED)return this.iconImage_.getSize()[0]*t[0]}getHeight(){const t=this.getScaleArray();if(this.size_)return this.size_[1]*t[1];if(this.iconImage_.getImageState()==j.LOADED)return this.iconImage_.getSize()[1]*t[1]}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(Y.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(Y.CHANGE,t)}ready(){return this.iconImage_.ready()}}class gn{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new gn({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}class Kt{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=sg,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&typeof t=="object"&&(t=t.clone()),new Kt({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){typeof t=="function"?this.geometryFunction_=t:typeof t=="string"?this.geometryFunction_=function(e){return e.get(t)}:t?t!==void 0&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=sg,this.geometry_=t}setZIndex(t){this.zIndex_=t}}function RE(n){let t;if(typeof n=="function")t=n;else{let e;Array.isArray(n)?e=n:(Q(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),e=[n]),t=function(){return e}}return t}let zh=null;function rg(n,t){if(!zh){const e=new dn({color:"rgba(255,255,255,0.4)"}),i=new gn({color:"#3399CC",width:1.25});zh=[new Kt({image:new or({fill:e,stroke:i,radius:5}),fill:e,stroke:i})]}return zh}function sg(n){return n.getGeometry()}const SE="#333";let og=class p_{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.keepUpright_=t.keepUpright,this.scale_=t.scale,this.scaleArray_=Wt(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new dn({color:SE}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new p_({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setKeepUpright(t){this.keepUpright_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Wt(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}};function TE(n){return!0}function IE(n){const t=jd(),e=ME(n,t),i=Hd();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,t.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return t.geometryType&&(i.geometryType=Zd(r.getGeometry())),e(i)}}function ag(n){const t=jd(),e=n.length,i=new Array(e);for(let o=0;o<e;++o)i[o]=Xh(n[o],t);const r=Hd(),s=new Array(e);return function(o,a){if(r.properties=o.getPropertiesInternal(),r.resolution=a,t.featureId){const h=o.getId();h!==void 0?r.featureId=h:r.featureId=null}let l=0;for(let h=0;h<e;++h){const c=i[h](r);c&&(s[l]=c,l+=1)}return s.length=l,s}}function ME(n,t){const e=n.length,i=new Array(e);for(let r=0;r<e;++r){const s=n[r],o="filter"in s?cn(s.filter,Ft,t):TE;let a;if(Array.isArray(s.style)){const l=s.style.length;a=new Array(l);for(let h=0;h<l;++h)a[h]=Xh(s.style[h],t)}else a=[Xh(s.style,t)];i[r]={filter:o,styles:a}}return function(r){const s=[];let o=!1;for(let a=0;a<e;++a){const l=i[a].filter;if(l(r)&&!(n[a].else&&o)){o=!0;for(const h of i[a].styles){const c=h(r);c&&s.push(c)}}}return s}}function Xh(n,t){const e=ws(n,"",t),i=xs(n,"",t),r=AE(n,t),s=LE(n,t),o=Ut(n,"z-index",t);if(!e&&!i&&!r&&!s&&!ri(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const a=new Kt;return function(l){let h=!0;if(e){const c=e(l);c&&(h=!1),a.setFill(c)}if(i){const c=i(l);c&&(h=!1),a.setStroke(c)}if(r){const c=r(l);c&&(h=!1),a.setText(c)}if(s){const c=s(l);c&&(h=!1),a.setImage(c)}return o&&a.setZIndex(o(l)),h?null:a}}function ws(n,t,e){let i;if(t+"fill-pattern-src"in n)i=FE(n,t+"fill-",e);else{if(n[t+"fill-color"]==="none")return s=>null;i=Yh(n,t+"fill-color",e)}if(!i)return null;const r=new dn;return function(s){const o=i(s);return o===Sh?null:(r.setColor(o),r)}}function xs(n,t,e){const i=Ut(n,t+"stroke-width",e),r=Yh(n,t+"stroke-color",e);if(!i&&!r)return null;const s=_n(n,t+"stroke-line-cap",e),o=_n(n,t+"stroke-line-join",e),a=lg(n,t+"stroke-line-dash",e),l=Ut(n,t+"stroke-line-dash-offset",e),h=Ut(n,t+"stroke-miter-limit",e),c=new gn;return function(u){if(r){const f=r(u);if(f===Sh)return null;c.setColor(f)}if(i&&c.setWidth(i(u)),s){const f=s(u);if(f!=="butt"&&f!=="round"&&f!=="square")throw new Error("Expected butt, round, or square line cap");c.setLineCap(f)}if(o){const f=o(u);if(f!=="bevel"&&f!=="round"&&f!=="miter")throw new Error("Expected bevel, round, or miter line join");c.setLineJoin(f)}return a&&c.setLineDash(a(u)),l&&c.setLineDashOffset(l(u)),h&&c.setMiterLimit(h(u)),c}}function AE(n,t){const e="text-",i=_n(n,e+"value",t);if(!i)return null;const r=ws(n,e,t),s=ws(n,e+"background-",t),o=xs(n,e,t),a=xs(n,e+"background-",t),l=_n(n,e+"font",t),h=Ut(n,e+"max-angle",t),c=Ut(n,e+"offset-x",t),u=Ut(n,e+"offset-y",t),f=lr(n,e+"overflow",t),d=_n(n,e+"placement",t),g=Ut(n,e+"repeat",t),p=fa(n,e+"scale",t),_=lr(n,e+"rotate-with-view",t),m=Ut(n,e+"rotation",t),y=_n(n,e+"align",t),x=_n(n,e+"justify",t),v=_n(n,e+"baseline",t),w=lr(n,e+"keep-upright",t),E=lg(n,e+"padding",t),C=ga(n,e+"declutter-mode"),R=new og({declutterMode:C});return function(S){if(R.setText(i(S)),r&&R.setFill(r(S)),s&&R.setBackgroundFill(s(S)),o&&R.setStroke(o(S)),a&&R.setBackgroundStroke(a(S)),l&&R.setFont(l(S)),h&&R.setMaxAngle(h(S)),c&&R.setOffsetX(c(S)),u&&R.setOffsetY(u(S)),f&&R.setOverflow(f(S)),d){const I=d(S);if(I!=="point"&&I!=="line")throw new Error("Expected point or line for text-placement");R.setPlacement(I)}if(g&&R.setRepeat(g(S)),p&&R.setScale(p(S)),_&&R.setRotateWithView(_(S)),m&&R.setRotation(m(S)),y){const I=y(S);if(I!=="left"&&I!=="center"&&I!=="right"&&I!=="end"&&I!=="start")throw new Error("Expected left, right, center, start, or end for text-align");R.setTextAlign(I)}if(x){const I=x(S);if(I!=="left"&&I!=="right"&&I!=="center")throw new Error("Expected left, right, or center for text-justify");R.setJustify(I)}if(v){const I=v(S);if(I!=="bottom"&&I!=="top"&&I!=="middle"&&I!=="alphabetic"&&I!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");R.setTextBaseline(I)}return E&&R.setPadding(E(S)),w&&R.setKeepUpright(w(S)),R}}function LE(n,t){return"icon-src"in n?PE(n,t):"shape-points"in n?kE(n,t):"circle-radius"in n?OE(n,t):null}function PE(n,t){const e="icon-",i=e+"src",r=fg(n[i],i),s=ua(n,e+"anchor",t),o=fa(n,e+"scale",t),a=Ut(n,e+"opacity",t),l=ua(n,e+"displacement",t),h=Ut(n,e+"rotation",t),c=lr(n,e+"rotate-with-view",t),u=cg(n,e+"anchor-origin"),f=ug(n,e+"anchor-x-units"),d=ug(n,e+"anchor-y-units"),g=$E(n,e+"color"),p=NE(n,e+"cross-origin"),_=GE(n,e+"offset"),m=cg(n,e+"offset-origin"),y=da(n,e+"width"),x=da(n,e+"height"),v=DE(n,e+"size"),w=ga(n,e+"declutter-mode"),E=new ar({src:r,anchorOrigin:u,anchorXUnits:f,anchorYUnits:d,color:g,crossOrigin:p,offset:_,offsetOrigin:m,height:x,width:y,size:v,declutterMode:w});return function(C){return a&&E.setOpacity(a(C)),l&&E.setDisplacement(l(C)),h&&E.setRotation(h(C)),c&&E.setRotateWithView(c(C)),o&&E.setScale(o(C)),s&&E.setAnchor(s(C)),E}}function kE(n,t){const e="shape-",i=e+"points",r=e+"radius",s=Wh(n[i],i),o=Wh(n[r],r),a=ws(n,e,t),l=xs(n,e,t),h=fa(n,e+"scale",t),c=ua(n,e+"displacement",t),u=Ut(n,e+"rotation",t),f=lr(n,e+"rotate-with-view",t),d=da(n,e+"radius2"),g=da(n,e+"angle"),p=ga(n,e+"declutter-mode"),_=new ca({points:s,radius:o,radius2:d,angle:g,declutterMode:p});return function(m){return a&&_.setFill(a(m)),l&&_.setStroke(l(m)),c&&_.setDisplacement(c(m)),u&&_.setRotation(u(m)),f&&_.setRotateWithView(f(m)),h&&_.setScale(h(m)),_}}function OE(n,t){const e="circle-",i=ws(n,e,t),r=xs(n,e,t),s=Ut(n,e+"radius",t),o=fa(n,e+"scale",t),a=ua(n,e+"displacement",t),l=Ut(n,e+"rotation",t),h=lr(n,e+"rotate-with-view",t),c=ga(n,e+"declutter-mode"),u=new or({radius:5,declutterMode:c});return function(f){return s&&u.setRadius(s(f)),i&&u.setFill(i(f)),r&&u.setStroke(r(f)),a&&u.setDisplacement(a(f)),l&&u.setRotation(l(f)),h&&u.setRotateWithView(h(f)),o&&u.setScale(o(f)),u}}function Ut(n,t,e){if(!(t in n))return;const i=cn(n[t],K,e);return function(r){return Wh(i(r),t)}}function _n(n,t,e){if(!(t in n))return null;const i=cn(n[t],Bt,e);return function(r){return fg(i(r),t)}}function FE(n,t,e){const i=_n(n,t+"pattern-src",e),r=hg(n,t+"pattern-offset",e),s=hg(n,t+"pattern-size",e),o=Yh(n,t+"color",e);return function(a){return{src:i(a),offset:r&&r(a),size:s&&s(a),color:o&&o(a)}}}function lr(n,t,e){if(!(t in n))return null;const i=cn(n[t],Ft,e);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${t}`);return s}}function Yh(n,t,e){if(!(t in n))return null;const i=cn(n[t],Me,e);return function(r){return dg(i(r),t)}}function lg(n,t,e){if(!(t in n))return null;const i=cn(n[t],yi,e);return function(r){return Es(i(r),t)}}function ua(n,t,e){if(!(t in n))return null;const i=cn(n[t],yi,e);return function(r){const s=Es(i(r),t);if(s.length!==2)throw new Error(`Expected two numbers for ${t}`);return s}}function hg(n,t,e){if(!(t in n))return null;const i=cn(n[t],yi,e);return function(r){return gg(i(r),t)}}function fa(n,t,e){if(!(t in n))return null;const i=cn(n[t],yi|K,e);return function(r){return zE(i(r),t)}}function da(n,t){const e=n[t];if(e!==void 0){if(typeof e!="number")throw new Error(`Expected a number for ${t}`);return e}}function DE(n,t){const e=n[t];if(e!==void 0){if(typeof e=="number")return Wt(e);if(!Array.isArray(e))throw new Error(`Expected a number or size array for ${t}`);if(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number")throw new Error(`Expected a number or size array for ${t}`);return e}}function NE(n,t){const e=n[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);return e}}function cg(n,t){const e=n[t];if(e!==void 0){if(e!=="bottom-left"&&e!=="bottom-right"&&e!=="top-left"&&e!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return e}}function ug(n,t){const e=n[t];if(e!==void 0){if(e!=="pixels"&&e!=="fraction")throw new Error(`Expected pixels or fraction for ${t}`);return e}}function GE(n,t){const e=n[t];if(e!==void 0)return Es(e,t)}function ga(n,t){const e=n[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);if(e!=="declutter"&&e!=="obstacle"&&e!=="none")throw new Error(`Expected declutter, obstacle, or none for ${t}`);return e}}function $E(n,t){const e=n[t];if(e!==void 0)return dg(e,t)}function Es(n,t){if(!Array.isArray(n))throw new Error(`Expected an array for ${t}`);const e=n.length;for(let i=0;i<e;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${t}`);return n}function fg(n,t){if(typeof n!="string")throw new Error(`Expected a string for ${t}`);return n}function Wh(n,t){if(typeof n!="number")throw new Error(`Expected a number for ${t}`);return n}function dg(n,t){if(typeof n=="string")return n;const e=Es(n,t),i=e.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${t}`);return e}function gg(n,t){const e=Es(n,t);if(e.length!==2)throw new Error(`Expected an array of two numbers for ${t}`);return e}function zE(n,t){return typeof n=="number"?n:gg(n,t)}const _g={RENDER_ORDER:"renderOrder"};class mg extends ia{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter?String(t.declutter):void 0,this.renderBuffer_=t.renderBuffer!==void 0?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=t.updateWhileAnimating!==void 0?t.updateWhileAnimating:!1,this.updateWhileInteracting_=t.updateWhileInteracting!==void 0?t.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(_g.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t,e){const i=this.getDeclutter();i in t.declutter||(t.declutter[i]=new zd(9)),this.getRenderer().renderDeclutter(t,e)}setRenderOrder(t){this.set(_g.RENDER_ORDER,t)}setStyle(t){this.style_=t===void 0?rg:t;const e=XE(t);this.styleFunction_=t===null?void 0:RE(e),this.changed()}setDeclutter(t){this.declutter_=t?String(t):void 0,this.changed()}}function XE(n){if(n===void 0)return rg;if(!n)return null;if(typeof n=="function"||n instanceof Kt)return n;if(!Array.isArray(n))return ag([n]);if(n.length===0)return[];const t=n.length,e=n[0];if(e instanceof Kt){const r=new Array(t);for(let s=0;s<t;++s){const o=n[s];if(!(o instanceof Kt))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in e){const r=new Array(t);for(let s=0;s<t;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return IE(r)}return ag(n)}class pg extends rn{constructor(t,e,i,r){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=r}}class YE extends So{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){$()}calculateMatrices2D(t){const e=t.viewState,i=t.coordinateToPixelTransform,r=t.pixelToCoordinateTransform;ln(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),ld(r,i)}forEachFeatureAtCoordinate(t,e,i,r,s,o,a,l){let h;const c=e.viewState;function u(v,w,E,C){return s.call(o,w,v?E:null,C)}const f=c.projection,d=Xf(t.slice(),f),g=[[0,0]];if(f.canWrapX()&&r){const v=f.getExtent(),w=et(v);g.push([-w,0],[w,0])}const p=e.layerStatesArray,_=p.length,m=[],y=[];for(let v=0;v<g.length;v++)for(let w=_-1;w>=0;--w){const E=p[w],C=E.layer;if(C.hasRenderer()&&Ch(E,c)&&a.call(l,C)){const R=C.getRenderer(),S=C.getSource();if(R&&S){const I=S.getWrapX()?d:t,T=u.bind(null,E.managed);y[0]=I[0]+g[v][0],y[1]=I[1]+g[v][1],h=R.forEachFeatureAtCoordinate(y,e,i,T,m)}if(h)return h}}if(m.length===0)return;const x=1/m.length;return m.forEach((v,w)=>v.distanceSq+=w*x),m.sort((v,w)=>v.distanceSq-w.distanceSq),m.some(v=>h=v.callback(v.feature,v.layer,v.geometry)),h}hasFeatureAtCoordinate(t,e,i,r,s,o){return this.forEachFeatureAtCoordinate(t,e,i,r,Wr,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(t){$()}scheduleExpireIconCache(t){de.canExpireCache()&&t.postRenderFunctions.push(WE)}}function WE(n,t){de.expire()}class BE extends YE{constructor(t){super(t),this.fontChangeListenerKey_=V(sr,Xi.PROPERTYCHANGE,t.redrawText,t),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=ta+" ol-layers";const i=t.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const i=this.getMap();if(i.hasListener(t)){const r=new pg(t,void 0,e);i.dispatchEvent(r)}}disposeInternal(){at(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(fe.PRECOMPOSE,t);const e=t.layerStatesArray.sort((a,l)=>a.zIndex-l.zIndex);e.some(a=>a.layer instanceof mg&&a.layer.getDeclutter())&&(t.declutter={});const r=t.viewState;this.children_.length=0;const s=[];let o=null;for(let a=0,l=e.length;a<l;++a){const h=e[a];t.layerIndex=a;const c=h.layer,u=c.getSourceState();if(!Ch(h,r)||u!="ready"&&u!="undefined"){c.unrender();continue}const f=c.render(t,o);f&&(f!==o&&(this.children_.push(f),o=f),s.push(h))}this.declutter(t,s),n1(this.element_,this.children_),this.dispatchRenderEvent(fe.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}declutter(t,e){if(t.declutter){for(let i=e.length-1;i>=0;--i){const r=e[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(t,r)}e.forEach(i=>i.layer.renderDeferred(t))}}}function yg(n){if(n instanceof ia){n.setMapInternal(null);return}n instanceof Ji&&n.getLayers().forEach(yg)}function vg(n,t){if(n instanceof ia){n.setMapInternal(t);return}if(n instanceof Ji){const e=n.getLayers().getArray();for(let i=0,r=e.length;i<r;++i)vg(e[i],t)}}let jE=class extends Se{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=KE(t);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,this.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:Pw,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Ie(),this.pixelToCoordinateTransform_=Ie(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=e.controls||Ld(),this.interactions=e.interactions||Nd({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new Fw(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Tt.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Tt.VIEW,this.handleViewChanged_),this.addChangeListener(Tt.SIZE,this.handleSizeChanged_),this.addChangeListener(Tt.TARGET,this.handleTargetChanged_),this.setProperties(e.values);const i=this;t.view&&!(t.view instanceof Xe)&&t.view.then(function(r){i.setView(new Xe(r))}),this.controls.addEventListener(Xt.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(Xt.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(Xt.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(Xt.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(Xt.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(Xt.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){vg(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();e!==void 0&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(t);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:Wr,a=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,a,e,null,o,null)}getFeaturesAtPixel(t,e){const i=[];return this.forEachFeatureAtPixel(t,function(r){i.push(r)},e),i}getAllLayers(){const t=[];function e(i){i.forEach(function(r){r instanceof Ji?e(r.getLayers()):t.push(r)})}return e(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(t);e=e!==void 0?e:{};const r=e.layerFilter!==void 0?e.layerFilter:Wr,s=e.hitTolerance!==void 0?e.hitTolerance:0,o=e.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],a="changedTouches"in t?t.changedTouches[0]:t;return[(a.clientX-i.left)/s,(a.clientY-i.top)/o]}getTarget(){return this.get(Tt.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return Zl(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?wt(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return e!==void 0?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Tt.LAYERGROUP)}setLayers(t){const e=this.getLayerGroup();if(t instanceof ze){e.setLayers(t);return}const i=e.getLayers();i.clear(),i.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const r=t[e];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(t){const e=an(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?wt(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Tt.SIZE)}getView(){return this.get(Tt.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,i,r){return Dw(this.frameState_,t,e,i,r)}handleBrowserEvent(t,e){e=e||t.type;const i=new Ln(e,this,t);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,i=e.type;if(i===Tl.POINTERDOWN||i===Y.WHEEL||i===Y.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=e.target,a=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(t)||t.propagationStopped)break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let r=this.maxTilesLoading_,s=r;if(t){const o=t.viewHints;if(o[It.ANIMATING]||o[It.INTERACTING]){const a=Date.now()-t.time>8;r=a?0:8,s=a?0:2}}e.getTilesLoading()<r&&(e.reprioritize(),e.loadMoreTiles(r,s))}t&&this.renderer_&&!t.animate&&(this.renderComplete_?(this.hasListener(fe.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(fe.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Yi(sn.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Yi(sn.LOADSTART,this,t))));const i=this.postRenderFunctions_;if(t)for(let r=0,s=i.length;r<s;++r)i[r](this,t);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)at(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Y.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Y.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const t=this.getTarget(),e=typeof t=="string"?document.getElementById(t):t;if(this.targetElement_=e,!e)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new BE(this)),this.mapBrowserEventHandler_=new kw(this,this.moveTolerance_);for(const s in ut)this.mapBrowserEventHandler_.addEventListener(ut[s],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Y.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Y.WHEEL,this.boundHandleBrowserEvent_,Mf?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const s=e.getRootNode();i=s instanceof ShadowRoot?s.host:e}this.targetChangeHandlerKeys_=[V(i,Y.KEYDOWN,this.handleBrowserEvent,this),V(i,Y.KEYPRESS,this.handleBrowserEvent,this)];const r=e.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_.observe(e)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(at(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(at(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=V(t,Xi.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=V(t,Y.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(at),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new Gn("addlayer",t)),this.layerGroupPropertyListenerKeys_=[V(t,Xi.PROPERTYCHANGE,this.render,this),V(t,Y.CHANGE,this.render,this),V(t,"addlayer",this.handleLayerAdd_,this),V(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const t=this.frameState_.layerStatesArray;for(let e=0,i=t.length;e<i;++e){const r=t[e].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){yg(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(e!==void 0&&Bd(e)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:Ol(a.center,a.resolution,a.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:Z(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=Ol(a.nextCenter,a.nextResolution,l,e)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!zo(this.previousExtent_)&&!Vr(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Yi(sn.MOVESTART,this,r)),this.previousExtent_=Ur(this.previousExtent_)),this.previousExtent_&&!s.viewHints[It.ANIMATING]&&!s.viewHints[It.INTERACTING]&&!Vr(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Yi(sn.MOVEEND,this,s)),Pf(s.extent,this.previousExtent_))),this.dispatchEvent(new Yi(sn.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(sn.LOADSTART)||this.hasListener(sn.LOADEND)||this.hasListener(fe.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new Gn("removelayer",e)),this.set(Tt.LAYERGROUP,t)}setSize(t){this.set(Tt.SIZE,t)}setTarget(t){this.set(Tt.TARGET,t)}setView(t){if(!t||t instanceof Xe){this.set(Tt.VIEW,t);return}this.set(Tt.VIEW,new Xe);const e=this;t.then(function(i){e.setView(new Xe(i))})}updateSize(){const t=this.getTargetElement();let e;if(t){const r=getComputedStyle(t),s=t.offsetWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)-parseFloat(r.borderRightWidth),o=t.offsetHeight-parseFloat(r.borderTopWidth)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)-parseFloat(r.borderBottomWidth);!isNaN(s)&&!isNaN(o)&&(e=[Math.max(0,s),Math.max(0,o)],!Bd(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&Bf("No map visible because the map container's width or height are 0."))}const i=this.getSize();e&&(!i||!An(e,i))&&(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}};function KE(n){let t=null;n.keyboardEventTarget!==void 0&&(t=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const e={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Ji({layers:n.layers});e[Tt.LAYERGROUP]=i,e[Tt.TARGET]=n.target,e[Tt.VIEW]=n.view instanceof Xe?n.view:new Xe;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new ze(n.controls.slice()):(Q(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new ze(n.interactions.slice()):(Q(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new ze(n.overlays.slice()):(Q(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new ze,{controls:r,interactions:s,keyboardEventTarget:t,overlays:o,values:e}}let Bh=class y_ extends Se{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new y_(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(at(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=V(t,Y.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?UE(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function UE(n){if(typeof n=="function")return n;let t;return Array.isArray(n)?t=n:(Q(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),t=[n]),function(){return t}}function wg(n,t,e,i){const r=[];let s=ie();for(let o=0,a=e.length;o<a;++o){const l=e[o];s=Pl(n,t,l[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),t=l[l.length-1]}return r}function _a(n,t,e,i,r,s,o){let a,l;const h=(e-t)/i;if(h===1)a=t;else if(h===2)a=t,l=r;else if(h!==0){let c=n[t],u=n[t+1],f=0;const d=[0];for(let _=t+i;_<e;_+=i){const m=n[_],y=n[_+1];f+=Math.sqrt((m-c)*(m-c)+(y-u)*(y-u)),d.push(f),c=m,u=y}const g=r*f,p=bw(d,g);p<0?(l=(g-d[-p-2])/(d[-p-1]-d[-p-2]),a=t+(-p-2)*i):a=t+p*i}o=o>1?o:2,s=s||new Array(o);for(let c=0;c<o;++c)s[c]=a===void 0?NaN:l===void 0?n[a+c]:ne(n[a+c],n[a+i+c],l);return s}function jh(n,t,e,i,r,s){if(e==t)return null;let o;if(r<n[t+i-1])return s?(o=n.slice(t,t+i),o[i-1]=r,o):null;if(n[e-1]<r)return s?(o=n.slice(e-i,e),o[i-1]=r,o):null;if(r==n[t+i-1])return n.slice(t,t+i);let a=t/i,l=e/i;for(;a<l;){const f=a+l>>1;r<n[(f+1)*i-1]?l=f:a=f+1}const h=n[a*i-1];if(r==h)return n.slice((a-1)*i,(a-1)*i+i);const c=n[(a+1)*i-1],u=(r-h)/(c-h);o=[];for(let f=0;f<i-1;++f)o.push(ne(n[(a-1)*i+f],n[a*i+f],u));return o.push(r),o}function VE(n,t,e,i,r,s,o){if(o)return jh(n,t,e[e.length-1],i,r,s);let a;if(r<n[i-1])return s?(a=n.slice(0,i),a[i-1]=r,a):null;if(n[n.length-1]<r)return s?(a=n.slice(n.length-i),a[i-1]=r,a):null;for(let l=0,h=e.length;l<h;++l){const c=e[l];if(t!=c){if(r<n[t+i-1])return null;if(r<=n[c-1])return jh(n,t,c,i,r,!1);t=c}}return null}class ma extends fd{constructor(t){super(),this.geometries_=t,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(at),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const t=this.geometries_;for(let e=0,i=t.length;e<i;++e)this.changeEventsKeys_.push(V(t[e],Y.CHANGE,this.changed,this))}clone(){const t=new ma(Kh(this.geometries_));return t.applyProperties(this),t}closestPointXY(t,e,i,r){if(r<ai(this.getExtent(),t,e))return r;const s=this.geometries_;for(let o=0,a=s.length;o<a;++o)r=s[o].closestPointXY(t,e,i,r);return r}containsXY(t,e){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)if(i[r].containsXY(t,e))return!0;return!1}computeExtent(t){Ur(t);const e=this.geometries_;for(let i=0,r=e.length;i<r;++i)kf(t,e[i].getExtent());return t}getGeometries(){return Kh(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let i=0,r=e.length;i<r;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],i=this.geometries_;let r=!1;for(let s=0,o=i.length;s<o;++s){const a=i[s],l=a.getSimplifiedGeometry(t);e.push(l),l!==a&&(r=!0)}return r?new ma(e):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let i=0,r=e.length;i<r;++i)if(e[i].intersectsExtent(t))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(t,e){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].rotate(t,e);this.changed()}scale(t,e,i){i||(i=on(this.getExtent()));const r=this.geometries_;for(let s=0,o=r.length;s<o;++s)r[s].scale(t,e,i);this.changed()}setGeometries(t){this.setGeometriesArray(Kh(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let i=0,r=e.length;i<r;++i)e[i].applyTransform(t);this.changed()}translate(t,e){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function Kh(n){return n.map(t=>t.clone())}function Uh(n,t,e,i){let r=n[t],s=n[t+1],o=0;for(let a=t+i;a<e;a+=i){const l=n[a],h=n[a+1];o+=Math.sqrt((l-r)*(l-r)+(h-s)*(h-s)),r=l,s=h}return o}class wi extends fi{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendCoordinate(t){$e(this.flatCoordinates,t),this.changed()}clone(){const t=new wi(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,r){return r<ai(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Hl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Jl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,r))}forEachSegment(t){return wd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return this.layout!="XYM"&&this.layout!="XYZM"?null:(e=e!==void 0?e:!1,jh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return Dn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return _a(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return Uh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=Zo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new wi(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return Ho(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,this.getExtent())}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Vo(this.flatCoordinates,0,t,this.stride),this.changed()}}class pa extends fi{constructor(t,e,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(e!==void 0&&i)this.setFlatCoordinates(e,t),this.ends_=i;else{const r=t,s=[],o=[];for(let l=0,h=r.length;l<h;++l){const c=r[l];$e(s,c.getFlatCoordinates()),o.push(s.length)}const a=r.length===0?this.getLayout():r[0].getLayout();this.setFlatCoordinates(a,s),this.ends_=o}}appendLineString(t){$e(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new pa(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,r){return r<ai(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ql(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ql(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,r))}getCoordinateAtM(t,e,i){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(e=e!==void 0?e:!1,i=i!==void 0?i:!1,VE(this.flatCoordinates,0,this.ends_,this.stride,t,e,i))}getCoordinates(){return ts(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new wi(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,i=this.layout,r=[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o],h=new wi(t.slice(s,l),i);r.push(h),s=l}return r}getLength(){const t=this.ends_;let e=0,i=0;for(let r=0,s=t.length;r<s;++r)i+=Uh(this.flatCoordinates,e,t[r],this.stride),e=t[r];return i}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let i=0;const r=this.ends_,s=this.stride;for(let o=0,a=r.length;o<a;++o){const l=r[o],h=_a(e,i,l,s,.5);$e(t,h),i=l}return t}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=yd(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new pa(e,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(t){return $x(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Qr(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}class ya extends fi{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){$e(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new ya(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,r){if(r<ai(this.getExtent(),t,e))return r;const s=this.flatCoordinates,o=this.stride;for(let a=0,l=s.length;a<l;a+=o){const h=oi(t,e,s[a],s[a+1]);if(h<r){r=h;for(let c=0;c<o;++c)i[c]=s[a+c];i.length=o}}return r}getCoordinates(){return Dn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new Nn(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,i=this.stride,r=[];for(let s=0,o=t.length;s<o;s+=i){const a=new Nn(t.slice(s,s+i),e);r.push(a)}return r}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,i=this.stride;for(let r=0,s=e.length;r<s;r+=i){const o=e[r],a=e[r+1];if(Ml(t,o,a))return!0}return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Vo(this.flatCoordinates,0,t,this.stride),this.changed()}}class va extends fi{constructor(t,e,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){const r=t,s=[],o=[];for(let a=0,l=r.length;a<l;++a){const h=r[a],c=s.length,u=h.getEnds();for(let f=0,d=u.length;f<d;++f)u[f]+=c;$e(s,h.getFlatCoordinates()),o.push(u)}e=r.length===0?this.getLayout():r[0].getLayout(),t=s,i=o}e!==void 0&&i?(this.setFlatCoordinates(e,t),this.endss_=i):this.setCoordinates(t,e)}appendPolygon(t){let e;if(!this.flatCoordinates)this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();else{const i=this.flatCoordinates.length;$e(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let r=0,s=e.length;r<s;++r)e[r]+=i}this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let r=0;r<t;++r)e[r]=this.endss_[r].slice();const i=new va(this.flatCoordinates.slice(),this.layout,e);return i.applyProperties(this),i}closestPointXY(t,e,i,r){return r<ai(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Px(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),kx(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,r))}containsXY(t,e){return Gx(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return Lx(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),oh(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,th(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=wg(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=vd(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new ya(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Cd(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=oh(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=Dx(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new va(e,"XY",i)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(t===0)e=0;else{const s=this.endss_[t-1];e=s[s.length-1]}const i=this.endss_[t].slice(),r=i[i.length-1];if(e!==0)for(let s=0,o=i.length;s<o;++s)i[s]-=e;return new hn(this.flatCoordinates.slice(e,r),this.layout,i)}getPolygons(){const t=this.layout,e=this.flatCoordinates,i=this.endss_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const l=i[o].slice(),h=l[l.length-1];if(s!==0)for(let u=0,f=l.length;u<f;++u)l[u]-=s;const c=new hn(e.slice(s,h),t,l);r.push(c),s=h}return r}getType(){return"MultiPolygon"}intersectsExtent(t){return zx(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=pd(this.flatCoordinates,0,t,this.stride,this.endss_);if(i.length===0)this.flatCoordinates.length=0;else{const r=i[i.length-1];this.flatCoordinates.length=r.length===0?0:r[r.length-1]}this.changed()}}const xg=Ie();class re{constructor(t,e,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?Ll(this.flatCoordinates_):Pl(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=on(this.getExtent());this.flatInteriorPoints_=ih(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=Yx(this.flatCoordinates_,this.ends_),e=wg(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=vd(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=_a(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],a=_a(t,e,o,2,.5);$e(this.flatMidpoints_,a),e=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){t=ft(t);const e=t.getExtent(),i=t.getWorldExtent();if(e&&i){const r=Ot(i)/Ot(e);ln(xg,i[0],i[3],r,-r,0,0,0),Fn(this.flatCoordinates_,0,this.flatCoordinates_.length,2,xg,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){var t;return new re(this.type_,this.flatCoordinates_.slice(),(t=this.ends_)==null?void 0:t.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=bf((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=Zo(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=yd(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,i,0,r);break;case"Polygon":r=[],i.length=eh(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),i,0,r);break}return r&&(this.simplifiedGeometry_=new re(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_}),this}}re.prototype.getFlatCoordinates=re.prototype.getOrientedFlatCoordinates;class ZE{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=Bh,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let i=e.dataProjection?ft(e.dataProjection):this.readProjection(t);e.extent&&i&&i.getUnits()==="tile-pixels"&&(i=ft(i),i.setWorldExtent(e.extent)),e={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return $()}readFeature(t,e){return $()}readFeatures(t,e){return $()}readGeometry(t,e){return $()}readProjection(t){return $()}writeFeature(t,e){return $()}writeFeatures(t,e){return $()}writeGeometry(t,e){return $()}}function Vh(n,t,e){const i=e?ft(e.featureProjection):null,r=e?ft(e.dataProjection):null;let s=n;if(i&&r&&!Uo(i,r)){t&&(s=n.clone());const o=t?i:r,a=t?r:i;o.getUnits()==="tile-pixels"?s.transform(o,a):s.applyTransform(Jr(o,a))}if(t&&e&&e.decimals!==void 0){const o=Math.pow(10,e.decimals),a=function(l){for(let h=0,c=l.length;h<c;++h)l[h]=Math.round(l[h]*o)/o;return l};s===n&&(s=n.clone()),s.applyTransform(a)}return s}const HE={Point:Nn,LineString:wi,Polygon:hn,MultiPoint:ya,MultiLineString:pa,MultiPolygon:va};function qE(n,t,e){return Array.isArray(t[0])?(Cd(n,0,t,e)||(n=n.slice(),oh(n,0,t,e)),n):(sh(n,0,t,e)||(n=n.slice(),qo(n,0,t,e)),n)}function Eg(n,t){var s;const e=n.geometry;if(!e)return[];if(Array.isArray(e))return e.map(o=>Eg({...n,geometry:o})).flat();const i=e.type==="MultiPolygon"?"Polygon":e.type;if(i==="GeometryCollection"||i==="Circle")throw new Error("Unsupported geometry type: "+i);const r=e.layout.length;return Vh(new re(i,i==="Polygon"?qE(e.flatCoordinates,e.ends,r):e.flatCoordinates,(s=e.ends)==null?void 0:s.flat(),r,n.properties||{},n.id).enableSimplifyTransformed(),!1,t)}function Zh(n,t){if(!n)return null;if(Array.isArray(n)){const i=n.map(r=>Zh(r,t));return new ma(i)}const e=HE[n.type];return Vh(new e(n.flatCoordinates,n.layout||"XY",n.ends),!1,t)}class JE extends ZE{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(wa(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(wa(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return $()}readFeaturesFromObject(t,e){return $()}readGeometry(t,e){return this.readGeometryFromObject(wa(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return $()}readProjection(t){return this.readProjectionFromObject(wa(t))}readProjectionFromObject(t){return $()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return $()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return $()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return $()}}function wa(n){if(typeof n=="string"){const t=JSON.parse(n);return t||null}return n!==null?n:null}class QE extends JE{constructor(t){t=t||{},super(),this.dataProjection=ft(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=ft(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let i=null;t.type==="Feature"?i=t:i={type:"Feature",geometry:t,properties:null};const r=Hh(i.geometry);if(this.featureClass===re)return Eg({geometry:r,id:i.id,properties:i.properties},e);const s=new Bh;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&i.geometry_name&&s.setGeometryName(i.geometry_name),s.setGeometry(Zh(r,e)),"id"in i&&s.setId(i.id),i.properties&&s.setProperties(i.properties,!0),s}readFeaturesFromObject(t,e){const i=t;let r=null;if(i.type==="FeatureCollection"){const s=t;r=[];const o=s.features;for(let a=0,l=o.length;a<l;++a){const h=this.readFeatureFromObject(o[a],e);h&&r.push(h)}}else r=[this.readFeatureFromObject(t,e)];return r.flat()}readGeometryFromObject(t,e){return tC(t,e)}readProjectionFromObject(t){const e=t.crs;let i;if(e)if(e.type=="name")i=ft(e.properties.name);else if(e.type==="EPSG")i=ft("EPSG:"+e.properties.code);else throw new Error("Unknown SRS type");else i=this.dataProjection;return i}writeFeatureObject(t,e){e=this.adaptOptions(e);const i={type:"Feature",geometry:null,properties:null},r=t.getId();if(r!==void 0&&(i.id=r),!t.hasProperties())return i;const s=t.getProperties(),o=t.getGeometry();return o&&(i.geometry=qh(o,e),delete s[t.getGeometryName()]),ri(s)||(i.properties=s),i}writeFeaturesObject(t,e){e=this.adaptOptions(e);const i=[];for(let r=0,s=t.length;r<s;++r)i.push(this.writeFeatureObject(t[r],e));return{type:"FeatureCollection",features:i}}writeGeometryObject(t,e){return qh(t,this.adaptOptions(e))}}function Hh(n,t){if(!n)return null;let e;switch(n.type){case"Point":{e=nC(n);break}case"LineString":{e=iC(n);break}case"Polygon":{e=aC(n);break}case"MultiPoint":{e=sC(n);break}case"MultiLineString":{e=rC(n);break}case"MultiPolygon":{e=oC(n);break}case"GeometryCollection":{e=eC(n);break}default:throw new Error("Unsupported GeoJSON type: "+n.type)}return e}function tC(n,t){const e=Hh(n);return Zh(e,t)}function eC(n,t){return n.geometries.map(function(i){return Hh(i)})}function nC(n){const t=n.coordinates;return{type:"Point",flatCoordinates:t,layout:di(t.length)}}function iC(n){var i;const t=n.coordinates,e=t.flat();return{type:"LineString",flatCoordinates:e,ends:[e.length],layout:di(((i=t[0])==null?void 0:i.length)||2)}}function rC(n){var s,o;const t=n.coordinates,e=((o=(s=t[0])==null?void 0:s[0])==null?void 0:o.length)||2,i=[],r=Qr(i,0,t,e);return{type:"MultiLineString",flatCoordinates:i,ends:r,layout:di(e)}}function sC(n){var e;const t=n.coordinates;return{type:"MultiPoint",flatCoordinates:t.flat(),layout:di(((e=t[0])==null?void 0:e.length)||2)}}function oC(n){var s,o;const t=n.coordinates,e=[],i=((o=(s=t[0])==null?void 0:s[0])==null?void 0:o[0].length)||2,r=pd(e,0,t,i);return{type:"MultiPolygon",flatCoordinates:e,ends:r,layout:di(i)}}function aC(n){var s,o;const t=n.coordinates,e=[],i=(o=(s=t[0])==null?void 0:s[0])==null?void 0:o.length,r=Qr(e,0,t,i);return{type:"Polygon",flatCoordinates:e,ends:r,layout:di(i)}}function qh(n,t){n=Vh(n,!0,t);const e=n.getType();let i;switch(e){case"Point":{i=dC(n);break}case"LineString":{i=hC(n);break}case"Polygon":{i=gC(n,t);break}case"MultiPoint":{i=uC(n);break}case"MultiLineString":{i=cC(n);break}case"MultiPolygon":{i=fC(n,t);break}case"GeometryCollection":{i=lC(n,t);break}case"Circle":{i={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+e)}return i}function lC(n,t){return t=Object.assign({},t),delete t.featureProjection,{type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(i){return qh(i,t)})}}function hC(n,t){return{type:"LineString",coordinates:n.getCoordinates()}}function cC(n,t){return{type:"MultiLineString",coordinates:n.getCoordinates()}}function uC(n,t){return{type:"MultiPoint",coordinates:n.getCoordinates()}}function fC(n,t){let e;return t&&(e=t.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(e)}}function dC(n,t){return{type:"Point",coordinates:n.getCoordinates()}}function gC(n,t){let e;return t&&(e=t.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(e)}}class Jh extends Io{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(Y.CHANGE)}release(){this.setState(D.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==D.EMPTY){if(this.state!==D.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}}load(){$()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(!i)i=e,this.transitionStarts_[t]=i;else if(i===-1)return 1;const r=e-i+1e3/60;return r>=this.transition_?1:Yf(r/this.transition_)}inTransition(t){return this.transition_?this.transitionStarts_[t]!==-1:!1}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function Qh(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const _C=new Error("disposed"),mC=[256,256];class Cg extends Jh{constructor(t){const e=D.IDLE;super(t.tileCoord,e,{transition:t.transition,interpolate:t.interpolate}),this.loader_=t.loader,this.data_=null,this.error_=null,this.size_=t.size||null,this.controller_=t.controller||null}getSize(){if(this.size_)return this.size_;const t=Qh(this.data_);return t?[t.width,t.height]:mC}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==D.IDLE&&this.state!==D.ERROR)return;this.state=D.LOADING,this.changed();const t=this;this.loader_().then(function(e){t.data_=e,t.state=D.LOADED,t.changed()}).catch(function(e){t.error_=e,t.state=D.ERROR,t.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(_C),this.controller_=null),super.disposeInternal()}}class bg extends Jh{constructor(t,e,i,r,s,o){super(t,e,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_=new Image,r!==null&&(this.image_.crossOrigin=r),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(t){this.image_=t,this.state=D.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=D.ERROR,this.unlistenImage_(),this.image_=pC(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=D.LOADED:this.state=D.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==D.ERROR&&(this.state=D.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==D.IDLE&&(this.state=D.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=dE(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function pC(){const n=_t(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}class tc{constructor(t,e,i,r){this.minX=t,this.maxX=e,this.minY=i,this.maxY=r}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function hr(n,t,e,i,r){return r!==void 0?(r.minX=n,r.maxX=t,r.minY=e,r.maxY=i,r):new tc(n,t,e,i)}let ec;const cr=[];function Rg(n,t,e,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(t,e),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(t,i)+1,Math.max(e,r)),n.restore()}function nc(n,t){return Math.abs(n[t*4]-210)>2||Math.abs(n[t*4+3]-191.25)>2}function yC(){if(ec===void 0){const n=_t(6,6,cr);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",Rg(n,4,5,4,0),Rg(n,4,5,0,5);const t=n.getImageData(0,0,3,3).data;ec=nc(t,0)||nc(t,4)||nc(t,8),na(n),cr.push(n.canvas)}return ec}function Sg(n,t,e,i){const r=Vl(e,t,n);let s=rd(t,i,e);const o=t.getMetersPerUnit();o!==void 0&&(s*=o);const a=n.getMetersPerUnit();a!==void 0&&(s/=a);const l=n.getExtent();if(!l||Bi(l,r)){const h=rd(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function vC(n,t,e,i){const r=on(e);let s=Sg(n,t,r,i);return(!isFinite(s)||s<=0)&&Ff(e,function(o){return s=Sg(n,t,o,i),isFinite(s)&&s>0}),s}function wC(n,t,e,i,r,s,o,a,l,h,c,u,f,d){const g=_t(Math.round(e*n),Math.round(e*t),cr);if(u||(g.imageSmoothingEnabled=!1),l.length===0)return g.canvas;g.scale(e,e);function p(w){return Math.round(w*e)/e}g.globalCompositeOperation="lighter";const _=ie();l.forEach(function(w,E,C){kf(_,w.extent)});let m;const y=e/i,x=(u?1:1+Math.pow(2,-24))/y;m=_t(Math.round(et(_)*y),Math.round(Ot(_)*y),cr),u||(m.imageSmoothingEnabled=!1),l.forEach(function(w,E,C){if(w.image.width>0&&w.image.height>0){if(w.clipExtent){m.save();const L=(w.clipExtent[0]-_[0])*y,A=-(w.clipExtent[3]-_[3])*y,P=et(w.clipExtent)*y,W=Ot(w.clipExtent)*y;m.rect(u?L:Math.round(L),u?A:Math.round(A),u?P:Math.round(L+P)-Math.round(L),u?W:Math.round(A+W)-Math.round(A)),m.clip()}const R=(w.extent[0]-_[0])*y,S=-(w.extent[3]-_[3])*y,I=et(w.extent)*y,T=Ot(w.extent)*y;m.drawImage(w.image,h,h,w.image.width-2*h,w.image.height-2*h,u?R:Math.round(R),u?S:Math.round(S),u?I:Math.round(R+I)-Math.round(R),u?T:Math.round(S+T)-Math.round(S)),w.clipExtent&&m.restore()}});const v=hi(o);return a.getTriangles().forEach(function(w,E,C){const R=w.source,S=w.target;let I=R[0][0],T=R[0][1],L=R[1][0],A=R[1][1],P=R[2][0],W=R[2][1];const O=p((S[0][0]-v[0])/s),N=p(-(S[0][1]-v[1])/s),k=p((S[1][0]-v[0])/s),G=p(-(S[1][1]-v[1])/s),U=p((S[2][0]-v[0])/s),st=p(-(S[2][1]-v[1])/s),M=I,At=T;I=0,T=0,L-=M,A-=At,P-=M,W-=At;const Dt=[[L,A,0,0,k-O],[P,W,0,0,U-O],[0,0,L,A,G-N],[0,0,P,W,st-N]],gt=Gw(Dt);if(!gt)return;if(g.save(),g.beginPath(),yC()||!u){g.moveTo(k,G);const Lt=4,Be=O-k,Le=N-G;for(let oe=0;oe<Lt;oe++)g.lineTo(k+p((oe+1)*Be/Lt),G+p(oe*Le/(Lt-1))),oe!=Lt-1&&g.lineTo(k+p((oe+1)*Be/Lt),G+p((oe+1)*Le/(Lt-1)));g.lineTo(U,st)}else g.moveTo(k,G),g.lineTo(O,N),g.lineTo(U,st);g.clip(),g.transform(gt[0],gt[2],gt[1],gt[3],O,N),g.translate(_[0]-M,_[3]-At);let se;if(m)se=m.canvas,g.scale(x,-x);else{const Lt=l[0],Be=Lt.extent;se=Lt.image,g.scale(et(Be)/se.width,-Ot(Be)/se.height)}g.drawImage(se,0,0),g.restore()}),m&&(na(m),cr.push(m.canvas)),c&&(g.save(),g.globalCompositeOperation="source-over",g.strokeStyle="black",g.lineWidth=1,a.getTriangles().forEach(function(w,E,C){const R=w.target,S=(R[0][0]-v[0])/s,I=-(R[0][1]-v[1])/s,T=(R[1][0]-v[0])/s,L=-(R[1][1]-v[1])/s,A=(R[2][0]-v[0])/s,P=-(R[2][1]-v[1])/s;g.beginPath(),g.moveTo(T,L),g.lineTo(S,I),g.lineTo(A,P),g.closePath(),g.stroke()}),g.restore()),g.canvas}const xC=10,Tg=.25;class EC{constructor(t,e,i,r,s,o,a){this.sourceProj_=t,this.targetProj_=e;let l={};const h=a?wx(x=>wt(a,Vl(x,this.targetProj_,this.sourceProj_))):Jr(this.targetProj_,this.sourceProj_);this.transformInv_=function(x){const v=x[0]+"/"+x[1];return l[v]||(l[v]=h(x)),l[v]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&et(r)>=et(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?et(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?et(this.targetProj_.getExtent()):null;const c=hi(i),u=$o(i),f=Go(i),d=No(i),g=this.transformInv_(c),p=this.transformInv_(u),_=this.transformInv_(f),m=this.transformInv_(d),y=xC+(o?Math.max(0,Math.ceil(Math.log2(kl(i)/(o*o*256*256)))):0);if(this.addQuad_(c,u,f,d,g,p,_,m,y),this.wrapsXInSource_){let x=1/0;this.triangles_.forEach(function(v,w,E){x=Math.min(x,v.source[0][0],v.source[1][0],v.source[2][0])}),this.triangles_.forEach(v=>{if(Math.max(v.source[0][0],v.source[1][0],v.source[2][0])-x>this.sourceWorldWidth_/2){const w=[[v.source[0][0],v.source[0][1]],[v.source[1][0],v.source[1][1]],[v.source[2][0],v.source[2][1]]];w[0][0]-x>this.sourceWorldWidth_/2&&(w[0][0]-=this.sourceWorldWidth_),w[1][0]-x>this.sourceWorldWidth_/2&&(w[1][0]-=this.sourceWorldWidth_),w[2][0]-x>this.sourceWorldWidth_/2&&(w[2][0]-=this.sourceWorldWidth_);const E=Math.min(w[0][0],w[1][0],w[2][0]);Math.max(w[0][0],w[1][0],w[2][0])-E<this.sourceWorldWidth_/2&&(v.source=w)}})}l={}}addTriangle_(t,e,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[t,e,i]})}addQuad_(t,e,i,r,s,o,a,l,h){const c=Fo([s,o,a,l]),u=this.sourceWorldWidth_?et(c)/this.sourceWorldWidth_:null,f=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&u>.5&&u<1;let g=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const _=Fo([t,e,i,r]);g=et(_)/this.targetWorldWidth_>Tg||g}!d&&this.sourceProj_.isGlobal()&&u&&(g=u>Tg||g)}if(!g&&this.maxSourceExtent_&&isFinite(c[0])&&isFinite(c[1])&&isFinite(c[2])&&isFinite(c[3])&&!Yt(c,this.maxSourceExtent_))return;let p=0;if(!g&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(h>0)g=!0;else if(p=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),p!=1&&p!=2&&p!=4&&p!=8)return}if(h>0){if(!g){const _=[(t[0]+i[0])/2,(t[1]+i[1])/2],m=this.transformInv_(_);let y;d?y=(Wi(s[0],f)+Wi(a[0],f))/2-Wi(m[0],f):y=(s[0]+a[0])/2-m[0];const x=(s[1]+a[1])/2-m[1];g=y*y+x*x>this.errorThresholdSquared_}if(g){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const _=[(e[0]+i[0])/2,(e[1]+i[1])/2],m=this.transformInv_(_),y=[(r[0]+t[0])/2,(r[1]+t[1])/2],x=this.transformInv_(y);this.addQuad_(t,e,_,y,s,o,m,x,h-1),this.addQuad_(y,_,i,r,x,m,a,l,h-1)}else{const _=[(t[0]+e[0])/2,(t[1]+e[1])/2],m=this.transformInv_(_),y=[(i[0]+r[0])/2,(i[1]+r[1])/2],x=this.transformInv_(y);this.addQuad_(t,_,y,r,s,m,x,l,h-1),this.addQuad_(_,e,i,y,m,o,a,x,h-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(p&11)==0&&this.addTriangle_(t,i,r,s,a,l),(p&14)==0&&this.addTriangle_(t,i,e,s,a,o),p&&((p&13)==0&&this.addTriangle_(e,r,t,o,l,s),(p&7)==0&&this.addTriangle_(e,r,i,o,l,a))}calculateSourceExtent(){const t=ie();return this.triangles_.forEach(function(e,i,r){const s=e.source;Zr(t,s[0]),Zr(t,s[1]),Zr(t,s[2])}),t}getTriangles(){return this.triangles_}}const CC=.5;class Ig extends Jh{constructor(t,e,i,r,s,o,a,l,h,c,u,f){super(s,D.IDLE,f),this.renderEdges_=u!==void 0?u:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=t.canWrapX()?t.getExtent():void 0;const d=r.getTileCoordExtent(this.wrappedTileCoord_),g=this.targetTileGrid_.getExtent();let p=this.sourceTileGrid_.getExtent();const _=g?li(d,g):d;if(kl(_)===0){this.state=D.EMPTY;return}const m=t.getExtent();m&&(p?p=li(p,m):p=m);const y=r.getResolution(this.wrappedTileCoord_[0]),x=vC(t,i,_,y);if(!isFinite(x)||x<=0){this.state=D.EMPTY;return}const v=c!==void 0?c:CC;if(this.triangulation_=new EC(t,i,_,p,x*v,y),this.triangulation_.getTriangles().length===0){this.state=D.EMPTY;return}this.sourceZ_=e.getZForResolution(x);let w=this.triangulation_.calculateSourceExtent();if(p&&(t.canWrapX()?(w[1]=lt(w[1],p[1],p[3]),w[3]=lt(w[3],p[1],p[3])):w=li(w,p)),!kl(w))this.state=D.EMPTY;else{let E=0,C=0;t.canWrapX()&&(E=et(m),C=Math.floor((w[0]-m[0])/E)),Gf(w.slice(),t,!0).forEach(S=>{const I=e.getTileRangeForExtentAndZ(S,this.sourceZ_);for(let T=I.minX;T<=I.maxX;T++)for(let L=I.minY;L<=I.maxY;L++){const A=h(this.sourceZ_,T,L,a);if(A){const P=C*E;this.sourceTiles_.push({tile:A,offset:P})}}++C}),this.sourceTiles_.length===0&&(this.state=D.EMPTY)}}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(e=>{var r;const i=e.tile;if(i&&i.getState()==D.LOADED){const s=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);s[0]+=e.offset,s[2]+=e.offset;const o=(r=this.clipExtent_)==null?void 0:r.slice();o&&(o[0]+=e.offset,o[2]+=e.offset),t.push({extent:s,clipExtent:o,image:i.getImage()})}}),this.sourceTiles_.length=0,t.length===0)this.state=D.ERROR;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=wC(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=D.LOADED}this.changed()}load(){if(this.state==D.IDLE){this.state=D.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{const i=e.getState();if(i==D.IDLE||i==D.LOADING){t++;const r=V(e,Y.CHANGE,s=>{const o=e.getState();(o==D.LOADED||o==D.ERROR||o==D.EMPTY)&&(at(r),t--,t===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:e},i,r){e.getState()==D.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(at),this.sourcesListenerKeys_=null}release(){this.canvas_&&(na(this.canvas_.getContext("2d")),cr.push(this.canvas_),this.canvas_=null),super.release()}}class bC{constructor(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const t=this.pop();t instanceof So&&t.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const i=this.entries_[t];return Q(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(t){const e=this.entries_[t];return Q(e!==void 0,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e=0,i;for(i=this.newest_;i;i=i.older)t[e++]=i.key_;return t}getValues(){const t=new Array(this.count_);let e=0,i;for(i=this.newest_;i;i=i.older)t[e++]=i.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){var e;return(e=this.entries_[t])==null?void 0:e.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){Q(!(t in this.entries_),"Tried to set a value for a key that is used already");const i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_}setSize(t){this.highWaterMark=t}}function xa(n,t,e,i){return i!==void 0?(i[0]=n,i[1]=t,i[2]=e,i):[n,t,e]}function RC(n,t,e){return n+"/"+t+"/"+e}function SC(n){return TC(n[0],n[1],n[2])}function TC(n,t,e){return(t<<n)+e}function IC(n,t){const e=n[0],i=n[1],r=n[2];if(t.getMinZoom()>e||e>t.getMaxZoom())return!1;const s=t.getFullTileRange(e);return s?s.containsXY(i,r):!0}class Mg{constructor(){Vt(this,"pushMethodArgs_",(...t)=>(this.push_(t),this));this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(ea(),{get:(t,e)=>{if(typeof ea()[e]=="function")return this.push_(e),this.pushMethodArgs_},set:(t,e,i)=>(this.push_(e,i),!0)})}push_(...t){const e=this.instructions_,i=this.zIndex+this.offset_;e[i]||(e[i]=[]),e[i].push(...t)}pushFunction(t){this.push_(t)}getContext(){return this.context_}draw(t){this.instructions_.forEach(e=>{for(let i=0,r=e.length;i<r;++i){const s=e[i];if(typeof s=="function"){s(t);continue}const o=e[++i];if(typeof t[s]=="function")t[s](...o);else{if(typeof o=="function"){t[s]=o(t);continue}t[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const MC=5;class AC extends Kr{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.staleKeys_=new Array,this.maxStaleKeys=MC}getStaleKeys(){return this.staleKeys_}prependStaleKey(t){this.staleKeys_.unshift(t),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(t){return $()}getData(t){return null}prepareFrame(t){return $()}renderFrame(t,e){return $()}forEachFeatureAtCoordinate(t,e,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;(e.getState()===j.LOADED||e.getState()===j.ERROR)&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=j.LOADED&&e!=j.ERROR&&t.addEventListener(Y.CHANGE,this.boundHandleImageChange_),e==j.IDLE&&(t.load(),e=t.getState()),e==j.LOADED}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const Ag=[];let ur=null;function LC(){ur=_t(1,1,void 0,{willReadFrequently:!0})}class Lg extends AC{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=Ie(),this.pixelTransform=Ie(),this.inversePixelTransform=Ie(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(t,e,i){ur||LC(),ur.clearRect(0,0,1,1);let r;try{ur.drawImage(t,e,i,1,1,0,0,1,1),r=ur.getImageData(0,0,1,1).data}catch{return ur=null,null}return r}getBackground(t){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(t.viewState.resolution)),i||void 0}useContainer(t,e,i){const r=this.getLayer().getClassName();let s,o;if(t&&t.className===r&&(!i||t&&t.style.backgroundColor&&An(er(t.style.backgroundColor),er(i)))){const a=t.firstElementChild;a instanceof HTMLCanvasElement&&(o=a.getContext("2d"))}if(o&&Sx(o.canvas.style.transform,e)?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=document.createElement("div"),s.className=r;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=_t();const l=o.canvas;s.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){const r=hi(i),s=$o(i),o=Go(i),a=No(i);wt(e.coordinateToPixelTransform,r),wt(e.coordinateToPixelTransform,s),wt(e.coordinateToPixelTransform,o),wt(e.coordinateToPixelTransform,a);const l=this.inversePixelTransform;wt(l,r),wt(l,s),wt(l,o),wt(l,a),t.save(),t.beginPath(),t.moveTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}prepareContainer(t,e){const i=t.extent,r=t.viewState.resolution,s=t.viewState.rotation,o=t.pixelRatio,a=Math.round(et(i)/r*o),l=Math.round(Ot(i)/r*o);ln(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/o,1/o,s,-a/2,-l/2),ld(this.inversePixelTransform,this.pixelTransform);const h=Rx(this.pixelTransform);if(this.useContainer(e,h,this.getBackground(t)),!this.containerReused){const c=this.context.canvas;c.width!=a||c.height!=l?(c.width=a,c.height=l):this.context.clearRect(0,0,a,l),h!==c.style.transform&&(c.style.transform=h)}}dispatchRenderEvent_(t,e,i){const r=this.getLayer();if(r.hasListener(t)){const s=new pg(t,this.inversePixelTransform,i,e);r.dispatchEvent(s)}}preRender(t,e){this.frameState=e,!e.declutter&&this.dispatchRenderEvent_(fe.PRERENDER,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(fe.POSTRENDER,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new Mg),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(fe.PRERENDER,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(fe.POSTRENDER,this.context,t))}getRenderTransform(t,e,i,r,s,o,a){const l=s/2,h=o/2,c=r/e,u=-c,f=-t[0]+a,d=-t[1];return ln(this.tempTransform,l,h,c,u,-i,f,d)}disposeInternal(){delete this.frameState,super.disposeInternal()}}function ic(n,t,e,i,r){return`${Z(n)},${t},${RC(e,i,r)}`}function rc(n,t,e){if(!(e in n))return n[e]=new Set([t]),!0;const i=n[e],r=i.has(t);return r||i.add(t),!r}function PC(n,t,e){const i=n[e];return i?i.delete(t):!1}function Pg(n,t){const e=n.layerStatesArray[n.layerIndex];e.extent&&(t=li(t,On(e.extent,n.viewState.projection)));const i=e.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(t=li(t,r))}return t}class kC extends Lg{constructor(t,e){super(t),e=e||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=ie(),this.tempTileRange_=new tc(0,0,0,0),this.tempTileCoord_=xa(0,0,0);const i=e.cacheSize!==void 0?e.cacheSize:512;this.tileCache_=new bC(i),this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getOrCreateTile(t,e,i,r){const s=this.tileCache_,a=this.getLayer().getSource(),l=ic(a,a.getKey(),t,e,i);let h;if(s.containsKey(l))h=s.get(l);else{if(h=a.getTile(t,e,i,r.pixelRatio,r.viewState.projection),!h)return null;s.set(l,h)}return h}getTile(t,e,i,r){const s=this.getOrCreateTile(t,e,i,r);return s||null}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),r=wt(e.pixelToCoordinateTransform,t.slice()),s=i.getExtent();if(s&&!Bi(s,r))return null;const o=e.viewState,a=i.getRenderSource(),l=a.getTileGridForProjection(o.projection),h=a.getTilePixelRatio(e.pixelRatio);for(let c=l.getZForResolution(o.resolution);c>=l.getMinZoom();--c){const u=l.getTileCoordForCoordAndZ(r,c),f=this.getTile(c,u[1],u[2],e);if(!f||f.getState()!==D.LOADED)continue;const d=l.getOrigin(c),g=Wt(l.getTileSize(c)),p=l.getResolution(c);let _;if(f instanceof bg||f instanceof Ig)_=f.getImage();else if(f instanceof Cg){if(_=Qh(f.getData()),!_)continue}else continue;const m=Math.floor(h*((r[0]-d[0])/p-u[1]*g[0])),y=Math.floor(h*((d[1]-r[1])/p-u[2]*g[1])),x=Math.round(h*a.getGutterForProjection(o.projection));return this.getImageData(_,m+x,y+x)}return null}prepareFrame(t){this.renderedProjection?t.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=t.viewState.projection):this.renderedProjection=t.viewState.projection;const e=this.getLayer().getSource();if(!e)return!1;const i=e.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===e.getKey()&&this.tileCache_.clear()):this.renderedSourceRevision_=i,!0}enqueueTiles(t,e,i,r,s){const o=t.viewState,a=this.getLayer(),l=a.getRenderSource(),h=l.getTileGridForProjection(o.projection),c=Z(l);c in t.wantedTiles||(t.wantedTiles[c]={});const u=t.wantedTiles[c],f=a.getMapInternal(),d=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(a.getMaxResolution(),f?f.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):h.getResolution(0)),l.zDirection)),g=o.rotation,p=g?Df(o.center,o.resolution,g,t.size):void 0;for(let _=i;_>=d;--_){const m=h.getTileRangeForExtentAndZ(e,_,this.tempTileRange_),y=h.getResolution(_);for(let x=m.minX;x<=m.maxX;++x)for(let v=m.minY;v<=m.maxY;++v){if(g&&!h.tileCoordIntersectsViewport([_,x,v],p))continue;const w=this.getTile(_,x,v,t);if(!w||!rc(r,w,_))continue;const C=w.getKey();if(u[C]=!0,w.getState()===D.IDLE&&!t.tileQueue.isKeyQueued(C)){const R=xa(_,x,v,this.tempTileCoord_);t.tileQueue.enqueue([w,c,h.getTileCoordCenter(R),y])}}}}findStaleTile_(t,e){const i=this.tileCache_,r=t[0],s=t[1],o=t[2],a=this.getStaleKeys();for(let l=0;l<a.length;++l){const h=ic(this.getLayer().getSource(),a[l],r,s,o);if(i.containsKey(h)){const c=i.peek(h);if(c.getState()===D.LOADED)return c.endTransition(Z(this)),rc(e,c,r),!0}}return!1}findAltTiles_(t,e,i,r){const s=t.getTileRangeForTileCoordAndZ(e,i,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileCache_,l=this.getLayer().getRenderSource(),h=l.getKey();for(let c=s.minX;c<=s.maxX;++c)for(let u=s.minY;u<=s.maxY;++u){const f=ic(l,h,i,c,u);let d=!1;if(a.containsKey(f)){const g=a.peek(f);g.getState()===D.LOADED&&(rc(r,g,i),d=!0)}d||(o=!1)}return o}renderFrame(t,e){this.renderComplete=!0;const i=t.layerStatesArray[t.layerIndex],r=t.viewState,s=r.projection,o=r.resolution,a=r.center,l=t.pixelRatio,h=this.getLayer(),c=h.getSource(),u=c.getTileGridForProjection(s),f=u.getZForResolution(o,c.zDirection),d=u.getResolution(f),g=c.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==g&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=g):this.renderedSourceKey_=g;let p=t.extent;const _=c.getTilePixelRatio(l);this.prepareContainer(t,e);const m=this.context.canvas.width,y=this.context.canvas.height,x=i.extent&&On(i.extent);x&&(p=li(p,On(i.extent)));const v=d*m/2/_,w=d*y/2/_,E=[a[0]-v,a[1]-w,a[0]+v,a[1]+w],C={};this.renderedTiles.length=0;const R=h.getPreload();if(t.nextExtent){const k=u.getZForResolution(r.nextResolution,c.zDirection),G=Pg(t,t.nextExtent);this.enqueueTiles(t,G,k,C,R)}const S=Pg(t,p);if(this.enqueueTiles(t,S,f,C,0),R>0&&setTimeout(()=>{this.enqueueTiles(t,S,f-1,C,R-1)},0),!(f in C))return this.container;const I=Z(this),T=t.time;for(const k of C[f]){const G=k.getState();if(G===D.EMPTY)continue;const U=k.tileCoord;if(G===D.LOADED&&k.getAlpha(I,T)===1){k.endTransition(I);continue}if(G!==D.ERROR&&(this.renderComplete=!1),this.findStaleTile_(U,C)){PC(C,k,f),t.animate=!0;continue}if(this.findAltTiles_(u,U,f+1,C))continue;const At=u.getMinZoom();for(let Dt=f-1;Dt>=At&&!this.findAltTiles_(u,U,Dt,C);--Dt);}const L=d/o*l/_,A=this.getRenderContext(t);ln(this.tempTransform,m/2,y/2,L,L,0,-m/2,-y/2),i.extent&&this.clipUnrotated(A,t,x),c.getInterpolate()||(A.imageSmoothingEnabled=!1),this.preRender(A,t);const P=Object.keys(C).map(Number);P.sort(nn);let W;const O=[],N=[];for(let k=P.length-1;k>=0;--k){const G=P[k],U=c.getTilePixelSize(G,l,s),M=u.getResolution(G)/d,At=U[0]*M*L,Dt=U[1]*M*L,gt=u.getTileCoordForCoordAndZ(hi(E),G),se=u.getTileCoordExtent(gt),Lt=wt(this.tempTransform,[_*(se[0]-E[0])/d,_*(E[3]-se[3])/d]),Be=_*c.getGutterForProjection(s);for(const Le of C[G]){if(Le.getState()!==D.LOADED)continue;const oe=Le.tileCoord,Sa=gt[1]-oe[1],fc=Math.round(Lt[0]-(Sa-1)*At),bs=gt[2]-oe[2],Ci=Math.round(Lt[1]-(bs-1)*Dt),me=Math.round(Lt[0]-Sa*At),je=Math.round(Lt[1]-bs*Dt),gr=fc-me,_r=Ci-je,Rs=P.length===1;let bi=!1;W=[me,je,me+gr,je,me+gr,je+_r,me,je+_r];for(let mr=0,pr=O.length;mr<pr;++mr)if(!Rs&&G<N[mr]){const xt=O[mr];Yt([me,je,me+gr,je+_r],[xt[0],xt[3],xt[4],xt[7]])&&(bi||(A.save(),bi=!0),A.beginPath(),A.moveTo(W[0],W[1]),A.lineTo(W[2],W[3]),A.lineTo(W[4],W[5]),A.lineTo(W[6],W[7]),A.moveTo(xt[6],xt[7]),A.lineTo(xt[4],xt[5]),A.lineTo(xt[2],xt[3]),A.lineTo(xt[0],xt[1]),A.clip())}O.push(W),N.push(G),this.drawTile(Le,t,me,je,gr,_r,Be,Rs),bi&&A.restore(),this.renderedTiles.unshift(Le),this.updateUsedTiles(t.usedTiles,c,Le)}}if(this.renderedResolution=d,this.extentChanged=!this.renderedExtent_||!Vr(this.renderedExtent_,E),this.renderedExtent_=E,this.renderedPixelRatio=l,this.postRender(this.context,t),i.extent&&A.restore(),A.imageSmoothingEnabled=!0,this.renderComplete){const k=(G,U)=>{const st=Z(c),M=U.wantedTiles[st],At=M?Object.keys(M).length:0;this.updateCacheSize(At),this.tileCache_.expireCache()};t.postRenderFunctions.push(k)}return this.container}updateCacheSize(t){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,t*2)}drawTile(t,e,i,r,s,o,a,l){let h;if(t instanceof Cg){if(h=Qh(t.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(t);if(!h)return;const c=this.getRenderContext(e),u=Z(this),f=e.layerStatesArray[e.layerIndex],d=f.opacity*(l?t.getAlpha(u,e.time):1),g=d!==c.globalAlpha;g&&(c.save(),c.globalAlpha=d),c.drawImage(h,a,a,h.width-2*a,h.height-2*a,i,r,s,o),g&&c.restore(),d!==f.opacity?e.animate=!0:l&&t.endTransition(u)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}updateUsedTiles(t,e,i){const r=Z(e);r in t||(t[r]={}),t[r][i.getKey()]=!0}}const Ea={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class OC extends ia{constructor(t){t=t||{};const e=Object.assign({},t),i=t.cacheSize;delete t.cacheSize,delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(t.preload!==void 0?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Ea.PRELOAD)}setPreload(t){this.set(Ea.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(Ea.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(Ea.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}}class FC extends OC{constructor(t){super(t)}createRenderer(){return new kC(this,{cacheSize:this.getCacheSize()})}}class kg{drawCustom(t,e,i,r,s){}drawGeometry(t){}setStyle(t){}drawCircle(t,e,i){}drawFeature(t,e,i){}drawGeometryCollection(t,e,i){}drawLineString(t,e,i){}drawMultiLineString(t,e,i){}drawMultiPoint(t,e,i){}drawMultiPolygon(t,e,i){}drawPoint(t,e,i){}drawPolygon(t,e,i){}drawText(t,e,i){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}}const F={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Ca=[F.FILL],zn=[F.STROKE],xi=[F.BEGIN_PATH],Og=[F.CLOSE_PATH];class Cs extends kg{constructor(t,e,i,r){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return e==1?t:t.map(function(i){return i*e})}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,l=t.length;a<l;a+=e)r[0]=t[a],r[1]=t[a+1],Bi(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(t,e,i,r,s,o){const a=this.coordinates;let l=a.length;const h=this.getBufferedMaxExtent();o&&(e+=r);let c=t[e],u=t[e+1];const f=this.tmpCoordinate_;let d=!0,g,p,_;for(g=e+r;g<i;g+=r)f[0]=t[g],f[1]=t[g+1],_=Al(h,f),_!==p?(d&&(a[l++]=c,a[l++]=u,d=!1),a[l++]=f[0],a[l++]=f[1]):_===vt.INTERSECTING?(a[l++]=f[0],a[l++]=f[1],d=!1):d=!0,c=f[0],u=f[1],p=_;return(s&&d||g===e+r)&&(a[l++]=c,a[l++]=u),l}drawCustomCoordinates_(t,e,i,r,s){for(let o=0,a=i.length;o<a;++o){const l=i[o],h=this.appendFlatLineCoordinates(t,e,l,r,!1,!1);s.push(h),e=l}return e}drawCustom(t,e,i,r,s){this.beginGeometry(t,e,s);const o=t.getType(),a=t.getStride(),l=this.coordinates.length;let h,c,u,f,d;switch(o){case"MultiPolygon":h=t.getOrientedFlatCoordinates(),f=[];const g=t.getEndss();d=0;for(let p=0,_=g.length;p<_;++p){const m=[];d=this.drawCustomCoordinates_(h,d,g[p],a,m),f.push(m)}this.instructions.push([F.CUSTOM,l,f,t,i,th,s]),this.hitDetectionInstructions.push([F.CUSTOM,l,f,t,r||i,th,s]);break;case"Polygon":case"MultiLineString":u=[],h=o=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),d=this.drawCustomCoordinates_(h,0,t.getEnds(),a,u),this.instructions.push([F.CUSTOM,l,u,t,i,ts,s]),this.hitDetectionInstructions.push([F.CUSTOM,l,u,t,r||i,ts,s]);break;case"LineString":case"Circle":h=t.getFlatCoordinates(),c=this.appendFlatLineCoordinates(h,0,h.length,a,!1,!1),this.instructions.push([F.CUSTOM,l,c,t,i,Dn,s]),this.hitDetectionInstructions.push([F.CUSTOM,l,c,t,r||i,Dn,s]);break;case"MultiPoint":h=t.getFlatCoordinates(),c=this.appendFlatPointCoordinates(h,a),c>l&&(this.instructions.push([F.CUSTOM,l,c,t,i,Dn,s]),this.hitDetectionInstructions.push([F.CUSTOM,l,c,t,r||i,Dn,s]));break;case"Point":h=t.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),c=this.coordinates.length,this.instructions.push([F.CUSTOM,l,c,t,i,void 0,s]),this.hitDetectionInstructions.push([F.CUSTOM,l,c,t,r||i,void 0,s]);break}this.endGeometry(e)}beginGeometry(t,e,i){this.beginGeometryInstruction1_=[F.BEGIN_GEOMETRY,e,0,t,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[F.BEGIN_GEOMETRY,e,0,t,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;t.reverse();let e;const i=t.length;let r,s,o=-1;for(e=0;e<i;++e)r=t[e],s=r[0],s==F.END_GEOMETRY?o=e:s==F.BEGIN_GEOMETRY&&(r[2]=e,Sw(this.hitDetectionInstructions,o,e),o=-1)}fillStyleToState(t,e={}){if(t){const i=t.getColor();e.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,e.fillStyle=Ye(i||jt)}else e.fillStyle=void 0;return e}strokeStyleToState(t,e={}){if(t){const i=t.getColor();e.strokeStyle=Ye(i||ms);const r=t.getLineCap();e.lineCap=r!==void 0?r:ir;const s=t.getLineDash();e.lineDash=s?s.slice():un;const o=t.getLineDashOffset();e.lineDashOffset=o||fn;const a=t.getLineJoin();e.lineJoin=a!==void 0?a:rr;const l=t.getWidth();e.lineWidth=l!==void 0?l:ys;const h=t.getMiterLimit();e.miterLimit=h!==void 0?h:_s,e.lineWidth>this.maxLineWidth&&(this.maxLineWidth=e.lineWidth,this.bufferedMaxExtent_=null)}else e.strokeStyle=void 0,e.lineCap=void 0,e.lineDash=null,e.lineDashOffset=void 0,e.lineJoin=void 0,e.lineWidth=void 0,e.miterLimit=void 0;return e}setFillStrokeStyle(t,e){const i=this.state;this.fillStyleToState(t,i),this.strokeStyleToState(e,i)}createFill(t){const e=t.fillStyle,i=[F.SET_FILL_STYLE,e];return typeof e!="string"&&i.push(t.fillPatternScale),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[F.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,t.lineDash?this.applyPixelRatio(t.lineDash):null,t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;(typeof i!="string"||t.currentFillStyle!=i)&&(this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,r=t.lineCap,s=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,l=t.lineWidth,h=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=r||s!=t.currentLineDash&&!An(t.currentLineDash,s)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=l||t.currentMiterLimit!=h)&&(e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=r,t.currentLineDash=s,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=l,t.currentMiterLimit=h)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[F.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Pf(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;Do(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class DC extends Cs{constructor(t,e,i,r){super(t,e,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,i){if(!this.image_||this.maxExtent&&!Bi(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,i);const r=t.getFlatCoordinates(),s=t.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,s);this.instructions.push([F.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([F.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,i){if(!this.image_)return;this.beginGeometry(t,e,i);const r=t.getFlatCoordinates(),s=[];for(let l=0,h=r.length;l<h;l+=t.getStride())(!this.maxExtent||Bi(this.maxExtent,r.slice(l,l+2)))&&s.push(r[l],r[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([F.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([F.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),r=t.getSize(),s=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=t.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=r[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}class NC extends Cs{constructor(t,e,i,r){super(t,e,i,r)}drawFlatCoordinates_(t,e,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,i,r,!1,!1),a=[F.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(t,e,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([F.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,un,fn],xi);const a=t.getFlatCoordinates(),l=t.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(zn),this.endGeometry(e)}drawMultiLineString(t,e,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([F.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,un,fn],xi);const a=t.getEnds(),l=t.getFlatCoordinates(),h=t.getStride();let c=0;for(let u=0,f=a.length;u<f;++u)c=this.drawFlatCoordinates_(l,c,a[u],h);this.hitDetectionInstructions.push(zn),this.endGeometry(e)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(zn),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(zn),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(xi)}}class Fg extends Cs{constructor(t,e,i,r){super(t,e,i,r)}drawFlatCoordinatess_(t,e,i,r){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,l=i.length;this.instructions.push(xi),this.hitDetectionInstructions.push(xi);for(let h=0;h<l;++h){const c=i[h],u=this.coordinates.length,f=this.appendFlatLineCoordinates(t,e,c,r,!0,!a),d=[F.MOVE_TO_LINE_TO,u,f];this.instructions.push(d),this.hitDetectionInstructions.push(d),a&&(this.instructions.push(Og),this.hitDetectionInstructions.push(Og)),e=c}return o&&(this.instructions.push(Ca),this.hitDetectionInstructions.push(Ca)),a&&(this.instructions.push(zn),this.hitDetectionInstructions.push(zn)),e}drawCircle(t,e,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([F.SET_FILL_STYLE,jt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([F.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,un,fn]);const a=t.getFlatCoordinates(),l=t.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);const c=[F.CIRCLE,h];this.instructions.push(xi,c),this.hitDetectionInstructions.push(xi,c),r.fillStyle!==void 0&&(this.instructions.push(Ca),this.hitDetectionInstructions.push(Ca)),r.strokeStyle!==void 0&&(this.instructions.push(zn),this.hitDetectionInstructions.push(zn)),this.endGeometry(e)}drawPolygon(t,e,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([F.SET_FILL_STYLE,jt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([F.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,un,fn]);const a=t.getEnds(),l=t.getOrientedFlatCoordinates(),h=t.getStride();this.drawFlatCoordinatess_(l,0,a,h),this.endGeometry(e)}drawMultiPolygon(t,e,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([F.SET_FILL_STYLE,jt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([F.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,un,fn]);const a=t.getEndss(),l=t.getOrientedFlatCoordinates(),h=t.getStride();let c=0;for(let u=0,f=a.length;u<f;++u)c=this.drawFlatCoordinatess_(l,c,a[u],h);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const e=this.coordinates;for(let i=0,r=e.length;i<r;++i)e[i]=gi(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;this.updateFillStyle(t,this.createFill),this.updateStrokeStyle(t,this.applyStroke)}}function GC(n,t,e,i,r){const s=[];let o=e,a=0,l=t.slice(e,2);for(;a<n&&o+r<i;){const[h,c]=l.slice(-2),u=t[o+r],f=t[o+r+1],d=Math.sqrt((u-h)*(u-h)+(f-c)*(f-c));if(a+=d,a>=n){const g=(n-a+d)/d,p=ne(h,u,g),_=ne(c,f,g);l.push(p,_),s.push(l),l=[p,_],a==n&&(o+=r),a=0}else if(a<n)l.push(t[o+r],t[o+r+1]),o+=r;else{const g=d-a,p=ne(h,u,g/d),_=ne(c,f,g/d);l.push(p,_),s.push(l),l=[p,_],a=0,o+=r}}return a>0&&s.push(l),s}function $C(n,t,e,i,r){let s=e,o=e,a=0,l=0,h=e,c,u,f,d,g,p,_,m,y,x;for(u=e;u<i;u+=r){const v=t[u],w=t[u+1];g!==void 0&&(y=v-g,x=w-p,d=Math.sqrt(y*y+x*x),_!==void 0&&(l+=f,c=Math.acos((_*y+m*x)/(f*d)),c>n&&(l>a&&(a=l,s=h,o=u),l=0,h=u-r)),f=d,_=y,m=x),g=v,p=w}return l+=d,l>a?[h,u]:[s,o]}const ba={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class zC extends Cs{constructor(t,e,i,r){super(t,e,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[jt]={fillStyle:jt},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const a=this.coordinates;let l=a.length;const h=t.getType();let c=null,u=t.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!Yt(this.maxExtent,t.getExtent()))return;let f;if(c=t.getFlatCoordinates(),h=="LineString")f=[c.length];else if(h=="MultiLineString")f=t.getEnds();else if(h=="Polygon")f=t.getEnds().slice(0,1);else if(h=="MultiPolygon"){const _=t.getEndss();f=[];for(let m=0,y=_.length;m<y;++m)f.push(_[m][0])}this.beginGeometry(t,e,i);const d=o.repeat,g=d?void 0:o.textAlign;let p=0;for(let _=0,m=f.length;_<m;++_){let y;d?y=GC(d*this.resolution,c,p,f[_],u):y=[c.slice(p,f[_])];for(let x=0,v=y.length;x<v;++x){const w=y[x];let E=0,C=w.length;if(g==null){const S=$C(o.maxAngle,w,0,w.length,2);E=S[0],C=S[1]}for(let S=E;S<C;S+=u)a.push(w[S],w[S+1]);const R=a.length;p=f[_],this.drawChars_(l,R),l=R}}this.endGeometry(e)}else{let f=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":c=t.getFlatCoordinates();break;case"LineString":c=t.getFlatMidpoint();break;case"Circle":c=t.getCenter();break;case"MultiLineString":c=t.getFlatMidpoints(),u=2;break;case"Polygon":c=t.getFlatInteriorPoint(),o.overflow||f.push(c[2]/this.resolution),u=3;break;case"MultiPolygon":const v=t.getFlatInteriorPoints();c=[];for(let w=0,E=v.length;w<E;w+=3)o.overflow||f.push(v[w+2]/this.resolution),c.push(v[w],v[w+1]);if(c.length===0)return;u=2;break}const d=this.appendFlatPointCoordinates(c,u);if(d===l)return;if(f&&(d-l)/2!==c.length/u){let v=l/2;f=f.filter((w,E)=>{const C=a[(v+E)*2]===c[E*u]&&a[(v+E)*2+1]===c[E*u+1];return C||--v,C})}this.saveTextStates_();const g=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,p=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(t,e,i);let _=o.padding;if(_!=vi&&(o.scale[0]<0||o.scale[1]<0)){let v=o.padding[0],w=o.padding[1],E=o.padding[2],C=o.padding[3];o.scale[0]<0&&(w=-w,C=-C),o.scale[1]<0&&(v=-v,E=-E),_=[v,w,E,C]}const m=this.pixelRatio;this.instructions.push([F.DRAW_IMAGE,l,d,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,_==vi?vi:_.map(function(v){return v*m}),g,p,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,f]);const y=1/m,x=g?g.slice(0):null;x&&(x[1]=jt),this.hitDetectionInstructions.push([F.DRAW_IMAGE,l,d,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[y,y],NaN,this.declutterMode_,this.declutterImageWithText_,_,x,p,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?jt:this.fillKey_,this.textOffsetX_,this.textOffsetY_,f]),this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,r=this.strokeKey_;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:e.font,textAlign:e.textAlign||ps,justify:e.justify,textBaseline:e.textBaseline||la,scale:e.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,h=ba[r.textBaseline],c=this.textOffsetY_*l,u=this.text_,f=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([F.DRAW_CHARS,t,e,h,r.overflow,a,r.maxAngle,l,c,s,f*l,u,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([F.DRAW_CHARS,t,e,h,r.overflow,a&&jt,r.maxAngle,l,c,s,f*l,u,o,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(t,e){let i,r,s;if(!t)this.text_="";else{const o=t.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Ye(o.getColor()||jt)):(r=null,this.textFillState_=r);const a=t.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const p=a.getLineDash(),_=a.getLineDashOffset(),m=a.getWidth(),y=a.getMiterLimit();s.lineCap=a.getLineCap()||ir,s.lineDash=p?p.slice():un,s.lineDashOffset=_===void 0?fn:_,s.lineJoin=a.getLineJoin()||rr,s.lineWidth=m===void 0?ys:m,s.miterLimit=y===void 0?_s:y,s.strokeStyle=Ye(a.getColor()||ms)}i=this.textState_;const l=t.getFont()||Jd;wE(l);const h=t.getScaleArray();i.overflow=t.getOverflow(),i.font=l,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||la,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||vi,i.scale=h===void 0?[1,1]:h;const c=t.getOffsetX(),u=t.getOffsetY(),f=t.getRotateWithView(),d=t.getKeepUpright(),g=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=c===void 0?0:c,this.textOffsetY_=u===void 0?0:u,this.textRotateWithView_=f===void 0?!1:f,this.textKeepUpright_=d===void 0?!0:d,this.textRotation_=g===void 0?0:g,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:Z(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+Z(r.fillStyle):""}this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}const XC={Circle:Fg,Default:Cs,Image:DC,LineString:NC,Polygon:Fg,Text:zC};class YC{constructor(t,e,i,r){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const r in i){const s=i[r].finish();t[e][r]=s}}return t}getBuilder(t,e){const i=t!==void 0?t.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[e];if(s===void 0){const o=XC[e];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[e]=s}return s}}function WC(n,t,e,i,r,s,o,a,l,h,c,u,f=!0){let d=n[t],g=n[t+1],p=0,_=0,m=0,y=0;function x(){p=d,_=g,t+=i,d=n[t],g=n[t+1],y+=m,m=Math.sqrt((d-p)*(d-p)+(g-_)*(g-_))}do x();while(t<e-i&&y+m<s);let v=m===0?0:(s-y)/m;const w=ne(p,d,v),E=ne(_,g,v),C=t-i,R=y,S=s+a*l(h,r,c);for(;t<e-i&&y+m<S;)x();v=m===0?0:(S-y)/m;const I=ne(p,d,v),T=ne(_,g,v);let L=!1;if(f)if(u){const N=[w,E,I,T];cd(N,0,4,2,u,N,N),L=N[0]>N[2]}else L=w>I;const A=Math.PI,P=[],W=C+i===t;t=C,m=0,y=R,d=n[t],g=n[t+1];let O;if(W){x(),O=Math.atan2(g-_,d-p),L&&(O+=O>0?-A:A);const N=(I+w)/2,k=(T+E)/2;return P[0]=[N,k,(S-s)/2,O,r],P}r=r.replace(/\n/g," ");for(let N=0,k=r.length;N<k;){x();let G=Math.atan2(g-_,d-p);if(L&&(G+=G>0?-A:A),O!==void 0){let gt=G-O;if(gt+=gt>A?-2*A:gt<-A?2*A:0,Math.abs(gt)>o)return null}O=G;const U=N;let st=0;for(;N<k;++N){const gt=L?k-N-1:N,se=a*l(h,r[gt],c);if(t+i<e&&y+m<s+st+se/2)break;st+=se}if(N===U)continue;const M=L?r.substring(k-U,k-N):r.substring(U,N);v=m===0?0:(s+st/2-y)/m;const At=ne(p,d,v),Dt=ne(_,g,v);P.push([At,Dt,st/2,G,M]),s+=st}return P}const fr=ie(),Xn=[],mn=[],pn=[],Yn=[];function Dg(n){return n[3].declutterBox}const Ng=new RegExp("[֑-ࣿיִ-﷿ﹰ-ﻼࠀ-࿿-]");function sc(n,t){return t==="start"?t=Ng.test(n)?"right":"left":t==="end"&&(t=Ng.test(n)?"left":"right"),ba[t]}function BC(n,t,e){return e>0&&n.push(`
`,""),n.push(t,""),n}function jC(n,t,e){return e%2===0&&(n+=t),n}class KC{constructor(t,e,i,r,s){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Ie(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new Mg:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,i,r){const s=t+e+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,a=i?this.fillStates[i]:null,l=this.textStates[e],h=this.pixelRatio,c=[l.scale[0]*h,l.scale[1]*h],u=l.justify?ba[l.justify]:sc(Array.isArray(t)?t[0]:t,l.textAlign||ps),f=r&&o.lineWidth?o.lineWidth:0,d=Array.isArray(t)?t:String(t).split(`
`).reduce(BC,[]),{width:g,height:p,widths:_,heights:m,lineWidths:y}=EE(l,d),x=g+f,v=[],w=(x+2)*c[0],E=(p+f)*c[1],C={width:w<0?Math.floor(w):Math.ceil(w),height:E<0?Math.floor(E):Math.ceil(E),contextInstructions:v};(c[0]!=1||c[1]!=1)&&v.push("scale",c),r&&(v.push("strokeStyle",o.strokeStyle),v.push("lineWidth",f),v.push("lineCap",o.lineCap),v.push("lineJoin",o.lineJoin),v.push("miterLimit",o.miterLimit),v.push("setLineDash",[o.lineDash]),v.push("lineDashOffset",o.lineDashOffset)),i&&v.push("fillStyle",a.fillStyle),v.push("textBaseline","middle"),v.push("textAlign","center");const R=.5-u;let S=u*x+R*f;const I=[],T=[];let L=0,A=0,P=0,W=0,O;for(let N=0,k=d.length;N<k;N+=2){const G=d[N];if(G===`
`){A+=L,L=0,S=u*x+R*f,++W;continue}const U=d[N+1]||l.font;U!==O&&(r&&I.push("font",U),i&&T.push("font",U),O=U),L=Math.max(L,m[P]);const st=[G,S+R*_[P]+u*(_[P]-y[W]),.5*(f+L)+A];S+=_[P],r&&I.push("strokeText",st),i&&T.push("fillText",st),++P}return Array.prototype.push.apply(v,I),Array.prototype.push.apply(v,T),this.labels_[s]=C,C}replayTextBackground_(t,e,i,r,s,o,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,r),t.lineTo.apply(t,s),t.lineTo.apply(t,e),o&&(this.alignAndScaleFill_=o[2],t.fillStyle=o[1],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,r,s,o,a,l,h,c,u,f,d,g,p,_){a*=f[0],l*=f[1];let m=i-a,y=r-l;const x=s+h>t?t-h:s,v=o+c>e?e-c:o,w=g[3]+x*f[0]+g[1],E=g[0]+v*f[1]+g[2],C=m-g[3],R=y-g[0];(p||u!==0)&&(Xn[0]=C,Yn[0]=C,Xn[1]=R,mn[1]=R,mn[0]=C+w,pn[0]=mn[0],pn[1]=R+E,Yn[1]=pn[1]);let S;return u!==0?(S=ln(Ie(),i,r,1,1,u,-i,-r),wt(S,Xn),wt(S,mn),wt(S,pn),wt(S,Yn),kn(Math.min(Xn[0],mn[0],pn[0],Yn[0]),Math.min(Xn[1],mn[1],pn[1],Yn[1]),Math.max(Xn[0],mn[0],pn[0],Yn[0]),Math.max(Xn[1],mn[1],pn[1],Yn[1]),fr)):kn(Math.min(C,C+w),Math.min(R,R+E),Math.max(C,C+w),Math.max(R,R+E),fr),d&&(m=Math.round(m),y=Math.round(y)),{drawImageX:m,drawImageY:y,drawImageW:x,drawImageH:v,originX:h,originY:c,declutterBox:{minX:fr[0],minY:fr[1],maxX:fr[2],maxY:fr[3],value:_},canvasTransform:S,scale:f}}replayImageOrLabel_(t,e,i,r,s,o,a){const l=!!(o||a),h=r.declutterBox,c=a?a[2]*r.scale[0]/2:0;return h.minX-c<=e[0]&&h.maxX+c>=0&&h.minY-c<=e[1]&&h.maxY+c>=0&&(l&&this.replayTextBackground_(t,Xn,mn,pn,Yn,o,a),CE(t,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(t){const e=this.alignAndScaleFill_;if(e){const i=wt(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;t.save(),t.translate(i[0]%r,i[1]%r),e!==1&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],e[1]&&(t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6]))}drawLabelWithPointPlacement_(t,e,i,r){const s=this.textStates[e],o=this.createLabel(t,e,r,i),a=this.strokeStates[i],l=this.pixelRatio,h=sc(Array.isArray(t)?t[0]:t,s.textAlign||ps),c=ba[s.textBaseline||la],u=a&&a.lineWidth?a.lineWidth:0,f=o.width/l-2*s.scale[0],d=h*f+2*(.5-h)*u,g=c*o.height/l+2*(.5-c)*u;return{label:o,anchorX:d,anchorY:g}}execute_(t,e,i,r,s,o,a,l){const h=this.zIndexContext_;let c;this.pixelCoordinates_&&An(i,this.renderedTransform_)?c=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),c=Fn(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),Ex(this.renderedTransform_,i));let u=0;const f=r.length;let d=0,g,p,_,m,y,x,v,w,E,C,R,S,I,T=0,L=0;const A=this.coordinateCache_,P=this.viewRotation_,W=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,O={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:P},N=this.instructions!=r||this.overlaps?0:200;let k,G,U,st;for(;u<f;){const M=r[u];switch(M[0]){case F.BEGIN_GEOMETRY:k=M[1],st=M[3],k.getGeometry()?a!==void 0&&!Yt(a,st.getExtent())?u=M[2]+1:++u:u=M[2],h&&(h.zIndex=M[4]);break;case F.BEGIN_PATH:T>N&&(this.fill_(t),T=0),L>N&&(t.stroke(),L=0),!T&&!L&&(t.beginPath(),y=NaN,x=NaN),++u;break;case F.CIRCLE:d=M[1];const Dt=c[d],gt=c[d+1],se=c[d+2],Lt=c[d+3],Be=se-Dt,Le=Lt-gt,oe=Math.sqrt(Be*Be+Le*Le);t.moveTo(Dt+oe,gt),t.arc(Dt,gt,oe,0,2*Math.PI,!0),++u;break;case F.CLOSE_PATH:t.closePath(),++u;break;case F.CUSTOM:d=M[1],g=M[2];const Sa=M[3],fc=M[4],bs=M[5];O.geometry=Sa,O.feature=k,u in A||(A[u]=[]);const Ci=A[u];bs?bs(c,d,g,2,Ci):(Ci[0]=c[d],Ci[1]=c[d+1],Ci.length=2),h&&(h.zIndex=M[6]),fc(Ci,O),++u;break;case F.DRAW_IMAGE:d=M[1],g=M[2],E=M[3],p=M[4],_=M[5];let me=M[6];const je=M[7],gr=M[8],_r=M[9],Rs=M[10];let bi=M[11];const mr=M[12];let pr=M[13];m=M[14]||"declutter";const xt=M[15];if(!E&&M.length>=20){C=M[19],R=M[20],S=M[21],I=M[22];const pe=this.drawLabelWithPointPlacement_(C,R,S,I);E=pe.label,M[3]=E;const Ri=M[23];p=(pe.anchorX-Ri)*this.pixelRatio,M[4]=p;const ye=M[24];_=(pe.anchorY-ye)*this.pixelRatio,M[5]=_,me=E.height,M[6]=me,pr=E.width,M[13]=pr}let dc;M.length>25&&(dc=M[25]);let gc,Ta,Ia;M.length>17?(gc=M[16],Ta=M[17],Ia=M[18]):(gc=vi,Ta=null,Ia=null),Rs&&W?bi+=P:!Rs&&!W&&(bi-=P);let _R=0;for(;d<g;d+=2){if(dc&&dc[_R++]<pr/this.pixelRatio)continue;const pe=this.calculateImageOrLabelDimensions_(E.width,E.height,c[d],c[d+1],pr,me,p,_,gr,_r,bi,mr,s,gc,!!Ta||!!Ia,k),Ri=[t,e,E,pe,je,Ta,Ia];if(l){let ye,Ke,ve;if(xt){const dt=g-d;if(!xt[dt]){xt[dt]={args:Ri,declutterMode:m};continue}const Nt=xt[dt];ye=Nt.args,Ke=Nt.declutterMode,delete xt[dt],ve=Dg(ye)}let vn,wn;if(ye&&(Ke!=="declutter"||!l.collides(ve))&&(vn=!0),(m!=="declutter"||!l.collides(pe.declutterBox))&&(wn=!0),Ke==="declutter"&&m==="declutter"){const dt=vn&&wn;vn=dt,wn=dt}vn&&(Ke!=="none"&&l.insert(ve),this.replayImageOrLabel_.apply(this,ye)),wn&&(m!=="none"&&l.insert(pe.declutterBox),this.replayImageOrLabel_.apply(this,Ri))}else this.replayImageOrLabel_.apply(this,Ri)}++u;break;case F.DRAW_CHARS:const l_=M[1],h_=M[2],_c=M[3],mR=M[4];I=M[5];const pR=M[6],c_=M[7],u_=M[8];S=M[9];const mc=M[10];C=M[11],Array.isArray(C)&&(C=C.reduce(jC,"")),R=M[12];const f_=[M[13],M[13]];m=M[14]||"declutter";const yR=M[15],pc=this.textStates[R],Ss=pc.font,Ts=[pc.scale[0]*c_,pc.scale[1]*c_];let Is;Ss in this.widths_?Is=this.widths_[Ss]:(Is={},this.widths_[Ss]=Is);const d_=Uh(c,l_,h_,2),g_=Math.abs(Ts[0])*ng(Ss,C,Is);if(mR||g_<=d_){const pe=this.textStates[R].textAlign,Ri=(d_-g_)*sc(C,pe),ye=WC(c,l_,h_,2,C,Ri,pR,Math.abs(Ts[0]),ng,Ss,Is,W?0:this.viewRotation_,yR);t:if(ye){const Ke=[];let ve,vn,wn,dt,Nt;if(S)for(ve=0,vn=ye.length;ve<vn;++ve){Nt=ye[ve],wn=Nt[4],dt=this.createLabel(wn,R,"",S),p=Nt[2]+(Ts[0]<0?-mc:mc),_=_c*dt.height+(.5-_c)*2*mc*Ts[1]/Ts[0]-u_;const xn=this.calculateImageOrLabelDimensions_(dt.width,dt.height,Nt[0],Nt[1],dt.width,dt.height,p,_,0,0,Nt[3],f_,!1,vi,!1,k);if(l&&m==="declutter"&&l.collides(xn.declutterBox))break t;Ke.push([t,e,dt,xn,1,null,null])}if(I)for(ve=0,vn=ye.length;ve<vn;++ve){Nt=ye[ve],wn=Nt[4],dt=this.createLabel(wn,R,I,""),p=Nt[2],_=_c*dt.height-u_;const xn=this.calculateImageOrLabelDimensions_(dt.width,dt.height,Nt[0],Nt[1],dt.width,dt.height,p,_,0,0,Nt[3],f_,!1,vi,!1,k);if(l&&m==="declutter"&&l.collides(xn.declutterBox))break t;Ke.push([t,e,dt,xn,1,null,null])}l&&m!=="none"&&l.load(Ke.map(Dg));for(let xn=0,vR=Ke.length;xn<vR;++xn)this.replayImageOrLabel_.apply(this,Ke[xn])}}++u;break;case F.END_GEOMETRY:if(o!==void 0){k=M[1];const pe=o(k,st,m);if(pe)return pe}++u;break;case F.FILL:N?T++:this.fill_(t),++u;break;case F.MOVE_TO_LINE_TO:for(d=M[1],g=M[2],G=c[d],U=c[d+1],t.moveTo(G,U),y=G+.5|0,x=U+.5|0,d+=2;d<g;d+=2)G=c[d],U=c[d+1],v=G+.5|0,w=U+.5|0,(d==g-2||v!==y||w!==x)&&(t.lineTo(G,U),y=v,x=w);++u;break;case F.SET_FILL_STYLE:this.alignAndScaleFill_=M[2],T&&(this.fill_(t),T=0,L&&(t.stroke(),L=0)),t.fillStyle=M[1],++u;break;case F.SET_STROKE_STYLE:L&&(t.stroke(),L=0),this.setStrokeStyle_(t,M),++u;break;case F.STROKE:N?L++:t.stroke(),++u;break;default:++u;break}}T&&this.fill_(t),L&&t.stroke()}execute(t,e,i,r,s,o){this.viewRotation_=r,this.execute_(t,e,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(t,e,i,r,s){return this.viewRotation_=i,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,r,s)}}const Ei=["Polygon","Circle","LineString","Image","Text","Default"],Gg=["Image","Text"],UC=Ei.filter(n=>!Gg.includes(n));class VC{constructor(t,e,i,r,s,o,a){this.maxExtent_=t,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Ie(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t,e){for(const i in t){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=t[i];for(const o in s){const a=s[o];r[o]=new KC(this.resolution_,this.pixelRatio_,this.overlaps_,a,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let r=0,s=t.length;r<s;++r)if(t[r]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,r,s,o){r=Math.round(r);const a=r*2+1,l=ln(this.hitDetectionTransform_,r+.5,r+.5,1/e,-1/e,-i,-t[0],-t[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=_t(a,a));const c=this.hitDetectionContext_;c.canvas.width!==a||c.canvas.height!==a?(c.canvas.width=a,c.canvas.height=a):h||c.clearRect(0,0,a,a);let u;this.renderBuffer_!==void 0&&(u=ie(),Zr(u,t),Do(u,e*(this.renderBuffer_+r),u));const f=ZC(r);let d;function g(w,E,C){const R=c.getImageData(0,0,a,a).data;for(let S=0,I=f.length;S<I;S++)if(R[f[S]]>0){if(!o||C==="none"||d!=="Image"&&d!=="Text"||o.includes(w)){const T=(f[S]-3)/4,L=r-T%a,A=r-(T/a|0),P=s(w,E,L*L+A*A);if(P)return P}c.clearRect(0,0,a,a);break}}const p=Object.keys(this.executorsByZIndex_).map(Number);p.sort(nn);let _,m,y,x,v;for(_=p.length-1;_>=0;--_){const w=p[_].toString();for(y=this.executorsByZIndex_[w],m=Ei.length-1;m>=0;--m)if(d=Ei[m],x=y[d],x!==void 0&&(v=x.executeHitDetection(c,l,i,g,u),v))return v}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],r=e[1],s=e[2],o=e[3],a=[i,r,i,o,s,o,s,r];return Fn(a,0,8,2,t,a),a}isEmpty(){return ri(this.executorsByZIndex_)}execute(t,e,i,r,s,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(a?Rw:nn),o=o||Ei;const h=Ei.length;for(let c=0,u=l.length;c<u;++c){const f=l[c].toString(),d=this.executorsByZIndex_[f];for(let g=0,p=o.length;g<p;++g){const _=o[g],m=d[_];if(m!==void 0){const y=a===null?void 0:m.getZIndexContext(),x=y?y.getContext():t,v=this.maxExtent_&&_!=="Image"&&_!=="Text";if(v&&(x.save(),this.clip(x,i)),!y||_==="Text"||_==="Image"?m.execute(x,e,i,r,s,a):y.pushFunction(w=>m.execute(w,e,i,r,s,a)),v&&x.restore(),y){y.offset();const w=l[c]*h+Ei.indexOf(_);this.deferredZIndexContexts_[w]||(this.deferredZIndexContexts_[w]=[]),this.deferredZIndexContexts_[w].push(y)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const t=this.deferredZIndexContexts_,e=Object.keys(t).map(Number).sort(nn);for(let i=0,r=e.length;i<r;++i)t[e[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),t[e[i]].length=0}}const oc={};function ZC(n){if(oc[n]!==void 0)return oc[n];const t=n*2+1,e=n*n,i=new Array(e+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const a=s*s+o*o;if(a>e)break;let l=i[a];l||(l=[],i[a]=l),l.push(((n+s)*t+(n+o))*4+3),s>0&&l.push(((n-s)*t+(n+o))*4+3),o>0&&(l.push(((n+s)*t+(n-o))*4+3),s>0&&l.push(((n-s)*t+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return oc[n]=r,r}class HC extends kg{constructor(t,e,i,r,s,o,a){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=r,this.transformRotation_=r?Po(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Ie()}drawImages_(t,e,i,r){if(!this.image_)return;const s=Fn(t,e,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let c=0,u=s.length;c<u;c+=2){const f=s[c]-this.imageAnchorX_,d=s[c+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const g=f+this.imageAnchorX_,p=d+this.imageAnchorY_;ln(a,g,p,1,1,h,-g,-p),o.save(),o.transform.apply(o,a),o.translate(g,p),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,f,d,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(t,e,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Fn(t,e,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);e<i;e+=r){const l=s[e]+this.textOffsetX_,h=s[e+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,h-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,h),this.textFillState_&&o.fillText(this.text_,l,h))}}moveToLineTo_(t,e,i,r,s){const o=this.context_,a=Fn(t,e,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;s&&(l-=2);for(let h=2;h<l;h+=2)o.lineTo(a[h],a[h+1]);return s&&o.closePath(),i}drawRings_(t,e,i,r){for(let s=0,o=i.length;s<o;++s)e=this.moveToLineTo_(t,e,i[s],r,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Yt(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=Ax(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],r=e[3]-e[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(e[0],e[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let i=0,r=e.length;i<r;++i)this.drawGeometry(e[i])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Yt(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(this.text_!==""){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(Yt(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=t.getFlatCoordinates();let s=0;const o=t.getEnds(),a=t.getStride();i.beginPath();for(let l=0,h=o.length;l<h;++l)s=this.moveToLineTo_(r,s,o[l],a,!1);i.stroke()}if(this.text_!==""){const i=t.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Yt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Yt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let r=0;const s=t.getEndss(),o=t.getStride();e.beginPath();for(let a=0,l=s.length;a<l;++a){const h=s[a];r=this.drawRings_(i,r,h,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),An(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,r=t.textAlign?t.textAlign:ps;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=r&&(i.textAlign=r,e.textAlign=r),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=r,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:r,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(!t)this.fillState_=null;else{const i=t.getColor();this.fillState_={fillStyle:Ye(i||jt)}}if(!e)this.strokeState_=null;else{const i=e.getColor(),r=e.getLineCap(),s=e.getLineDash(),o=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),h=e.getMiterLimit(),c=s||un;this.strokeState_={lineCap:r!==void 0?r:ir,lineDash:this.pixelRatio_===1?c:c.map(u=>u*this.pixelRatio_),lineDashOffset:(o||fn)*this.pixelRatio_,lineJoin:a!==void 0?a:rr,lineWidth:(l!==void 0?l:ys)*this.pixelRatio_,miterLimit:h!==void 0?h:_s,strokeStyle:Ye(i||ms)}}}setImageStyle(t){let e;if(!t||!(e=t.getSize())){this.image_=null;return}const i=t.getPixelRatio(this.pixelRatio_),r=t.getAnchor(),s=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(!t)this.text_="";else{const e=t.getFill();if(!e)this.textFillState_=null;else{const d=e.getColor();this.textFillState_={fillStyle:Ye(d||jt)}}const i=t.getStroke();if(!i)this.textStrokeState_=null;else{const d=i.getColor(),g=i.getLineCap(),p=i.getLineDash(),_=i.getLineDashOffset(),m=i.getLineJoin(),y=i.getWidth(),x=i.getMiterLimit();this.textStrokeState_={lineCap:g!==void 0?g:ir,lineDash:p||un,lineDashOffset:_||fn,lineJoin:m!==void 0?m:rr,lineWidth:y!==void 0?y:ys,miterLimit:x!==void 0?x:_s,strokeStyle:Ye(d||ms)}}const r=t.getFont(),s=t.getOffsetX(),o=t.getOffsetY(),a=t.getRotateWithView(),l=t.getRotation(),h=t.getScaleArray(),c=t.getText(),u=t.getTextAlign(),f=t.getTextBaseline();this.textState_={font:r!==void 0?r:Jd,textAlign:u!==void 0?u:ps,textBaseline:f!==void 0?f:la},this.text_=c!==void 0?Array.isArray(c)?c.reduce((d,g,p)=>d+=p%2?" ":g,""):c:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const We=.5;function qC(n,t,e,i,r,s,o,a,l){const h=r,c=n[0]*We,u=n[1]*We,f=_t(c,u);f.imageSmoothingEnabled=!1;const d=f.canvas,g=new HC(f,We,r,null,o,a,null),p=e.length,_=Math.floor((256*256*256-1)/p),m={};for(let x=1;x<=p;++x){const v=e[x-1],w=v.getStyleFunction()||i;if(!w)continue;let E=w(v,s);if(!E)continue;Array.isArray(E)||(E=[E]);const R=(x*_).toString(16).padStart(7,"#00000");for(let S=0,I=E.length;S<I;++S){const T=E[S],L=T.getGeometryFunction()(v);if(!L||!Yt(h,L.getExtent()))continue;const A=T.clone(),P=A.getFill();P&&P.setColor(R);const W=A.getStroke();W&&(W.setColor(R),W.setLineDash(null)),A.setText(void 0);const O=T.getImage();if(O){const U=O.getImageSize();if(!U)continue;const st=_t(U[0],U[1],void 0,{alpha:!1}),M=st.canvas;st.fillStyle=R,st.fillRect(0,0,M.width,M.height),A.setImage(new ar({img:M,anchor:O.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:O.getOrigin(),opacity:1,size:O.getSize(),scale:O.getScale(),rotation:O.getRotation(),rotateWithView:O.getRotateWithView()}))}const N=A.getZIndex()||0;let k=m[N];k||(k={},m[N]=k,k.Polygon=[],k.Circle=[],k.LineString=[],k.Point=[]);const G=L.getType();if(G==="GeometryCollection"){const U=L.getGeometriesArrayRecursive();for(let st=0,M=U.length;st<M;++st){const At=U[st];k[At.getType().replace("Multi","")].push(At,A)}}else k[G.replace("Multi","")].push(L,A)}}const y=Object.keys(m).map(Number).sort(nn);for(let x=0,v=y.length;x<v;++x){const w=m[y[x]];for(const E in w){const C=w[E];for(let R=0,S=C.length;R<S;R+=2){g.setStyle(C[R+1]);for(let I=0,T=t.length;I<T;++I)g.setTransform(t[I]),g.drawGeometry(C[R])}}}return f.getImageData(0,0,d.width,d.height)}function JC(n,t,e){const i=[];if(e){const r=Math.floor(Math.round(n[0])*We),s=Math.floor(Math.round(n[1])*We),o=(lt(r,0,e.width-1)+lt(s,0,e.height-1)*e.width)*4,a=e.data[o],l=e.data[o+1],c=e.data[o+2]+256*(l+256*a),u=Math.floor((256*256*256-1)/t.length);c&&c%u===0&&i.push(t[c/u-1])}return i}const QC=.5,$g={Point:ab,LineString:rb,Polygon:hb,MultiPoint:lb,MultiLineString:sb,MultiPolygon:ob,GeometryCollection:ib,Circle:eb};function tb(n,t){return parseInt(Z(n),10)-parseInt(Z(t),10)}function zg(n,t){const e=Xg(n,t);return e*e}function Xg(n,t){return QC*n/t}function eb(n,t,e,i,r){const s=e.getFill(),o=e.getStroke();if(s||o){const l=n.getBuilder(e.getZIndex(),"Circle");l.setFillStrokeStyle(s,o),l.drawCircle(t,i,r)}const a=e.getText();if(a&&a.getText()){const l=n.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i)}}function Yg(n,t,e,i,r,s,o,a){const l=[],h=e.getImage();if(h){let f=!0;const d=h.getImageState();d==j.LOADED||d==j.ERROR?f=!1:d==j.IDLE&&h.load(),f&&l.push(h.ready())}const c=e.getFill();c&&c.loading()&&l.push(c.ready());const u=l.length>0;return u&&Promise.all(l).then(()=>r(null)),nb(n,t,e,i,s,o,a),u}function nb(n,t,e,i,r,s,o){const a=e.getGeometryFunction()(t);if(!a)return;const l=a.simplifyTransformed(i,r);if(e.getRenderer())Wg(n,l,e,t,o);else{const c=$g[l.getType()];c(n,l,e,t,o,s)}}function Wg(n,t,e,i,r){if(t.getType()=="GeometryCollection"){const o=t.getGeometries();for(let a=0,l=o.length;a<l;++a)Wg(n,o[a],e,i,r);return}n.getBuilder(e.getZIndex(),"Default").drawCustom(t,i,e.getRenderer(),e.getHitDetectionRenderer(),r)}function ib(n,t,e,i,r,s){const o=t.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const h=$g[o[a].getType()];h(n,o[a],e,i,r,s)}}function rb(n,t,e,i,r){const s=e.getStroke();if(s){const a=n.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(t,i,r)}const o=e.getText();if(o&&o.getText()){const a=n.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i,r)}}function sb(n,t,e,i,r){const s=e.getStroke();if(s){const a=n.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(t,i,r)}const o=e.getText();if(o&&o.getText()){const a=n.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i,r)}}function ob(n,t,e,i,r){const s=e.getFill(),o=e.getStroke();if(o||s){const l=n.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawMultiPolygon(t,i,r)}const a=e.getText();if(a&&a.getText()){const l=n.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i,r)}}function ab(n,t,e,i,r,s){const o=e.getImage(),a=e.getText(),l=a&&a.getText(),h=s&&o&&l?{}:void 0;if(o){if(o.getImageState()!=j.LOADED)return;const c=n.getBuilder(e.getZIndex(),"Image");c.setImageStyle(o,h),c.drawPoint(t,i,r)}if(l){const c=n.getBuilder(e.getZIndex(),"Text");c.setTextStyle(a,h),c.drawText(t,i,r)}}function lb(n,t,e,i,r,s){const o=e.getImage(),a=o&&o.getOpacity()!==0,l=e.getText(),h=l&&l.getText(),c=s&&a&&h?{}:void 0;if(a){if(o.getImageState()!=j.LOADED)return;const u=n.getBuilder(e.getZIndex(),"Image");u.setImageStyle(o,c),u.drawMultiPoint(t,i,r)}if(h){const u=n.getBuilder(e.getZIndex(),"Text");u.setTextStyle(l,c),u.drawText(t,i,r)}}function hb(n,t,e,i,r){const s=e.getFill(),o=e.getStroke();if(s||o){const l=n.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawPolygon(t,i,r)}const a=e.getText();if(a&&a.getText()){const l=n.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i,r)}}class cb extends Lg{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=ie(),this.wrappedRenderedExtent_=ie(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(t,e,i){const r=e.extent,s=e.viewState,o=s.center,a=s.resolution,l=s.projection,h=s.rotation,c=l.getExtent(),u=this.getLayer().getSource(),f=this.getLayer().getDeclutter(),d=e.pixelRatio,g=e.viewHints,p=!(g[It.ANIMATING]||g[It.INTERACTING]),_=this.context,m=Math.round(et(r)/a*d),y=Math.round(Ot(r)/a*d),x=u.getWrapX()&&l.canWrapX(),v=x?et(c):null,w=x?Math.ceil((r[2]-c[2])/v)+1:1;let E=x?Math.floor((r[0]-c[0])/v):0;do{let C=this.getRenderTransform(o,a,0,d,m,y,E*v);e.declutter&&(C=C.slice(0)),t.execute(_,[_.canvas.width,_.canvas.height],C,h,p,i===void 0?Ei:i?Gg:UC,i?f&&e.declutter[f]:void 0)}while(++E<w)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=_t(this.context.canvas.width,this.context.canvas.height,Ag))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,na(this.context),Ag.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(t){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,t,!0)}renderDeferredInternal(t){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex];this.opacity_=i.opacity;const r=t.viewState;this.prepareContainer(t,e);const s=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(fe.PRERENDER)||this.getLayer().hasListener(fe.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,t),r.projection,this.clipped_=!1,a&&i.extent&&this.clipping){const l=On(i.extent);a=Yt(l,t.extent),this.clipped_=a&&!ji(l,t.extent),this.clipped_&&this.clipUnrotated(s,t,l)}return a&&this.renderWorlds(o,t,this.getLayer().getDeclutter()?!1:void 0),!t.declutter&&this.clipped_&&s.restore(),this.postRender(s,t),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}getFeatures(t){return new Promise(e=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,h=this.getLayer(),c=[],u=i[0]*We,f=i[1]*We;c.push(this.getRenderTransform(r,s,o,We,u,f,0).slice());const d=h.getSource(),g=a.getExtent();if(d.getWrapX()&&a.canWrapX()&&!ji(g,l)){let p=l[0];const _=et(g);let m=0,y;for(;p<g[0];)--m,y=_*m,c.push(this.getRenderTransform(r,s,o,We,u,f,y).slice()),p+=_;for(m=0,p=l[2];p>g[2];)++m,y=_*m,c.push(this.getRenderTransform(r,s,o,We,u,f,y).slice()),p-=_}this.hitDetectionImageData_=qC(i,c,this.renderedFeatures_,h.getStyleFunction(),l,s,o,zg(s,this.renderedPixelRatio_))}e(JC(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,e,i,r,s){var f,d;if(!this.replayGroup_)return;const o=e.viewState.resolution,a=e.viewState.rotation,l=this.getLayer(),h={},c=function(g,p,_){const m=Z(g),y=h[m];if(y){if(y!==!0&&_<y.distanceSq){if(_===0)return h[m]=!0,s.splice(s.lastIndexOf(y),1),r(g,l,p);y.geometry=p,y.distanceSq=_}}else{if(_===0)return h[m]=!0,r(g,l,p);s.push(h[m]={feature:g,layer:l,geometry:p,distanceSq:_,callback:r})}},u=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(t,o,a,i,c,u?(d=(f=e.declutter)==null?void 0:f[u])==null?void 0:d.all().map(g=>g.value):null)}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),i=e.getSource();if(!i)return!1;const r=t.viewHints[It.ANIMATING],s=t.viewHints[It.INTERACTING],o=e.getUpdateWhileAnimating(),a=e.getUpdateWhileInteracting();if(this.ready&&!o&&r||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=t.extent,h=t.viewState,c=h.projection,u=h.resolution,f=t.pixelRatio,d=e.getRevision(),g=e.getRenderBuffer();let p=e.getRenderOrder();p===void 0&&(p=tb);const _=h.center.slice(),m=Do(l,g*u),y=m.slice(),x=[m.slice()],v=c.getExtent();if(i.getWrapX()&&c.canWrapX()&&!ji(v,t.extent)){const P=et(v),W=Math.max(et(m)/2,P);m[0]=v[0]-W,m[2]=v[2]+W,Xf(_,c);const O=Nf(x[0],c);O[0]<v[0]&&O[2]<v[2]?x.push([O[0]+P,O[1],O[2]+P,O[3]]):O[0]>v[0]&&O[2]>v[2]&&x.push([O[0]-P,O[1],O[2]-P,O[3]])}if(this.ready&&this.renderedResolution_==u&&this.renderedRevision_==d&&this.renderedRenderOrder_==p&&this.renderedFrameDeclutter_===!!t.declutter&&ji(this.wrappedRenderedExtent_,m))return An(this.renderedExtent_,y)||(this.hitDetectionImageData_=null,this.renderedExtent_=y),this.renderedCenter_=_,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const w=new YC(Xg(u,f),m,u,f);let E;for(let P=0,W=x.length;P<W;++P)i.loadFeatures(x[P],u,c);const C=zg(u,f);let R=!0;const S=(P,W)=>{let O;const N=P.getStyleFunction()||e.getStyleFunction();if(N&&(O=N(P,u)),O){const k=this.renderFeature(P,C,O,w,E,this.getLayer().getDeclutter(),W);R=R&&!k}},I=ad(m),T=i.getFeaturesInExtent(I);p&&T.sort(p);for(let P=0,W=T.length;P<W;++P)S(T[P],P);this.renderedFeatures_=T,this.ready=R;const L=w.finish(),A=new VC(m,u,f,i.getOverlaps(),L,e.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=u,this.renderedRevision_=d,this.renderedRenderOrder_=p,this.renderedFrameDeclutter_=!!t.declutter,this.renderedExtent_=y,this.wrappedRenderedExtent_=m,this.renderedCenter_=_,this.renderedProjection_=c,this.renderedPixelRatio_=f,this.replayGroup_=A,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,r,s,o,a){if(!i)return!1;let l=!1;if(Array.isArray(i))for(let h=0,c=i.length;h<c;++h)l=Yg(r,t,i[h],e,this.boundHandleStyleImageChange_,s,o,a)||l;else l=Yg(r,t,i,e,this.boundHandleStyleImageChange_,s,o,a);return l}}class Ra extends mg{constructor(t){super(t)}createRenderer(){return new cb(this)}}let ub=!1;function fb(n,t,e,i,r,s,o){const a=new XMLHttpRequest;a.open("GET",typeof n=="function"?n(e,i,r):n,!0),t.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=ub,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const h=t.getType();try{let c;h=="text"||h=="json"?c=a.responseText:h=="xml"?c=a.responseXML||a.responseText:h=="arraybuffer"&&(c=a.response),c?s(t.readFeatures(c,{extent:e,featureProjection:r}),t.readProjection(c)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function Bg(n,t){return function(e,i,r,s,o){fb(n,t,e,i,r,(a,l)=>{this.addFeatures(a),s!==void 0&&s(a)},()=>{this.changed(),o!==void 0&&o()})}}function db(n,t){return[[-1/0,-1/0,1/0,1/0]]}class jg{constructor(t){this.rbush_=new zd(t),this.items_={}}insert(t,e){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[Z(e)]=i}load(t,e){const i=new Array(e.length);for(let r=0,s=e.length;r<s;r++){const o=t[r],a=e[r],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[r]=l,this.items_[Z(a)]=l}this.rbush_.load(i)}remove(t){const e=Z(t),i=this.items_[e];return delete this.items_[e],this.rbush_.remove(i)!==null}update(t,e){const i=this.items_[Z(e)],r=[i.minX,i.minY,i.maxX,i.maxY];Vr(r,t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map(function(e){return e.value})}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(r){return r.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let r=0,s=t.length;r<s;r++)if(i=e(t[r]),i)return i;return i}isEmpty(){return ri(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return kn(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}}class Kg extends Se{constructor(t){super(),this.projection=ft(t.projection),this.attributions_=Ug(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible??!0,this.loading=!1,this.state_=t.state!==void 0?t.state:"ready",this.wrapX_=t.wrapX!==void 0?t.wrapX:!1,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise(function(i,r){e.viewResolver=i,e.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=Ug(t),this.changed()}setState(t){this.state_=t,this.changed()}}function Ug(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),t=>n):null}const ge={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Wn extends rn{constructor(t,e,i){super(t),this.feature=e,this.features=i}}class Vg extends Kg{constructor(t){t=t||{},super({attributions:t.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:t.wrapX!==void 0?t.wrapX:!0}),this.on,this.once,this.un,this.loader_=Br,this.format_=t.format||null,this.overlaps_=t.overlaps===void 0?!0:t.overlaps,this.url_=t.url,t.loader!==void 0?this.loader_=t.loader:this.url_!==void 0&&(Q(this.format_,"`format` must be set when `url` is set"),this.loader_=Bg(this.url_,this.format_)),this.strategy_=t.strategy!==void 0?t.strategy:db;const e=t.useSpatialIndex!==void 0?t.useSpatialIndex:!0;this.featuresRtree_=e?new jg:null,this.loadedExtentsRtree_=new jg,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(t.features)?r=t.features:t.features&&(i=t.features,r=i.getArray()),!e&&i===void 0&&(i=new ze(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=Z(t);if(!this.addToIndex_(e,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(e,t);const i=t.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Wn(ge.ADDFEATURE,t))}setupChangeEvents_(t,e){e instanceof re||(this.featureChangeKeys_[t]=[V(e,Y.CHANGE,this.handleFeatureChange_,this),V(e,Xi.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(t,e){let i=!0;if(e.getId()!==void 0){const r=String(e.getId());if(!(r in this.idIndex_))this.idIndex_[r]=e;else if(e instanceof re){const s=this.idIndex_[r];s instanceof re?Array.isArray(s)?s.push(e):this.idIndex_[r]=[s,e]:i=!1}else i=!1}return i&&(Q(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],i=[],r=[];for(let s=0,o=t.length;s<o;s++){const a=t[s],l=Z(a);this.addToIndex_(l,a)&&i.push(a)}for(let s=0,o=i.length;s<o;s++){const a=i[s],l=Z(a);this.setupChangeEvents_(l,a);const h=a.getGeometry();if(h){const c=h.getExtent();e.push(c),r.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(e,r),this.hasListener(ge.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new Wn(ge.ADDFEATURE,i[s]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(ge.ADDFEATURE,function(i){e||(e=!0,t.push(i.feature),e=!1)}),this.addEventListener(ge.REMOVEFEATURE,function(i){e||(e=!0,t.remove(i.feature),e=!1)}),t.addEventListener(Xt.ADD,i=>{e||(e=!0,this.addFeature(i.element),e=!1)}),t.addEventListener(Xt.REMOVE,i=>{e||(e=!0,this.removeFeature(i.element),e=!1)}),this.featuresCollection_=t}clear(t){if(t){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(at);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new Wn(ge.CLEAR);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof re||s.intersectsCoordinate(t))return e(r)})}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,function(i){const r=i.getGeometry();if(r instanceof re||r.intersectsExtent(t)){const s=e(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),ri(this.nullGeometryFeatures_)||$e(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,function(i){e.push(i)}),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const r=Gf(t,e);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const i=t[0],r=t[1];let s=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return e=e||Wr,this.featuresRtree_.forEachInExtent(l,function(h){if(e(h)){const c=h.getGeometry(),u=a;if(a=c instanceof re?0:c.closestPointXY(i,r,o,a),a<u){s=h;const f=Math.sqrt(a);l[0]=i-f,l[1]=r-f,l[2]=i+f,l[3]=r+f}}}),s}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return e!==void 0?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return e!==void 0?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,i=Z(e),r=e.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,e)):this.featuresRtree_&&this.featuresRtree_.update(o,e)}const s=e.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[o]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new Wn(ge.CHANGEFEATURE,e))}hasFeature(t){const e=t.getId();return e!==void 0?e in this.idIndex_:Z(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&ri(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(t,e,i){const r=this.loadedExtentsRtree_,s=this.strategy_(t,e,i);for(let o=0,a=s.length;o<a;++o){const l=s[o];r.forEachInExtent(l,function(c){return ji(c.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Wn(ge.FEATURESLOADSTART)),this.loader_.call(this,l,e,i,c=>{--this.loadingExtentsCount_,this.dispatchEvent(new Wn(ge.FEATURESLOADEND,void 0,c))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Wn(ge.FEATURESLOADERROR))}),r.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_,i=e.forEachInExtent(t,function(r){if(Vr(r.extent,t))return r});i&&e.remove(i)}removeFeatures(t){let e=!1;for(let i=0,r=t.length;i<r;++i)e=this.removeFeatureInternal(t[i])||e;e&&this.changed()}removeFeature(t){if(!t)return;this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=Z(t);if(!(e in this.uidIndex_))return!1;e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t);const i=this.featureChangeKeys_[e];i==null||i.forEach(at),delete this.featureChangeKeys_[e];const r=t.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===t?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(t),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[e],this.hasListener(ge.REMOVEFEATURE)&&this.dispatchEvent(new Wn(ge.REMOVEFEATURE,t)),!0}removeFromIdIndex_(t){for(const e in this.idIndex_)if(this.idIndex_[e]===t){delete this.idIndex_[e];break}}setLoader(t){this.loader_=t}setUrl(t){Q(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(Bg(t,this.format_))}setOverlaps(t){this.overlaps_=t,this.changed()}}class gb extends Vg{constructor(t){t=t||{},super({attributions:t.attributions,wrapX:t.wrapX}),this.resolution=void 0,this.distance=t.distance!==void 0?t.distance:20,this.minDistance=t.minDistance||0,this.interpolationRatio=0,this.features=[],this.geometryFunction=t.geometryFunction||function(e){const i=e.getGeometry();return Q(!i||i.getType()==="Point","The default `geometryFunction` can only handle `Point` or null geometries"),i},this.createCustomCluster_=t.createCluster,this.source=null,this.boundRefresh_=this.refresh.bind(this),this.updateDistance(this.distance,this.minDistance),this.setSource(t.source||null)}clear(t){this.features.length=0,super.clear(t)}getDistance(){return this.distance}getSource(){return this.source}loadFeatures(t,e,i){var r;(r=this.source)==null||r.loadFeatures(t,e,i),e!==this.resolution&&(this.resolution=e,this.refresh())}setDistance(t){this.updateDistance(t,this.minDistance)}setMinDistance(t){this.updateDistance(this.distance,t)}getMinDistance(){return this.minDistance}setSource(t){this.source&&this.source.removeEventListener(Y.CHANGE,this.boundRefresh_),this.source=t,t&&t.addEventListener(Y.CHANGE,this.boundRefresh_),this.refresh()}refresh(){this.clear(),this.cluster(),this.addFeatures(this.features)}updateDistance(t,e){const i=t===0?0:Math.min(e,t)/t,r=t!==this.distance||this.interpolationRatio!==i;this.distance=t,this.minDistance=e,this.interpolationRatio=i,r&&this.refresh()}cluster(){if(this.resolution===void 0||!this.source)return;const t=ie(),e=this.distance*this.resolution,i=this.source.getFeatures(),r={};for(let s=0,o=i.length;s<o;s++){const a=i[s];if(!(Z(a)in r)){const l=this.geometryFunction(a);if(l){const h=l.getCoordinates();Ll(h,t),Do(t,e,t);const c=this.source.getFeaturesInExtent(t).filter(function(u){const f=Z(u);return f in r?!1:(r[f]=!0,!0)});this.features.push(this.createCluster(c,t))}}}}createCluster(t,e){const i=[0,0];for(let a=t.length-1;a>=0;--a){const l=this.geometryFunction(t[a]);l?$f(i,l.getCoordinates()):t.splice(a,1)}zf(i,1/t.length);const r=on(e),s=this.interpolationRatio,o=new Nn([i[0]*(1-s)+r[0]*s,i[1]*(1-s)+r[1]*s]);return this.createCustomCluster_?this.createCustomCluster_(o,t):new Bh({geometry:o,features:t})}}const dr=[0,0,0],Bn=5;class Zg{constructor(t){this.minZoom=t.minZoom!==void 0?t.minZoom:0,this.resolutions_=t.resolutions,Q(Tw(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let e;if(!t.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!e)e=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==e){e=void 0;break}}this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=t.origin!==void 0?t.origin:null,this.origins_=null,t.origins!==void 0&&(this.origins_=t.origins,Q(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=t.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=hi(i)),Q(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,t.tileSizes!==void 0&&(this.tileSizes_=t.tileSizes,Q(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=t.tileSize!==void 0?t.tileSize:this.tileSizes_?null:ch,Q(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],t.sizes!==void 0?this.fullTileRanges_=t.sizes.map((r,s)=>{const o=new tc(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(t,e,i){const r=this.getTileRangeForExtentAndZ(t,e);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let a=r.minY,l=r.maxY;a<=l;++a)i([e,s,a])}forEachTileCoordParentTileRange(t,e,i,r){let s,o,a,l=null,h=t[0]-1;for(this.zoomFactor_===2?(o=t[1],a=t[2]):l=this.getTileCoordExtent(t,r);h>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),s=hr(o,o,a,a,i)):s=this.getTileRangeForExtentAndZ(l,h,i),e(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,i){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){const s=t[1]*2,o=t[2]*2;return hr(s,s+1,o,o+1,e)}const r=this.getTileCoordExtent(t,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,i){if(e>this.maxZoom||e<this.minZoom)return null;const r=t[0],s=t[1],o=t[2];if(e===r)return hr(s,o,s,o,i);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,e-r),h=Math.floor(s*l),c=Math.floor(o*l);if(e<r)return hr(h,h,c,c,i);const u=Math.floor(l*(s+1))-1,f=Math.floor(l*(o+1))-1;return hr(h,u,c,f,i)}const a=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,e,i)}getTileRangeForExtentAndZ(t,e,i){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,dr);const r=dr[1],s=dr[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,dr);const o=dr[1],a=dr[2];return hr(r,o,s,a,i)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),i=this.getResolution(t[0]),r=Wt(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*r[0]*i,e[1]-(t[2]+.5)*r[1]*i]}getTileCoordExtent(t,e){const i=this.getOrigin(t[0]),r=this.getResolution(t[0]),s=Wt(this.getTileSize(t[0]),this.tmpSize_),o=i[0]+t[1]*s[0]*r,a=i[1]-(t[2]+1)*s[1]*r,l=o+s[0]*r,h=a+s[1]*r;return kn(o,a,l,h,e)}getTileCoordForCoordAndResolution(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)}getTileCoordForXYAndResolution_(t,e,i,r,s){const o=this.getZForResolution(i),a=i/this.getResolution(o),l=this.getOrigin(o),h=Wt(this.getTileSize(o),this.tmpSize_);let c=a*(t-l[0])/i/h[0],u=a*(l[1]-e)/i/h[1];return r?(c=Oo(c,Bn)-1,u=Oo(u,Bn)-1):(c=ko(c,Bn),u=ko(u,Bn)),xa(o,c,u,s)}getTileCoordForXYAndZ_(t,e,i,r,s){const o=this.getOrigin(i),a=this.getResolution(i),l=Wt(this.getTileSize(i),this.tmpSize_);let h=(t-o[0])/a/l[0],c=(o[1]-e)/a/l[1];return r?(h=Oo(h,Bn)-1,c=Oo(c,Bn)-1):(h=ko(h,Bn),c=ko(c,Bn)),xa(i,h,c,s)}getTileCoordForCoordAndZ(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){const i=Rl(this.resolutions_,t,e||0);return lt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return xd(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,i=new Array(e);for(let r=this.minZoom;r<e;++r)i[r]=this.getTileRangeForExtentAndZ(t,r);this.fullTileRanges_=i}}function Hg(n){let t=n.getDefaultTileGrid();return t||(t=yb(n),n.setDefaultTileGrid(t)),t}function _b(n,t,e){const i=t[0],r=n.getTileCoordCenter(t),s=ac(e);if(!Bi(s,r)){const o=et(s),a=Math.ceil((s[0]-r[0])/o);return r[0]+=o*a,n.getTileCoordForCoordAndZ(r,i)}return t}function mb(n,t,e,i){i=i!==void 0?i:"top-left";const r=qg(n,t,e);return new Zg({extent:n,origin:Xw(n,i),resolutions:r,tileSize:e})}function pb(n){const t=n||{},e=t.extent||ft("EPSG:3857").getExtent(),i={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:qg(e,t.maxZoom,t.tileSize,t.maxResolution)};return new Zg(i)}function qg(n,t,e,i){t=t!==void 0?t:Ux,e=Wt(e!==void 0?e:ch);const r=Ot(n),s=et(n);i=i>0?i:Math.max(s/e[0],r/e[1]);const o=t+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=i/Math.pow(2,l);return a}function yb(n,t,e,i){const r=ac(n);return mb(r,t,e,i)}function ac(n){n=ft(n);let t=n.getExtent();if(!t){const e=180*Dl.degrees/n.getMetersPerUnit();t=kn(-e,-e,e,e)}return t}const vb=/\{z\}/g,wb=/\{x\}/g,xb=/\{y\}/g,Eb=/\{-y\}/g;function Cb(n,t,e,i,r){return n.replace(vb,t.toString()).replace(wb,e.toString()).replace(xb,i.toString()).replace(Eb,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function bb(n){const t=[];let e=/\{([a-z])-([a-z])\}/.exec(n);if(e){const i=e[1].charCodeAt(0),r=e[2].charCodeAt(0);let s;for(s=i;s<=r;++s)t.push(n.replace(e[0],String.fromCharCode(s)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(n),e){const i=parseInt(e[2],10);for(let r=parseInt(e[1],10);r<=i;r++)t.push(n.replace(e[0],r.toString()));return t}return t.push(n),t}function Rb(n,t){return function(e,i,r){if(!e)return;let s;const o=e[0];if(t){const a=t.getFullTileRange(o);a&&(s=a.getHeight()-1)}return Cb(n,o,e[1],e[2],s)}}function Sb(n,t){const e=n.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=Rb(n[r],t);return Tb(i)}function Tb(n){return n.length===1?n[0]:function(t,e,i){if(!t)return;const r=SC(t),s=Wi(r,n.length);return n[s](t,e,i)}}class Ib extends Kg{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,this.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;const e=[256,256];this.tileGrid&&Wt(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),e),this.tmpSize=[0,0],this.key_=t.key||Z(this),this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,i,r,s){return $()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:Hg(t)}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(e),o=Wt(r.getTileSize(t),this.tmpSize);return s==1?o:Y1(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){const i=e!==void 0?e:this.getProjection(),r=e!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=_b(r,t,i)),IC(t,r)?t:null}clear(){}refresh(){this.clear(),super.refresh()}}class Mb extends rn{constructor(t,e){super(t),this.tile=e}}const lc={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class hc extends Ib{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===hc.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,i=Z(e),r=e.getState();let s;r==D.LOADING?(this.tileLoadingKeys_[i]=!0,s=lc.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==D.ERROR?lc.TILELOADERROR:r==D.LOADED?lc.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new Mb(s,e))}setTileLoadFunction(t){this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,typeof e<"u"?this.setKey(e):this.changed()}setUrl(t){const e=bb(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(Sb(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,i){}}class Ab extends hc{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:Lb,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate!==void 0?t.interpolate:!0,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,this.tileClass=t.tileClass!==void 0?t.tileClass:bg,this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(t){return this.getProjection()&&t&&!Uo(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||Uo(e,t)))return this.tileGrid;const i=Z(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=Hg(t)),this.tileGridForProjection[i]}createTile_(t,e,i,r,s,o){const a=[t,e,i],l=this.getTileCoordForTileUrlFunction(a,s),h=l?this.tileUrlFunction(l,r,s):void 0,c=new this.tileClass(a,h!==void 0?D.IDLE:D.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return c.key=o,c.addEventListener(Y.CHANGE,this.handleTileChange.bind(this)),c}getTile(t,e,i,r,s){const o=this.getProjection();if(!o||!s||Uo(o,s))return this.getTileInternal(t,e,i,r,o||s);const a=[t,e,i],l=this.getKey(),h=this.getTileGridForProjection(o),c=this.getTileGridForProjection(s),u=this.getTileCoordForTileUrlFunction(a,s),f=new Ig(o,h,s,c,a,u,this.getTilePixelRatio(r),this.getGutter(),(d,g,p,_)=>this.getTileInternal(d,g,p,_,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return f.key=l,f}getTileInternal(t,e,i,r,s){const o=this.getKey();return this.createTile_(t,e,i,r,s,o)}setRenderReprojectionEdges(t){this.renderReprojectionEdges_!=t&&(this.renderReprojectionEdges_=t,this.changed())}setTileGridForProjection(t,e){const i=ft(t);if(i){const r=Z(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=e)}}}function Lb(n,t){n.getImage().src=t}class Pb extends Ab{constructor(t){t=t||{};const e=t.projection!==void 0?t.projection:"EPSG:3857",i=t.tileGrid!==void 0?t.tileGrid:pb({extent:ac(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0}getGutter(){return this.gutter_}}const kb='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class Ob extends Pb{constructor(t){t=t||{};let e;t.attributions!==void 0?e=t.attributions:e=[kb];const i=t.crossOrigin!==void 0?t.crossOrigin:"anonymous",r=t.url!==void 0?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:i,interpolate:t.interpolate,maxZoom:t.maxZoom!==void 0?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:r,wrapX:t.wrapX,zDirection:t.zDirection})}}const Mt={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class Fb extends Se{constructor(t){super(),this.on,this.once,this.un,this.options=t,this.id=t.id,this.insertFirst=t.insertFirst!==void 0?t.insertFirst:!0,this.stopEvent=t.stopEvent!==void 0?t.stopEvent:!0,this.element=document.createElement("div"),this.element.className=t.className!==void 0?t.className:"ol-overlay-container "+Jx,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=t.autoPan===!0?{}:t.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(Mt.ELEMENT,this.handleElementChanged),this.addChangeListener(Mt.MAP,this.handleMapChanged),this.addChangeListener(Mt.OFFSET,this.handleOffsetChanged),this.addChangeListener(Mt.POSITION,this.handlePositionChanged),this.addChangeListener(Mt.POSITIONING,this.handlePositioningChanged),t.element!==void 0&&this.setElement(t.element),this.setOffset(t.offset!==void 0?t.offset:[0,0]),this.setPositioning(t.positioning||"top-left"),t.position!==void 0&&this.setPosition(t.position)}getElement(){return this.get(Mt.ELEMENT)}getId(){return this.id}getMap(){return this.get(Mt.MAP)||null}getOffset(){return this.get(Mt.OFFSET)}getPosition(){return this.get(Mt.POSITION)}getPositioning(){return this.get(Mt.POSITIONING)}handleElementChanged(){Ad(this.element);const t=this.getElement();t&&this.element.appendChild(t)}handleMapChanged(){var e;this.mapPostrenderListenerKey&&((e=this.element)==null||e.remove(),at(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const t=this.getMap();if(t){this.mapPostrenderListenerKey=V(t,sn.POSTRENDER,this.render,this),this.updatePixelPosition();const i=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?i.insertBefore(this.element,i.childNodes[0]||null):i.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(t){this.set(Mt.ELEMENT,t)}setMap(t){this.set(Mt.MAP,t)}setOffset(t){this.set(Mt.OFFSET,t)}setPosition(t){this.set(Mt.POSITION,t)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(t){const e=this.getMap();if(!e||!e.getTargetElement()||!this.get(Mt.POSITION))return;const i=this.getRect(e.getTargetElement(),e.getSize()),r=this.getElement(),s=this.getRect(r,[t1(r),e1(r)]);t=t||{};const o=t.margin===void 0?20:t.margin;if(!ji(i,s)){const a=s[0]-i[0],l=i[2]-s[2],h=s[1]-i[1],c=i[3]-s[3],u=[0,0];if(a<0?u[0]=a-o:l<0&&(u[0]=Math.abs(l)+o),h<0?u[1]=h-o:c<0&&(u[1]=Math.abs(c)+o),u[0]!==0||u[1]!==0){const f=e.getView().getCenterInternal(),d=e.getPixelFromCoordinateInternal(f);if(!d)return;const g=[d[0]+u[0],d[1]+u[1]],p=t.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(g),duration:p.duration,easing:p.easing})}}}getRect(t,e){const i=t.getBoundingClientRect(),r=i.left+window.pageXOffset,s=i.top+window.pageYOffset;return[r,s,r+e[0],s+e[1]]}setPositioning(t){this.set(Mt.POSITIONING,t)}setVisible(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)}updatePixelPosition(){const t=this.getMap(),e=this.getPosition();if(!t||!t.isRendered()||!e){this.setVisible(!1);return}const i=t.getPixelFromCoordinate(e),r=t.getSize();this.updateRenderedPosition(i,r)}updateRenderedPosition(t,e){const i=this.element.style,r=this.getOffset(),s=this.getPositioning();this.setVisible(!0);const o=`${t[0]+r[0]}px`,a=`${t[1]+r[1]}px`;let l="0%",h="0%";s=="bottom-right"||s=="center-right"||s=="top-right"?l="-100%":(s=="bottom-center"||s=="center-center"||s=="top-center")&&(l="-50%"),s=="bottom-left"||s=="bottom-center"||s=="bottom-right"?h="-100%":(s=="center-left"||s=="center-center"||s=="center-right")&&(h="-50%");const c=`translate(${l}, ${h}) translate(${o}, ${a})`;this.rendered.transform_!=c&&(this.rendered.transform_=c,i.transform=c)}getOptions(){return this.options}}function Jg(n,t,e,i,r,s=5,o=!1,a=!0){typeof s=="number"?s={tl:s,tr:s,br:s,bl:s}:s={tl:0,tr:0,br:0,bl:0,...s},n.beginPath(),n.moveTo(t+s.tl,e),n.lineTo(t+i-s.tr,e),n.quadraticCurveTo(t+i,e,t+i,e+s.tr),n.lineTo(t+i,e+r-s.br),n.quadraticCurveTo(t+i,e+r,t+i-s.br,e+r),n.lineTo(t+s.bl,e+r),n.quadraticCurveTo(t,e+r,t,e+r-s.bl),n.lineTo(t,e+s.tl),n.quadraticCurveTo(t,e,t+s.tl,e),n.closePath(),o&&n.fill(),a&&n.stroke()}const Db={Polygon:new Kt({stroke:new gn({lineDash:[6,8],color:"rgba(12,74,110	,0.5)",width:4})}),LineString:new Kt({stroke:new gn({color:"rgba(12,74,110	,0.9)",width:4})}),MultiLineString:new Kt({stroke:new gn({color:"rgba(12,74,110	,0.9)",width:4})})},cc={},Qg=function(n,t){let e=n[t.getGeometry().getType()];const i=t.get("image");if(i){if(cc[i])return cc[i];e=e.clone();const r=new Image;r.onload=function(){const s=document.createElement("canvas");s.width=90,s.height=90;let o=s.getContext("2d");o.strokeStyle="rgba(255, 255, 255, 1)",o.lineWidth=6,o.shadowColor="rgba(100, 100, 100, 0.6)",o.shadowBlur=5,o.shadowOffsetX=1,o.shadowOffsetY=1,Jg(o,6,6,70,70,6,!0,!0),o.shadowColor=null,o.shadowBlur=0,o.shadowOffsetX=0,o.shadowOffsetY=0,o.drawImage(r,0,0,r.width,r.height,6,6,70,70),o.strokeStyle="rgba(255, 255, 255, 1)",o.lineWidth=4,Jg(o,6,6,70,70,6,!1,!0),e.setImage(new ar({anchor:[.48,.48],anchorXUnits:"fraction",anchorYUnits:"fraction",img:s,imgSize:[s.width,s.height],scale:.5})),t.setStyle(e),cc[i]=e},r.src=i,e.setImage(null)}return e},Nb=1,Gb=28,$b=Math.PI/2,zb=new dn({color:"rgba(255, 153, 0, 0.4)"}),t_=new gn({color:"rgba(204, 85, 0, 1)",width:1.5}),Xb=new dn({color:"rgba(255, 153, 102, 0.3)"}),Yb=new dn({color:"rgba(255, 165, 0, 0.7)"}),Wb=new dn({color:"#fff"}),Bb=new gn({color:"rgba(0, 0, 0, 0.6)",width:3});new or({radius:14,fill:Yb}),new or({radius:20,fill:Xb});function uc(n,t){return Qg(n,t)}let jb,Kb;function Ub(n,t,e){if(t!==jb||e!==Kb)return;const i=t.get("features"),r=t.getGeometry().getCoordinates();return Vb(i.length,t.getGeometry().getCoordinates(),e).reduce((s,o,a)=>{const l=new Nn(o),h=new wi([r,o]);return s.unshift(new Kt({geometry:h,stroke:t_})),s.push(uc(n,new Feature({...i[a].getProperties(),geometry:l}))),s},[])}function Vb(n,t,e){let r=Nb*Gb*(2+n)/(Math.PI*2);const s=Math.PI*2/n,o=[];let a;r=Math.max(r,35)*e;for(let l=0;l<n;++l)a=$b+l*s,o.push([t[0]+r*Math.cos(a),t[1]+r*Math.sin(a)]);return o}let Zb;function Hb(n,t){if(t!==Zb)return;const i=t.get("features").map(r=>r.getGeometry().getCoordinates());return new Kt({geometry:new hn([monotoneChainConvexHull(i)]),fill:zb,stroke:t_})}function qb(n,t){const e=t.get("features"),i=e[0];return e.length>1?[uc(n,i),new Kt({text:new og({text:e.length.toString(),fill:Wb,stroke:Bb})})]:uc(n,i)}var Jb=Ee('<div style="position:relative;z-index:0;width:100%;height:100%" class="svelte-15rlj1s"></div>');const Qb={hash:"svelte-15rlj1s",code:`/*! tailwindcss v4.1.11 | MIT License | https://tailwindcss.com */
@layer properties{@supports (((-webkit-hyphens:none)) and (not (margin-trim:inline))) or ((-moz-orient:inline) and (not (color:rgb(from red r g b)))){.svelte-15rlj1s,.svelte-15rlj1s:before,.svelte-15rlj1s:after,.svelte-15rlj1s::backdrop{--tw-shadow:0 0 #0000;--tw-shadow-color:initial;--tw-shadow-alpha:100%;--tw-inset-shadow:0 0 #0000;--tw-inset-shadow-color:initial;--tw-inset-shadow-alpha:100%;--tw-ring-color:initial;--tw-ring-shadow:0 0 #0000;--tw-inset-ring-color:initial;--tw-inset-ring-shadow:0 0 #0000;--tw-ring-inset:initial;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-offset-shadow:0 0 #0000;--tw-backdrop-blur:initial;--tw-backdrop-brightness:initial;--tw-backdrop-contrast:initial;--tw-backdrop-grayscale:initial;--tw-backdrop-hue-rotate:initial;--tw-backdrop-invert:initial;--tw-backdrop-opacity:initial;--tw-backdrop-saturate:initial;--tw-backdrop-sepia:initial;--tw-space-x-reverse:0;--tw-translate-x:0;--tw-translate-y:0;--tw-translate-z:0;--tw-border-style:solid}}}:is(:root,:host){--ol-background-color:white;--ol-accent-background-color:#f5f5f5;--ol-subtle-background-color:#80808040;--ol-partial-background-color:#ffffffbf;--ol-foreground-color:#333;--ol-subtle-foreground-color:#666;--ol-brand-color:#0af}.ol-box{box-sizing:border-box;border:1.5px solid var(--ol-background-color);background-color:var(--ol-partial-background-color);border-radius:2px}.ol-mouse-position{position:absolute;top:8px;right:8px}.ol-scale-line{background:var(--ol-partial-background-color);border-radius:4px;padding:2px;position:absolute;bottom:8px;left:8px}.ol-scale-line-inner{border:1px solid var(--ol-subtle-foreground-color);color:var(--ol-foreground-color);text-align:center;will-change:contents,width;border-top:none;margin:1px;font-size:10px;transition:all .25s}.ol-scale-bar{position:absolute;bottom:8px;left:8px}.ol-scale-bar-inner{display:flex}.ol-scale-step-marker{background-color:var(--ol-foreground-color);float:right;z-index:10;width:1px;height:15px}.ol-scale-step-text{z-index:11;color:var(--ol-foreground-color);text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color);font-size:10px;position:absolute;bottom:-5px}.ol-scale-text{text-align:center;color:var(--ol-foreground-color);text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color);font-size:12px;position:absolute;bottom:25px}.ol-scale-singlebar{z-index:9;box-sizing:border-box;border:1px solid var(--ol-foreground-color);height:10px;position:relative}.ol-scale-singlebar-even{background-color:var(--ol-subtle-foreground-color)}.ol-scale-singlebar-odd{background-color:var(--ol-background-color)}.ol-unsupported{display:none}:is(.ol-viewport,.ol-unselectable){-webkit-touch-callout:none;-webkit-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}.ol-viewport canvas{all:unset;overflow:hidden}.ol-viewport{touch-action:pan-x pan-y}.ol-selectable{-webkit-touch-callout:default;-webkit-user-select:text;user-select:text}.ol-grabbing{cursor:-webkit-grabbing;cursor:-moz-grabbing;cursor:grabbing}.ol-grab{cursor:move;cursor:-webkit-grab;cursor:-moz-grab;cursor:grab}.ol-control{background-color:var(--ol-subtle-background-color);border-radius:4px;position:absolute}.ol-rotate{transition:opacity .25s linear,visibility linear;top:.5em;right:.5em}.ol-rotate.ol-hidden{opacity:0;visibility:hidden;transition:opacity .25s linear,visibility 0s linear .25s}.ol-zoom-extent{top:4.643em;left:.5em}.ol-control button{color:var(--ol-subtle-foreground-color);font-weight:700;font-size:inherit;text-align:center;background-color:var(--ol-background-color);border:none;border-radius:2px;width:1.375em;height:1.375em;margin:1px;padding:0;line-height:.4em;text-decoration:none;display:block}.ol-control button::-moz-focus-inner{border:none;padding:0}.ol-zoom-extent button{line-height:1.4em}.ol-compass{will-change:transform;font-weight:400;display:block}.ol-touch .ol-control button{font-size:1.5em}.ol-touch .ol-zoom-extent{top:5.5em}:is(.ol-control button:hover,.ol-control button:focus){outline:1px solid var(--ol-subtle-foreground-color);color:var(--ol-foreground-color);text-decoration:none}.ol-zoom .ol-zoom-in{border-radius:2px 2px 0 0}.ol-zoom .ol-zoom-out{border-radius:0 0 2px 2px}.ol-attribution{text-align:right;flex-flow:row-reverse;align-items:center;max-width:calc(100% - 1.3em);display:flex;bottom:.5em;right:.5em}.ol-attribution a{color:var(--ol-subtle-foreground-color);text-decoration:none}.ol-attribution ul{color:var(--ol-foreground-color);text-shadow:0 0 2px var(--ol-background-color);margin:0;padding:1px .5em;font-size:12px}.ol-attribution li{list-style:none;display:inline}.ol-attribution li:not(:last-child):after{content:" "}.ol-attribution img{max-height:2em;max-width:inherit;vertical-align:middle}.ol-attribution button{flex-shrink:0}.ol-attribution.ol-collapsed ul{display:none}.ol-attribution:not(.ol-collapsed){background:var(--ol-partial-background-color)}.ol-attribution.ol-uncollapsible{border-radius:4px 0 0;bottom:0;right:0}.ol-attribution.ol-uncollapsible img{max-height:1.6em;margin-top:-.2em}.ol-attribution.ol-uncollapsible button{display:none}.ol-zoomslider{height:200px;top:4.5em;left:.5em}.ol-zoomslider button{height:10px;position:relative}.ol-touch .ol-zoomslider{top:5.5em}.ol-overviewmap{bottom:.5em;left:.5em}.ol-overviewmap.ol-uncollapsible{border-radius:0 4px 0 0;bottom:0;left:0}:is(.ol-overviewmap .ol-overviewmap-map,.ol-overviewmap button){display:block}.ol-overviewmap .ol-overviewmap-map{border:1px solid var(--ol-subtle-foreground-color);width:150px;height:150px}.ol-overviewmap:not(.ol-collapsed) button{position:absolute;bottom:0;left:0}:is(.ol-overviewmap.ol-collapsed .ol-overviewmap-map,.ol-overviewmap.ol-uncollapsible button){display:none}.ol-overviewmap:not(.ol-collapsed){background:var(--ol-subtle-background-color)}.ol-overviewmap-box{border:1.5px dotted var(--ol-subtle-foreground-color)}.ol-overviewmap .ol-overviewmap-box:hover{cursor:move}.ol-overviewmap .ol-viewport:hover{cursor:pointer}:is(.ol-zoom,.ol-full-screen){border-radius:var(--radius-sm,.25rem);background-color:#fff3;margin:-1px;position:absolute}@supports (color:color-mix(in lab, red, red)){:is(.ol-zoom,.ol-full-screen){background-color:color-mix(in oklab,var(--color-white,#fff)20%,transparent)}}:is(.ol-zoom,.ol-full-screen){font-size:var(--text-lg,1.125rem);line-height:var(--tw-leading,var(--text-lg--line-height,calc(1.75/1.125)));--tw-shadow:0 1px 3px 0 var(--tw-shadow-color,#0000001a),0 1px 2px -1px var(--tw-shadow-color,#0000001a);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow);--tw-backdrop-blur:blur(var(--blur-sm,8px));-webkit-backdrop-filter:var(--tw-backdrop-blur,)var(--tw-backdrop-brightness,)var(--tw-backdrop-contrast,)var(--tw-backdrop-grayscale,)var(--tw-backdrop-hue-rotate,)var(--tw-backdrop-invert,)var(--tw-backdrop-opacity,)var(--tw-backdrop-saturate,)var(--tw-backdrop-sepia,);backdrop-filter:var(--tw-backdrop-blur,)var(--tw-backdrop-brightness,)var(--tw-backdrop-contrast,)var(--tw-backdrop-grayscale,)var(--tw-backdrop-hue-rotate,)var(--tw-backdrop-invert,)var(--tw-backdrop-opacity,)var(--tw-backdrop-saturate,)var(--tw-backdrop-sepia,)}.ol-zoom{top:calc(var(--spacing,.25rem)*1.5);left:calc(var(--spacing,.25rem)*1.5)}.ol-full-screen{top:calc(var(--spacing,.25rem)*1.5);right:calc(var(--spacing,.25rem)*1.5)}:is(.ol-zoom button:first-child,.ol-full-screen button:first-child){border-top-left-radius:var(--radius-sm,.25rem);border-top-right-radius:var(--radius-sm,.25rem)}:is(.ol-zoom button:last-child,.ol-full-screen button:last-child){border-bottom-right-radius:var(--radius-sm,.25rem);border-bottom-left-radius:var(--radius-sm,.25rem)}:is(.ol-zoom button,.ol-full-screen button){height:calc(var(--spacing,.25rem)*9);width:calc(var(--spacing,.25rem)*9);background-color:var(--color-white,#fff);background-color:#ffffffe6;justify-content:center;align-items:center;margin:1px;display:flex}@supports (color:color-mix(in lab, red, red)){:is(.ol-zoom button,.ol-full-screen button){background-color:color-mix(in oklab,var(--color-white,#fff)90%,transparent)}}:is(.ol-zoom button,.ol-full-screen button){color:var(--color-gray-700,oklch(37.3% .034 259.733))}@media (hover:hover){.svelte-15rlj1s:is(.ol-zoom button,.ol-full-screen button):hover{background-color:var(--color-white,#fff);color:var(--color-black,#000)}}.ol-attribution{right:calc(var(--spacing,.25rem)*0);bottom:calc(var(--spacing,.25rem)*0);text-overflow:ellipsis;white-space:nowrap;border-top-left-radius:var(--radius-sm,.25rem);background-color:#fff3;max-width:100%;position:absolute;overflow:hidden}@supports (color:color-mix(in lab, red, red)){.ol-attribution{background-color:color-mix(in oklab,var(--color-white,#fff)20%,transparent)}}.ol-attribution{font-size:var(--text-xs,.75rem);line-height:var(--tw-leading,var(--text-xs--line-height,calc(1/.75)));color:var(--color-gray-600,oklch(44.6% .03 256.802));--tw-backdrop-blur:blur(var(--blur-sm,8px));-webkit-backdrop-filter:var(--tw-backdrop-blur,)var(--tw-backdrop-brightness,)var(--tw-backdrop-contrast,)var(--tw-backdrop-grayscale,)var(--tw-backdrop-hue-rotate,)var(--tw-backdrop-invert,)var(--tw-backdrop-opacity,)var(--tw-backdrop-saturate,)var(--tw-backdrop-sepia,);backdrop-filter:var(--tw-backdrop-blur,)var(--tw-backdrop-brightness,)var(--tw-backdrop-contrast,)var(--tw-backdrop-grayscale,)var(--tw-backdrop-hue-rotate,)var(--tw-backdrop-invert,)var(--tw-backdrop-opacity,)var(--tw-backdrop-saturate,)var(--tw-backdrop-sepia,);padding:1px}.ol-attribution button{display:none}:where(.ol-attribution ul>.svelte-15rlj1s:not(:last-child)){--tw-space-x-reverse:0;margin-inline-start:calc(calc(var(--spacing,.25rem)*1)*var(--tw-space-x-reverse));margin-inline-end:calc(calc(var(--spacing,.25rem)*1)*calc(1 - var(--tw-space-x-reverse)))}.ol-attribution ul{background-color:#ffffffe6}@supports (color:color-mix(in lab, red, red)){.ol-attribution ul{background-color:color-mix(in oklab,var(--color-white,#fff)90%,transparent)}}.ol-attribution ul{padding-inline:calc(var(--spacing,.25rem)*1);padding-block:calc(var(--spacing,.25rem)*.5)}.ol-attribution ul li{display:inline-block}.ol-overlay{bottom:calc(var(--spacing,.25rem)*3);width:calc(var(--spacing,.25rem)*64);--tw-translate-x:calc(var(--spacing,.25rem)*-32);translate:var(--tw-translate-x)var(--tw-translate-y);border-style:var(--tw-border-style);border-width:1px;border-color:var(--color-gray-400,oklch(70.7% .022 261.325));background-color:#ffffffe6;border-radius:.25rem;position:absolute}@supports (color:color-mix(in lab, red, red)){.ol-overlay{background-color:color-mix(in oklab,var(--color-white,#fff)90%,transparent)}}.ol-overlay{padding-inline:calc(var(--spacing,.25rem)*2);padding-block:calc(var(--spacing,.25rem)*2);text-align:center;font-size:var(--text-sm,.875rem);line-height:var(--tw-leading,var(--text-sm--line-height,calc(1.25/.875)));--tw-shadow:0 20px 25px -5px var(--tw-shadow-color,#0000001a),0 8px 10px -6px var(--tw-shadow-color,#0000001a);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow);--tw-backdrop-blur:blur(var(--blur-md,12px));-webkit-backdrop-filter:var(--tw-backdrop-blur,)var(--tw-backdrop-brightness,)var(--tw-backdrop-contrast,)var(--tw-backdrop-grayscale,)var(--tw-backdrop-hue-rotate,)var(--tw-backdrop-invert,)var(--tw-backdrop-opacity,)var(--tw-backdrop-saturate,)var(--tw-backdrop-sepia,);backdrop-filter:var(--tw-backdrop-blur,)var(--tw-backdrop-brightness,)var(--tw-backdrop-contrast,)var(--tw-backdrop-grayscale,)var(--tw-backdrop-hue-rotate,)var(--tw-backdrop-invert,)var(--tw-backdrop-opacity,)var(--tw-backdrop-saturate,)var(--tw-backdrop-sepia,)}:is(.ol-overlay:after,.ol-overlay:before){pointer-events:none;height:calc(var(--spacing,.25rem)*0);width:calc(var(--spacing,.25rem)*0);border-style:var(--tw-border-style);content:" ";border-width:1px;border-color:#0000;position:absolute;top:100%}.ol-overlay:after{left:calc(var(--spacing,.25rem)*32);border-top-color:var(--color-white,#fff);border-width:10px;margin-left:-10px}.ol-overlay:before{left:calc(var(--spacing,.25rem)*32);border-top-color:var(--color-gray-400,oklch(70.7% .022 261.325));border-width:11px;margin-left:-11px}.ol-overlay-closer{text-decoration:none;display:none;position:absolute;top:2px;right:8px}.ol-overlay-closer:after{content:"✖";color:#c3c3c3}@property --tw-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-shadow-color{syntax:"*";inherits:false}@property --tw-shadow-alpha{syntax:"<percentage>";inherits:false;initial-value:100%}@property --tw-inset-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-inset-shadow-color{syntax:"*";inherits:false}@property --tw-inset-shadow-alpha{syntax:"<percentage>";inherits:false;initial-value:100%}@property --tw-ring-color{syntax:"*";inherits:false}@property --tw-ring-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-inset-ring-color{syntax:"*";inherits:false}@property --tw-inset-ring-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-ring-inset{syntax:"*";inherits:false}@property --tw-ring-offset-width{syntax:"<length>";inherits:false;initial-value:0}@property --tw-ring-offset-color{syntax:"*";inherits:false;initial-value:#fff}@property --tw-ring-offset-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-backdrop-blur{syntax:"*";inherits:false}@property --tw-backdrop-brightness{syntax:"*";inherits:false}@property --tw-backdrop-contrast{syntax:"*";inherits:false}@property --tw-backdrop-grayscale{syntax:"*";inherits:false}@property --tw-backdrop-hue-rotate{syntax:"*";inherits:false}@property --tw-backdrop-invert{syntax:"*";inherits:false}@property --tw-backdrop-opacity{syntax:"*";inherits:false}@property --tw-backdrop-saturate{syntax:"*";inherits:false}@property --tw-backdrop-sepia{syntax:"*";inherits:false}@property --tw-space-x-reverse{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-x{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-y{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-z{syntax:"*";inherits:false;initial-value:0}@property --tw-border-style{syntax:"*";inherits:false;initial-value:solid}`};function e_(n,t){bn(t,!1),Nm(n,Qb);let e=te(t,"interactionMode",12,"click"),i=te(t,"center",12,null),r=te(t,"zoom",12,null),s=te(t,"sourcesJSON",12,"[]");const o=JSON.parse(s());let a={},l=we(null);Zs(()=>{const c={...Db,Point:new Kt({image:new ar({src:"https://img.icons8.com/plasticine/100/000000/place-marker.png",anchor:[.45,.95],anchorXUnits:"fraction",anchorYUnits:"fraction",scale:.4,size:[100,100]})})},u=new Xe({center:i()?od(i()):void 0,zoom:r()}),f=new Fb({autoPan:!0,autoPanAnimation:{duration:250}}),d=new FC({source:new Ob({}),preload:2}),g=new Array(d),p=new Array;return Promise.all(o.map(_=>_.dataURL?fetch(_.dataURL).then(async m=>({..._,data:await m.json()})):_)).then(_=>_.forEach((m,y)=>{const x=new QE({featureProjection:"EPSG:3857"}).readFeatures(m.data),v=new Vg({features:x});if(m.cluster){const w=new gb({distance:35,source:v}),E=new Ra({source:w,style:S=>Hb(c,S)}),C=new Ra({source:w,style:S=>qb(c,S)}),R=new Ra({source:w,style:S=>Ub(c,S)});g.push(E,C,R)}else{const w=new Ra({source:v,style:E=>Qg(c,E)});g.push(w)}x.forEach(w=>{const E=w.getGeometry();switch(E.getType()){case"Point":p.push(E.getCoordinates());break;case"LineString":for(const C of E.getCoordinates())p.push(C);break;case"Polygon":for(const C of E.getCoordinates())p.push(...C);break;case"MultiLineString":for(const C of E.getCoordinates())p.push(...C.flat(0).map(R=>[R[0],R[1]]));break;default:console.log(`missing behavior for ${E.getType()}`)}})})).then(()=>{p.length>0?setTimeout(()=>{u.fit(Fo(p),{padding:[25,20,e()!="button"?40:25,e()!="button"?50:20],maxZoom:14})},5):u.fit(Fo([od([-90.199402,38.627003])]),{maxZoom:5});const _=new jE({controls:e()=="button"?[]:Ld({rotate:!1}),interactions:e()=="button"?[]:Nd({altShiftDragRotate:!1,pinchRotate:!1,mouseWheelZoom:e()!="click"}),layers:g,target:X(l),overlays:[f],view:u});setTimeout(()=>{_.updateSize()},500),a.Map=_}),()=>{a.Map&&(a.Map.setTarget(null),a.Map=null)}}),qn();var h=Jb();return eo(h,c=>pt(l,c),()=>X(l)),Ct(n,h),Rn({get interactionMode(){return e()},set interactionMode(c){e(c),kt()},get center(){return i()},set center(c){i(c),kt()},get zoom(){return r()},set zoom(c){r(c),kt()},get sourcesJSON(){return s()},set sourcesJSON(c){s(c),kt()}})}customElements.define("dpb587-map",Jn(e_,{center:{attribute:"center",type:"String"},zoom:{attribute:"zoom",type:"String"},sourcesJSON:{attribute:"sources-json",type:"String"},interactionMode:{attribute:"interaction-mode",type:"String"}},[],[],!0));var tR=wm(Ee("<script><\/script><!>",1));function n_(n,t){bn(t,!1);const e=Mm();let i=te(t,"url",12),r=we();return Zs(async()=>{X(r).addEventListener("load",()=>{e("load")}),X(r).addEventListener("error",s=>{e("error")})}),qn(),ym(s=>{var o=tR(),a=Bs(o);eo(a,l=>pt(r,l),()=>X(r)),Oe(a),Li(()=>Qs(a,"src",i())),Ct(s,o)}),Rn({get url(){return i()},set url(s){i(s),kt()}})}Jn(n_,{url:{}},[],[],!0);var eR=Ee('<!> <div class="h-full w-full"></div>',1);function i_(n,t){bn(t,!1);let e=we(null),i=te(t,"config",28,()=>({})),r=null;function s(){const h=window.OpenSeadragon;r=h({prefixUrl:"/assets/openseadragon/openseadragon-flat-toolbar-icons-current/images/",blendTime:.1,element:X(e),immediateRender:!0,minPixelRatio:1,...i()})}Zs(async()=>{window.OpenSeadragon&&s()}),Tm(async()=>{r&&r.destroy()}),qn();var o=eR(),a=Bs(o);n_(a,{url:"/assets/openseadragon/openseadragon-current/openseadragon.min.js",$$events:{load:s}});var l=Oe(a,2);return eo(l,h=>pt(e,h),()=>X(e)),Ct(n,o),Rn({get config(){return i()},set config(h){i(h),kt()}})}Jn(i_,{config:{}},[],[],!0);var nR=Pr('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 md:w-5 h-4 md:h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path></svg>'),iR=Pr('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 md:w-5 h-4 md:h-5"><path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607ZM10.5 7.5v6m3-3h-6"></path></svg>'),rR=Ee('<div class="fixed inset-0 z-0 overflow-none"><button class="absolute -z-10 -inset-8 backdrop-blur-lg grayscale" aria-label="Close Image Viewer"></button> <div class="absolute top-10 md:top-0 left-0 md:left-12 bottom-0 right-0"><!></div></div>'),sR=Ee('<button title="Image Viewer"><div class="p-2.5 bg-stone-800 group-hover:bg-black group-hover:text-white group-focus:ring-inset group-focus:ring-4 group-focus:ring-neutral-100 group-focus:pointer-events-none"><!></div></button> <!>',1);function r_(n,t){bn(t,!1);let e=te(t,"buttonClass",12,""),i=we(!1),r=te(t,"infoURL",12,null),s=we(null),o=null;function a(){o||(o=fetch(r()).then(m=>{if(!m.ok)throw new Error(`Failed to fetch info document: ${m.statusText}`);return m.json()}).then(m=>{pt(s,{...m,id:new URL(m.id,window.location.toString()).toString()})}).catch(m=>{console.error("Error fetching info document:",m)}))}function l(m){pt(i,!X(i)),X(i)||m.currentTarget.blur()}qn();var h=sR(),c=Bs(h),u=St(c),f=St(u);{var d=m=>{var y=nR();Ct(m,y)},g=m=>{var y=iR();Ct(m,y)};qs(f,m=>{X(i)?m(d):m(g,!1)})}Et(u),Et(c);var p=Oe(c,2);{var _=m=>{var y=rR(),x=St(y),v=Oe(x,2),w=St(v);const E=$a(()=>({tileSources:[X(s)]}));i_(w,{get config(){return X(E)}}),Et(v),Et(y),In("click",x,l),Ct(m,y)};qs(p,m=>{X(i)&&m(_)})}return Li(()=>Js(c,1,`relative z-10 group inline-block focus:outline-none ${e()??""}`)),In("click",c,l),In("mouseover",c,a),In("focus",c,a),Ct(n,h),Rn({get buttonClass(){return e()},set buttonClass(m){e(m),kt()},get infoURL(){return r()},set infoURL(m){r(m),kt()}})}customElements.define("dpb587-openseadragon",Jn(r_,{infoURL:{attribute:"info-url",type:"String"},buttonClass:{attribute:"button-class",type:"String"}},[],[],!1));const oR=n=>n;function aR(n){const t=n-1;return t*t*t+1}function s_(n){const t=typeof n=="string"&&n.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return t?[parseFloat(t[1]),t[2]||"px"]:[n,"px"]}function lR(n,{delay:t=0,duration:e=400,easing:i=oR}={}){const r=+getComputedStyle(n).opacity;return{delay:t,duration:e,easing:i,css:s=>`opacity: ${s*r}`}}function hR(n,{delay:t=0,duration:e=400,easing:i=aR,x:r=0,y:s=0,opacity:o=0}={}){const a=getComputedStyle(n),l=+a.opacity,h=a.transform==="none"?"":a.transform,c=l*(1-o),[u,f]=s_(r),[d,g]=s_(s);return{delay:t,duration:e,easing:i,css:(p,_)=>`
			transform: ${h} translate(${(1-p)*u}${f}, ${(1-p)*d}${g});
			opacity: ${l-c*_}`}}var cR=Pr('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 md:w-5 h-4 md:h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path></svg>'),uR=Pr('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 md:w-5 h-4 md:h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 8.25h15m-16.5 7.5h15m-1.8-13.5-3.9 19.5m-2.1-19.5-3.9 19.5"></path></svg>'),fR=Ee('<li><a class="block px-3 py-1 truncate hover:underline hover:text-white"><span> </span></a></li>'),dR=Ee('<div class="z-0 fixed md:absolute left-1 top-10 md:top-0 w-screen md:max-w-sm"><div class="bg-stone-800 md:ml-12 shadow-lg border-t md:border-t-0 border-stone-600 -translate-y-px md:translate-y-0"><div class="flex items-center justify-between mx-1.5 text-stone-400 border-b border-stone-600"><strong class="inline-block px-1.5 py-3 font-light font-lg">Table of Contents</strong> <a class="group h-full p-3 -mr-1.5 hover:text-white" title="Scroll to top" aria-label="Scroll to top"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 pt-1 border-t border-stone-400 group-hover:border-white"><path fill-rule="evenodd" d="M10 17a.75.75 0 0 1-.75-.75V5.612L5.29 9.77a.75.75 0 0 1-1.08-1.04l5.25-5.5a.75.75 0 0 1 1.08 0l5.25 5.5a.75.75 0 1 1-1.08 1.04l-3.96-4.158V16.25A.75.75 0 0 1 10 17Z" clip-rule="evenodd"></path></svg></a></div> <nav class="text-stone-200"><ol class="py-1"></ol></nav></div></div> <button class="fixed inset-0 -z-10 bg-transparent" aria-label="Close Table of Contents"></button>',1),gR=Ee('<div class="relative z-0"><button title="Table of Contents"><div class="p-2.5 bg-stone-800 group-hover:bg-black group-hover:text-white group-focus:ring-inset group-focus:ring-4 group-focus:ring-neutral-100 group-focus:pointer-events-none"><!></div></button> <!></div>');function o_(n,t){bn(t,!1);let e=te(t,"buttonClass",12,""),i=we(!1);function r(y){pt(i,!X(i)),X(i)||y.currentTarget.blur()}function s(y){window.scroll({top:0,left:0});try{history.pushState("",document.title,window.location.pathname+window.location.search)}catch{}y.preventDefault()}function o(y){const x=[];return(y?document.getElementById(a()):document).querySelectorAll("h1, h2, h3, h4, h5, h6").forEach(v=>{x.push({id:(w=>{for(;w;){if(w.id)return w.id;w=w.parentElement}})(v),level:v.tagName.toLowerCase(),text:v.textContent.trim()})}),x}let a=te(t,"forRef",12,null),l=o(a());const h={h1:"font-semibold",h2:"pl-4",h3:"pl-8",h4:"pl-12",h5:"pl-16",h6:"pl-20"};qn();var c=gR(),u=St(c),f=St(u),d=St(f);{var g=y=>{var x=cR();Ct(y,x)},p=y=>{var x=uR();Ct(y,x)};qs(d,y=>{X(i)?y(g):y(p,!1)})}Et(f),Et(u);var _=Oe(u,2);{var m=y=>{var x=dR(),v=Bs(x),w=St(v),E=St(w),C=Oe(St(E),2);Qs(C,"href",De(()=>window.location.toString().split("#")[0])),Et(E);var R=Oe(E,2),S=St(R);Om(S,5,()=>l,Pm,(T,L)=>{let A=()=>X(L).id,P=()=>X(L).level,W=()=>X(L).text;var O=fR(),N=St(O),k=St(N),G=St(k,!0);Et(k),Et(N),Et(O),Li(()=>{Qs(N,"href",`#${A()??""}`),Js(k,1,(P(),De(()=>h[P()]))),bm(G,W())}),Ct(T,O)}),Et(S),Et(R),Et(w),Et(v);var I=Oe(v,2);In("click",C,s),gu(1,v,()=>hR,()=>({x:-2,y:0,duration:100})),gu(2,v,()=>lR,()=>({duration:100})),In("click",v,r),In("click",I,r),Ct(y,x)};qs(_,y=>{X(i)&&y(m)})}return Et(c),Li(()=>Js(u,1,`relative z-10 group inline-block focus:outline-none cursor-pointer ${e()??""}`)),In("click",u,r),Ct(n,c),Rn({get buttonClass(){return e()},set buttonClass(y){e(y),kt()},get forRef(){return a()},set forRef(y){a(y),kt()}})}return customElements.define("dpb587-toc",Jn(o_,{forRef:{attribute:"for",type:"String"},buttonClass:{attribute:"button-class",type:"String"}},[],[],!1)),it.dpb587elevationchart=Cf,it.dpb587map=e_,it.dpb587openseadragon=r_,it.dpb587toc=o_,Object.defineProperty(it,Symbol.toStringTag,{value:"Module"}),it}({});
